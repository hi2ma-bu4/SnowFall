!function e(t,r,i){function s(a,o){if(!r[a]){if(!t[a]){var c="function"==typeof require&&require;if(!o&&c)return c(a,!0);if(n)return n(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[a]={exports:{}};t[a][0].call(u.exports,(function(e){return s(t[a][1][e]||e)}),u,u.exports,e,t,r,i)}return r[a].exports}for(var n="function"==typeof require&&require,a=0;a<i.length;a++)s(i[a]);return s}({1:[function(e,t,r){t.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i},t.exports.__esModule=!0,t.exports.default=t.exports},{}],2:[function(e,t,r){var i=e("./arrayLikeToArray.js");t.exports=function(e){if(Array.isArray(e))return i(e)},t.exports.__esModule=!0,t.exports.default=t.exports},{"./arrayLikeToArray.js":1}],3:[function(e,t,r){t.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},{}],4:[function(e,t,r){var i=e("./toPropertyKey.js");function s(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,i(s.key),s)}}t.exports=function(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},t.exports.__esModule=!0,t.exports.default=t.exports},{"./toPropertyKey.js":11}],5:[function(e,t,r){var i=e("./toPropertyKey.js");t.exports=function(e,t,r){return(t=i(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},t.exports.__esModule=!0,t.exports.default=t.exports},{"./toPropertyKey.js":11}],6:[function(e,t,r){t.exports=function(e){return e&&e.__esModule?e:{default:e}},t.exports.__esModule=!0,t.exports.default=t.exports},{}],7:[function(e,t,r){t.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},t.exports.__esModule=!0,t.exports.default=t.exports},{}],8:[function(e,t,r){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},{}],9:[function(e,t,r){var i=e("./arrayWithoutHoles.js"),s=e("./iterableToArray.js"),n=e("./unsupportedIterableToArray.js"),a=e("./nonIterableSpread.js");t.exports=function(e){return i(e)||s(e)||n(e)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},{"./arrayWithoutHoles.js":2,"./iterableToArray.js":7,"./nonIterableSpread.js":8,"./unsupportedIterableToArray.js":13}],10:[function(e,t,r){var i=e("./typeof.js").default;t.exports=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=i(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},t.exports.__esModule=!0,t.exports.default=t.exports},{"./typeof.js":12}],11:[function(e,t,r){var i=e("./typeof.js").default,s=e("./toPrimitive.js");t.exports=function(e){var t=s(e,"string");return"symbol"==i(t)?t:t+""},t.exports.__esModule=!0,t.exports.default=t.exports},{"./toPrimitive.js":10,"./typeof.js":12}],12:[function(e,t,r){function i(e){return t.exports=i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t.exports.__esModule=!0,t.exports.default=t.exports,i(e)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},{}],13:[function(e,t,r){var i=e("./arrayLikeToArray.js");t.exports=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports},{"./arrayLikeToArray.js":1}],14:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.Compiler=void 0;var s=i(e("@babel/runtime/helpers/defineProperty")),n=i(e("@babel/runtime/helpers/createClass")),a=i(e("@babel/runtime/helpers/classCallCheck")),o=e("../const/opcodes"),c=e("../util/compressor");function l(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return u(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,s=function(){};return{s:s,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){o=!0,n=e},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw n}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,s.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var f=(0,n.default)((function e(t,r,i,s){(0,a.default)(this,e),this.name=t,this.depth=r,this.index=i,this.isConst=s})),d=(0,n.default)((function e(t){(0,a.default)(this,e),(0,s.default)(this,"store",new Map),(0,s.default)(this,"localCount",0),this.parent=t}),[{key:"define",value:function(e,t,r){var i=new f(e,t,this.localCount++,r);return this.store.set(e,i),i}},{key:"resolve",value:function(e){var t=this.store.get(e);if(t)return{symbol:t,isLocal:!0};if(this.parent){var r=this.parent.resolve(e);if(r)return h(h({},r),{},{isLocal:!1})}return null}}]);r.Compiler=function(){function e(t,r){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,a.default)(this,e),(0,s.default)(this,"scopeDepth",0),(0,s.default)(this,"loopContext",[]),this.ast=t,this.currentNode=t,console.log(t),this.settings=r,this.parentCompiler=n,this.symbolTable=new d(null==n?void 0:n.symbolTable),this.scopeDepth=n?n.scopeDepth+1:0;var o="FunctionDeclaration"===t.type?t.name.name:"main",c="FunctionDeclaration"===t.type?t.params.length:0;this.compiledFunction={name:o,arity:c,chunk:{code:[],constants:[],lines:[]}},"FunctionDeclaration"===t.type&&t.params.forEach((function(e){return i.symbolTable.define(e.name,i.scopeDepth,!1)}))}return(0,n.default)(e,[{key:"currentChunk",value:function(){return this.compiledFunction.chunk}},{key:"emit",value:function(e){var t=this.currentChunk();t.code.push(e),t.lines.push(this.currentNode.line)}},{key:"emitBytes",value:function(){for(var e=this,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];r.forEach((function(t){return e.emit(t)}))}},{key:"addConstant",value:function(e){var t=this.currentChunk().constants,r=t.findIndex((function(t){return t===e}));return-1!==r?r:t.push(e)-1}},{key:"emitConstant",value:function(e){this.emitBytes(o.OpCode.PUSH_CONST,this.addConstant(e))}},{key:"emitJump",value:function(e){return this.emit(e),this.emit(255),this.emit(255),this.currentChunk().code.length-2}},{key:"patchJump",value:function(e){var t=this.currentChunk().code.length-e-2;if(t>65535)throw new Error("Compiler Error: Too much code to jump over.");this.currentChunk().code[e]=t>>8&255,this.currentChunk().code[e+1]=255&t}},{key:"emitLoop",value:function(e){this.emit(o.OpCode.LOOP);var t=this.currentChunk().code.length-e+2;if(t>65535)throw new Error("Compiler Error: Loop body too large.");this.emit(t>>8&255),this.emit(255&t)}},{key:"beginScope",value:function(){this.scopeDepth++,this.symbolTable=new d(this.symbolTable)}},{key:"endScope",value:function(){for(var e=this.symbolTable.localCount,t=0;t<e;t++)this.emit(o.OpCode.POP);this.scopeDepth--,this.symbolTable.parent&&(this.symbolTable=this.symbolTable.parent)}},{key:"compileNode",value:function(e){var t=this.currentNode;switch(this.currentNode=e,e.type){case"Program":this.compileStatements(e.body);break;case"EmptyStatement":break;case"BlockStatement":this.beginScope(),this.compileStatements(e.body),this.endScope();break;case"ExpressionStatement":this.compileNode(e.expression),this.emit(o.OpCode.POP);break;case"VariableDeclaration":this.compileVariableDeclaration(e);break;case"Identifier":this.compileIdentifier(e);break;case"NumericLiteral":case"StringLiteral":this.emitConstant(e.value);break;case"BooleanLiteral":this.emit(e.value?o.OpCode.PUSH_TRUE:o.OpCode.PUSH_FALSE);break;case"ArrayLiteral":this.compileArrayLiteral(e);break;case"ObjectLiteral":this.compileObjectLiteral(e);break;case"IfStatement":this.compileIfStatement(e);break;case"ForStatement":this.compileForStatement(e);break;case"WhileStatement":this.compileWhileStatement(e);break;case"SwitchStatement":this.compileSwitchStatement(e);break;case"BreakStatement":this.compileBreakStatement(e);break;case"FunctionDeclaration":this.compileFunctionDeclaration(e);break;case"ReturnStatement":this.compileReturnStatement(e);break;case"CallExpression":this.compileCallExpression(e);break;case"MemberExpression":this.compileMemberExpression(e);break;case"AssignmentExpression":this.compileAssignmentExpression(e);break;case"UnaryExpression":this.compileUnaryExpression(e);break;case"UpdateExpression":this.compileUpdateExpression(e);break;case"BinaryExpression":this.compileBinaryExpression(e);break;case"LogicalExpression":this.compileLogicalExpression(e);break;case"TryStatement":this.compileTryStatement(e);break;default:throw new Error("Compiler Error: Unknown AST node type: ".concat(e.type))}this.currentNode=t}},{key:"compileStatements",value:function(e){var t=this;e.forEach((function(e){return t.compileNode(e)}))}},{key:"compileVariableDeclaration",value:function(e){if(e.init?this.compileNode(e.init):this.emit(o.OpCode.PUSH_NULL),e.typeAnnotation){var t=e.typeAnnotation.name;"any"!==t.toLowerCase()&&this.emitBytes(o.OpCode.CHECK_TYPE,this.addConstant(t))}0===this.scopeDepth?this.emitBytes(o.OpCode.DEFINE_GLOBAL,this.addConstant(e.identifier.name)):this.symbolTable.define(e.identifier.name,this.scopeDepth,"const"===e.kind)}},{key:"compileIdentifier",value:function(e){if(!this.settings.builtInFunctions[e.name]){var t=this.symbolTable.resolve(e.name);t?this.emitBytes(o.OpCode.GET_LOCAL,t.symbol.index):this.emitBytes(o.OpCode.GET_GLOBAL,this.addConstant(e.name))}}},{key:"compileAssignmentExpression",value:function(e){if(this.compileNode(e.right),"Identifier"===e.left.type){var t=e.left.name,r=this.symbolTable.resolve(t);if(r){if(r.symbol.isConst)throw new Error("Compiler Error: Cannot assign to constant variable '".concat(t,"'."));this.emitBytes(o.OpCode.SET_LOCAL,r.symbol.index)}else this.emitBytes(o.OpCode.SET_GLOBAL,this.addConstant(t))}else{if("MemberExpression"!==e.left.type)throw new Error("Compiler Error: Invalid assignment target.");var i=e.left;this.compileNode(i.object),this.compileNode(i.property),this.emit(o.OpCode.SET_PROPERTY)}}},{key:"compileUpdateExpression",value:function(e){var t=e.argument,r=e.operator,i=e.prefix,s=this.symbolTable.resolve(t.name),n=null!==s;if(n&&s.symbol.isConst)throw new Error("Compiler Error: Cannot assign to constant variable '".concat(t.name,"'."));var a=n?o.OpCode.GET_LOCAL:o.OpCode.GET_GLOBAL,c=n?s.symbol.index:this.addConstant(t.name),l=n?o.OpCode.SET_LOCAL:o.OpCode.SET_GLOBAL,u=n?s.symbol.index:this.addConstant(t.name);this.emitBytes(a,c),i||this.emitBytes(a,c),this.emitConstant(1),this.emit("++"===r?o.OpCode.ADD:o.OpCode.SUBTRACT),this.emitBytes(l,u),i||this.emit(o.OpCode.POP)}},{key:"compileArrayLiteral",value:function(e){var t=this;e.elements.forEach((function(e){return t.compileNode(e)})),this.emitBytes(o.OpCode.BUILD_ARRAY,e.elements.length)}},{key:"compileObjectLiteral",value:function(e){var t=this;e.properties.forEach((function(e){t.emitConstant(e.key.value),t.compileNode(e.value)})),this.emitBytes(o.OpCode.BUILD_OBJECT,e.properties.length)}},{key:"compileMemberExpression",value:function(e){this.compileNode(e.object),"Identifier"===e.property.type?this.emitConstant(e.property.name):this.compileNode(e.property),this.emit(o.OpCode.GET_PROPERTY)}},{key:"compileIfStatement",value:function(e){this.compileNode(e.test);var t=this.emitJump(o.OpCode.JUMP_IF_FALSE);this.emit(o.OpCode.POP),this.compileNode(e.consequence);var r=this.emitJump(o.OpCode.JUMP);this.patchJump(t),this.emit(o.OpCode.POP),e.alternate&&this.compileNode(e.alternate),this.patchJump(r)}},{key:"compileForStatement",value:function(e){var t=this;this.beginScope(),e.init&&this.compileNode(e.init);var r=this.currentChunk().code.length;this.loopContext.push({loopStart:r,exitJumps:[]});var i=-1;e.test&&(this.compileNode(e.test),i=this.emitJump(o.OpCode.JUMP_IF_FALSE),this.emit(o.OpCode.POP)),this.compileNode(e.body),e.update&&(this.compileNode(e.update),this.emit(o.OpCode.POP)),this.emitLoop(r),-1!==i&&(this.patchJump(i),this.emit(o.OpCode.POP)),this.loopContext.pop().exitJumps.forEach((function(e){return t.patchJump(e)})),this.endScope()}},{key:"compileWhileStatement",value:function(e){var t=this,r=this.currentChunk().code.length;this.loopContext.push({loopStart:r,exitJumps:[]}),this.compileNode(e.test);var i=this.emitJump(o.OpCode.JUMP_IF_FALSE);this.emit(o.OpCode.POP),this.compileNode(e.body),this.emitLoop(r),this.patchJump(i),this.emit(o.OpCode.POP),this.loopContext.pop().exitJumps.forEach((function(e){return t.patchJump(e)}))}},{key:"compileSwitchStatement",value:function(e){var t=this;this.compileNode(e.discriminant),this.loopContext.push({loopStart:-1,exitJumps:[]});var r,i=[],s=l(e.cases);try{for(s.s();!(r=s.n()).done;){var n=r.value;if(n.test){this.emitBytes(o.OpCode.GET_LOCAL,this.symbolTable.localCount),this.compileNode(n.test),this.emit(o.OpCode.EQUAL);var a=this.emitJump(o.OpCode.JUMP_IF_FALSE);this.emit(o.OpCode.POP),this.compileStatements(n.consequent),i.push(this.emitJump(o.OpCode.JUMP)),this.patchJump(a),this.emit(o.OpCode.POP)}}}catch(e){s.e(e)}finally{s.f()}var c=e.cases.find((function(e){return null===e.test}));c&&this.compileStatements(c.consequent),i.forEach((function(e){return t.patchJump(e)})),this.loopContext.pop().exitJumps.forEach((function(e){return t.patchJump(e)})),this.emit(o.OpCode.POP)}},{key:"compileBreakStatement",value:function(e){if(0===this.loopContext.length)throw new Error("Compiler Error: 'break' statement outside of a loop or switch.");var t=this.emitJump(o.OpCode.JUMP);this.loopContext[this.loopContext.length-1].exitJumps.push(t)}},{key:"compileFunctionDeclaration",value:function(t){var r=new e(t,this.settings,this);r.compile();var i=this.addConstant(r.compiledFunction);this.emitBytes(o.OpCode.PUSH_CONST,i),0===this.scopeDepth?this.emitBytes(o.OpCode.DEFINE_GLOBAL,this.addConstant(t.name.name)):this.symbolTable.define(t.name.name,this.scopeDepth,!1)}},{key:"compileReturnStatement",value:function(e){e.argument?this.compileNode(e.argument):this.emit(o.OpCode.PUSH_NULL),this.emit(o.OpCode.RETURN)}},{key:"compileCallExpression",value:function(e){this.compileNode(e.callee);var t,r=l(e.arguments);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.compileNode(i)}}catch(e){r.e(e)}finally{r.f()}if("Identifier"===e.callee.type&&this.settings.builtInFunctions[e.callee.name]){var s=this.addConstant(e.callee.name);this.emitBytes(o.OpCode.CALL_BUILTIN,s,e.arguments.length)}else this.emitBytes(o.OpCode.CALL,e.arguments.length)}},{key:"compileUnaryExpression",value:function(e){switch(this.compileNode(e.right),e.operator){case"!":this.emit(o.OpCode.NEGATE);break;case"-":this.emitConstant(0),this.emit(o.OpCode.ADD),this.emit(o.OpCode.SUBTRACT),this.emit(o.OpCode.NEGATE);break;default:throw new Error("Compiler Error: Unknown unary operator ".concat(e.operator))}}},{key:"compileBinaryExpression",value:function(e){if("NumericLiteral"===e.left.type&&"NumericLiteral"===e.right.type){var t=e.left.value,r=e.right.value,i=null;switch(e.operator){case"+":i=t+r;break;case"-":i=t-r;break;case"*":i=t*r;break;case"/":i=0!==r?t/r:null}if(null!==i)return void this.emitConstant(i)}switch(this.compileNode(e.left),this.compileNode(e.right),e.operator){case"+":this.emit(o.OpCode.ADD);break;case"-":this.emit(o.OpCode.SUBTRACT);break;case"*":this.emit(o.OpCode.MULTIPLY);break;case"/":this.emit(o.OpCode.DIVIDE);break;case"%":this.emit(o.OpCode.MODULO);break;case"==":this.emit(o.OpCode.EQUAL);break;case"!=":this.emit(o.OpCode.NOT_EQUAL);break;case"<":this.emit(o.OpCode.LESS_THAN);break;case"<=":this.emit(o.OpCode.LESS_EQUAL);break;case">":this.emit(o.OpCode.GREATER_THAN);break;case">=":this.emit(o.OpCode.GREATER_EQUAL);break;case"&":this.emit(o.OpCode.BITWISE_AND);break;case"|":this.emit(o.OpCode.BITWISE_OR);break;default:throw new Error("Compiler Error: Unknown binary operator ".concat(e.operator))}}},{key:"compileLogicalExpression",value:function(e){if("&&"===e.operator){this.compileNode(e.left);var t=this.emitJump(o.OpCode.JUMP_IF_FALSE);this.emit(o.OpCode.POP),this.compileNode(e.right),this.patchJump(t)}else if("||"===e.operator){this.compileNode(e.left);var r=this.emitJump(o.OpCode.JUMP_IF_FALSE),i=this.emitJump(o.OpCode.JUMP);this.patchJump(r),this.emit(o.OpCode.POP),this.compileNode(e.right),this.patchJump(i)}}},{key:"compileTryStatement",value:function(e){var t=this.emitJump(o.OpCode.SETUP_EXCEPTION);this.compileNode(e.tryBlock),this.emit(o.OpCode.TEARDOWN_EXCEPTION);var r=this.emitJump(o.OpCode.JUMP);this.patchJump(t),e.catchClause&&(this.beginScope(),this.symbolTable.define(e.catchClause.param.name,this.scopeDepth,!1),this.compileNode(e.catchClause.body),this.endScope()),this.patchJump(r),e.finallyBlock&&this.compileNode(e.finallyBlock)}},{key:"compressData",value:function(){var e;return null!==(e=this.settings.output)&&void 0!==e&&e.compact?{name:this.compiledFunction.name,arity:this.compiledFunction.arity,code:c.Compressor.encodeNumbers(this.compiledFunction.chunk.code),constants:c.Compressor.encodeJSON(this.compiledFunction.chunk.constants),lines:c.Compressor.encodeSmartPack(this.compiledFunction.chunk.lines)}:this.compiledFunction}},{key:"compile",value:function(){return this.compileNode(this.ast),"Program"!==this.ast.type&&"FunctionDeclaration"!==this.ast.type||(this.emit(o.OpCode.PUSH_NULL),this.emit(o.OpCode.RETURN)),this.compressData()}}])}()},{"../const/opcodes":17,"../util/compressor":25,"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/defineProperty":5,"@babel/runtime/helpers/interopRequireDefault":6}],15:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.Lexer=void 0;var s=i(e("@babel/runtime/helpers/classCallCheck")),n=i(e("@babel/runtime/helpers/createClass")),a=i(e("@babel/runtime/helpers/defineProperty"));r.Lexer=(0,n.default)((function e(t){(0,s.default)(this,e),(0,a.default)(this,"pos",0),(0,a.default)(this,"line",1),(0,a.default)(this,"column",1),(0,a.default)(this,"keywords",{let:"KEYWORD",const:"KEYWORD",if:"KEYWORD",else:"KEYWORD",for:"KEYWORD",while:"KEYWORD",switch:"KEYWORD",case:"KEYWORD",default:"KEYWORD",break:"KEYWORD",function:"KEYWORD",return:"KEYWORD",true:"TRUE",false:"FALSE",try:"KEYWORD",catch:"KEYWORD",finally:"KEYWORD",throw:"KEYWORD"}),this.source=t,this.currentChar=this.source[this.pos]}),[{key:"advance",value:function(){"\n"===this.currentChar?(this.line++,this.column=1):this.column++,this.pos++,this.currentChar=this.pos<this.source.length?this.source[this.pos]:null}},{key:"peek",value:function(){return this.pos+1<this.source.length?this.source[this.pos+1]:null}},{key:"string",value:function(){this.advance();for(var e="";'"'!==this.currentChar&&null!==this.currentChar;)e+=this.currentChar,this.advance();if(null===this.currentChar)throw new Error("Lexer Error: Unterminated string.");return this.advance(),this.createToken("STRING",e)}},{key:"number",value:function(){for(var e="";null!==this.currentChar&&/\d/.test(this.currentChar);)e+=this.currentChar,this.advance();if("."===this.currentChar&&null!==this.peek()&&/\d/.test(this.peek()))for(e+=this.currentChar,this.advance();null!==this.currentChar&&/\d/.test(this.currentChar);)e+=this.currentChar,this.advance();return this.createToken("NUMBER",e)}},{key:"skipWhitespace",value:function(){for(;null!==this.currentChar&&/\s/.test(this.currentChar);)this.advance()}},{key:"createToken",value:function(e,t){return{type:e,value:t,line:this.line,column:this.column}}},{key:"identifier",value:function(){for(var e="";null!==this.currentChar&&/[a-zA-Z_0-9]/.test(this.currentChar);)e+=this.currentChar,this.advance();var t=this.keywords[e]||"IDENTIFIER";return this.createToken(t,e)}},{key:"tokenize",value:function(){for(var e=[];null!==this.currentChar;)if(/\s/.test(this.currentChar))this.skipWhitespace();else if('"'!==this.currentChar)if(/\d/.test(this.currentChar))e.push(this.number());else if(/[a-zA-Z_]/.test(this.currentChar))e.push(this.identifier());else{switch(this.currentChar){case"=":e.push("="===this.peek()?(this.advance(),this.createToken("EQUAL_EQUAL","==")):this.createToken("EQUALS","="));break;case"!":e.push("="===this.peek()?(this.advance(),this.createToken("BANG_EQUAL","!=")):this.createToken("BANG","!"));break;case">":e.push("="===this.peek()?(this.advance(),this.createToken("GREATER_EQUAL",">=")):this.createToken("GREATER",">"));break;case"<":e.push("="===this.peek()?(this.advance(),this.createToken("LESS_EQUAL","<=")):this.createToken("LESS","<"));break;case"&":e.push("&"===this.peek()?(this.advance(),this.createToken("AND","&&")):this.createToken("AMPERSAND","&"));break;case"|":e.push("|"===this.peek()?(this.advance(),this.createToken("OR","||")):this.createToken("PIPE","|"));break;case"+":e.push("+"===this.peek()?(this.advance(),this.createToken("PLUS_PLUS","++")):this.createToken("PLUS","+"));break;case"-":e.push("-"===this.peek()?(this.advance(),this.createToken("MINUS_MINUS","--")):this.createToken("MINUS","-"));break;case"*":e.push(this.createToken("STAR","*"));break;case"/":e.push(this.createToken("SLASH","/"));break;case"%":e.push(this.createToken("PERCENT","%"));break;case"(":e.push(this.createToken("LPAREN","("));break;case")":e.push(this.createToken("RPAREN",")"));break;case"{":e.push(this.createToken("LBRACE","{"));break;case"}":e.push(this.createToken("RBRACE","}"));break;case"[":e.push(this.createToken("LBRACKET","["));break;case"]":e.push(this.createToken("RBRACKET","]"));break;case";":e.push(this.createToken("SEMICOLON",";"));break;case":":e.push(this.createToken("COLON",":"));break;case",":e.push(this.createToken("COMMA",","));break;default:throw new Error("Lexer Error: Unknown character: ".concat(this.currentChar))}this.advance()}else e.push(this.string());return e.push(this.createToken("EOF","")),e}}])},{"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/defineProperty":5,"@babel/runtime/helpers/interopRequireDefault":6}],16:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.Parser=void 0;var s,n=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass")),o=i(e("@babel/runtime/helpers/defineProperty"));function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e[e.LOWEST=0]="LOWEST",e[e.ASSIGNMENT=1]="ASSIGNMENT",e[e.OR=2]="OR",e[e.AND=3]="AND",e[e.BITWISE_OR=4]="BITWISE_OR",e[e.BITWISE_AND=5]="BITWISE_AND",e[e.EQUALS=6]="EQUALS",e[e.LESS_GREATER=7]="LESS_GREATER",e[e.SUM=8]="SUM",e[e.PRODUCT=9]="PRODUCT",e[e.PREFIX=10]="PREFIX",e[e.POSTFIX=11]="POSTFIX",e[e.CALL=12]="CALL",e[e.INDEX=13]="INDEX"}(s||(s={}));var u={EQUALS:s.ASSIGNMENT,OR:s.OR,AND:s.AND,PIPE:s.BITWISE_OR,AMPERSAND:s.BITWISE_AND,EQUAL_EQUAL:s.EQUALS,BANG_EQUAL:s.EQUALS,GREATER:s.LESS_GREATER,GREATER_EQUAL:s.LESS_GREATER,LESS:s.LESS_GREATER,LESS_EQUAL:s.LESS_GREATER,PLUS:s.SUM,MINUS:s.SUM,STAR:s.PRODUCT,SLASH:s.PRODUCT,PERCENT:s.PRODUCT,PLUS_PLUS:s.POSTFIX,MINUS_MINUS:s.POSTFIX,LPAREN:s.CALL,LBRACKET:s.INDEX,DOT:s.INDEX};r.Parser=(0,a.default)((function e(t){var r=this;(0,n.default)(this,e),(0,o.default)(this,"pos",0),(0,o.default)(this,"parseIdentifier",(function(){return r.createNode("Identifier",{name:r.currentToken.value})})),(0,o.default)(this,"parseNumericLiteral",(function(){return r.createNode("NumericLiteral",{value:parseFloat(r.currentToken.value)})})),(0,o.default)(this,"parseStringLiteral",(function(){return r.createNode("StringLiteral",{value:r.currentToken.value})})),(0,o.default)(this,"parseBooleanLiteral",(function(){return r.createNode("BooleanLiteral",{value:"TRUE"===r.currentToken.type})})),(0,o.default)(this,"parseAssignmentExpression",(function(e){if("Identifier"!==e.type&&"MemberExpression"!==e.type)throw new Error("Parser Error: Invalid assignment target.");var t=r.currentPrecedence();r.advance();var i=r.parseExpression(t-1);return r.createNode("AssignmentExpression",{left:e,right:i})})),(0,o.default)(this,"parsePrefixExpression",(function(){var e=r.currentToken.value;r.advance();var t=r.parseExpression(s.PREFIX);return r.createNode("UnaryExpression",{operator:e,right:t})})),(0,o.default)(this,"parseUpdateExpression",(function(e){if(e){if("Identifier"!==e.type)throw new Error("Parser Error: The left-hand side of a postfix operator must be an identifier.");return r.createNode("UpdateExpression",{operator:r.currentToken.value,argument:e,prefix:!1})}var t=r.currentToken.value;if(r.advance(),"IDENTIFIER"!==r.currentToken.type)throw new Error("Parser Error: The right-hand side of a prefix operator must be an identifier.");var i=r.parseIdentifier();return r.createNode("UpdateExpression",{operator:t,argument:i,prefix:!0})})),(0,o.default)(this,"parseInfixExpression",(function(e){var t=r.currentToken.value,i=r.currentPrecedence();r.advance();var s=r.parseExpression(i);return r.createNode("BinaryExpression",{left:e,operator:t,right:s})})),(0,o.default)(this,"parseLogicalExpression",(function(e){var t=r.currentToken.value,i=r.currentPrecedence();r.advance();var s=r.parseExpression(i);return r.createNode("LogicalExpression",{left:e,operator:t,right:s})})),(0,o.default)(this,"parseGroupedOrTupleExpression",(function(){if(r.advance(),"RPAREN"===r.peekToken.type)return r.advance(),r.createNode("TupleLiteral",{elements:[]});var e=r.parseExpression(s.LOWEST);if("COMMA"===r.peekToken.type){for(var t=[e];"COMMA"===r.peekToken.type;)r.advance(),r.advance(),t.push(r.parseExpression(s.LOWEST));return r.expectPeek("RPAREN"),r.createNode("TupleLiteral",{elements:t})}if("RPAREN"!==r.currentToken.type)throw new Error("Parser Error: Expected ')' after expression.");return e})),(0,o.default)(this,"parseCallExpression",(function(e){var t=r.parseExpressionList("RPAREN");return r.createNode("CallExpression",{callee:e,arguments:t})})),(0,o.default)(this,"parseMemberExpression",(function(e){var t,i="LBRACKET"===r.currentToken.type;if(r.advance(),i)t=r.parseExpression(s.LOWEST),r.expectPeek("RBRACKET");else{if("IDENTIFIER"!==r.currentToken.type)throw new Error("Parser Error: Expected identifier after '.'.");t=r.parseIdentifier()}return r.createNode("MemberExpression",{object:e,property:t})})),(0,o.default)(this,"parseArrayLiteral",(function(){var e=r.parseExpressionList("RBRACKET");return r.createNode("ArrayLiteral",{elements:e})})),(0,o.default)(this,"parseObjectLiteral",(function(){var e=[];if("RBRACE"===r.peekToken.type)return r.advance(),r.createNode("ObjectLiteral",{properties:e});r.advance();do{if(r.advance(),"IDENTIFIER"!==r.currentToken.type&&"STRING"!==r.currentToken.type)throw new Error("Parser Error: Invalid key in object literal. Must be an identifier or a string.");var t="IDENTIFIER"===r.currentToken.type?r.parseIdentifier():r.parseStringLiteral();r.expectPeek("COLON"),r.advance();var i=r.parseExpression(s.LOWEST);e.push({key:t,value:i})}while("COMMA"===r.peekToken.type);return r.expectPeek("RBRACE"),r.createNode("ObjectLiteral",{properties:e})})),(0,o.default)(this,"parseBlockStatement",(function(){var e=[];for(r.advance();"RBRACE"!==r.currentToken.type&&"EOF"!==r.currentToken.type;){var t=r.parseStatement();t&&e.push(t),r.advance()}return r.createNode("BlockStatement",{body:e})})),(0,o.default)(this,"parseCondition",(function(){r.expectPeek("LPAREN"),r.advance();var e=r.parseExpression(s.LOWEST);return r.expectPeek("RPAREN"),e})),(0,o.default)(this,"parseVariableDeclaration",(function(){var e=r.currentToken.value;r.expectPeek("IDENTIFIER");var t,i=r.createNode("Identifier",{name:r.currentToken.value});if("COLON"===r.peekToken.type&&(r.advance(),r.advance(),t=r.parseIdentifier()),"EQUALS"!==r.peekToken.type)return r.createNode("VariableDeclaration",{kind:e,identifier:i,typeAnnotation:t});r.expectPeek("EQUALS"),r.advance();var n=r.parseExpression(s.LOWEST);return"SEMICOLON"===r.peekToken.type&&r.advance(),r.createNode("VariableDeclaration",{kind:e,identifier:i,typeAnnotation:t,init:n})})),(0,o.default)(this,"parseReturnStatement",(function(){if(r.advance(),"SEMICOLON"===r.currentToken.type)return r.createNode("ReturnStatement",{});var e=r.parseExpression(s.LOWEST);return"SEMICOLON"===r.peekToken.type&&r.advance(),r.createNode("ReturnStatement",{argument:e})})),(0,o.default)(this,"parseBreakStatement",(function(){return r.createNode("BreakStatement",{})})),(0,o.default)(this,"parseIfStatement",(function(){var e,t,i=r.parseCondition();if("LBRACE"===r.peekToken.type?(r.expectPeek("LBRACE"),e=r.parseBlockStatement()):(r.advance(),e=r.parseStatement()),null===e)throw new Error("Parser Error: Consequence of 'if' statement is empty.");var s=r.peekToken,n=s.type,a=s.value;return"KEYWORD"===n&&"else"===a&&(r.advance(),"KEYWORD"===r.peekToken.type&&"if"===r.peekToken.value?(r.advance(),t=r.parseIfStatement()):"LBRACE"===r.peekToken.type?(r.expectPeek("LBRACE"),t=r.parseBlockStatement()):(r.advance(),t=r.parseStatement()||void 0)),r.createNode("IfStatement",{test:i,consequence:e,alternate:t})})),(0,o.default)(this,"parseForStatement",(function(){var e,t,i;if(r.expectPeek("LPAREN"),r.advance(),"SEMICOLON"!==r.currentToken.type&&(e="KEYWORD"!==r.currentToken.type||"let"!==r.currentToken.value&&"const"!==r.currentToken.value?r.parseExpression(s.LOWEST):r.parseVariableDeclaration()),r.expectPeek("SEMICOLON"),r.advance(),"SEMICOLON"!==r.currentToken.type&&r.parseExpression(s.LOWEST),r.expectPeek("SEMICOLON"),r.advance(),"RPAREN"!==r.currentToken.type&&(t=r.parseExpression(s.LOWEST)),r.expectPeek("RPAREN"),"LBRACE"===r.peekToken.type?(r.expectPeek("LBRACE"),i=r.parseBlockStatement()):(r.advance(),i=r.parseStatement()),null===i)throw new Error("Parser Error: Body of 'for' statement is empty.");return r.createNode("ForStatement",{init:e,test:void 0,update:t,body:i})})),(0,o.default)(this,"parseWhileStatement",(function(){var e,t=r.parseCondition();if("LBRACE"===r.peekToken.type?(r.expectPeek("LBRACE"),e=r.parseBlockStatement()):(r.advance(),e=r.parseStatement()),null===e)throw new Error("Parser Error: Body of 'while' statement is empty.");return r.createNode("WhileStatement",{test:t,body:e})})),(0,o.default)(this,"parseSwitchStatement",(function(){var e=r.parseCondition();r.expectPeek("LBRACE"),r.advance();for(var t=[];"RBRACE"!==r.currentToken.type&&"EOF"!==r.currentToken.type;){var i=null;if("KEYWORD"===r.currentToken.type&&"case"===r.currentToken.value)r.advance(),i=r.parseExpression(s.LOWEST);else{if("KEYWORD"!==r.currentToken.type||"default"!==r.currentToken.value)throw new Error("Parser Error: Expected 'case' or 'default', got ".concat(r.currentToken.type));r.advance()}r.expectPeek("COLON"),r.advance();for(var n=[];"RBRACE"!==r.currentToken.type&&("KEYWORD"!==r.currentToken.type||"case"!==r.currentToken.value&&"default"!==r.currentToken.value);){var a=r.parseStatement();a&&n.push(a),r.advance()}t.push(r.createNode("SwitchCase",{test:i,consequent:n}))}return r.createNode("SwitchStatement",{discriminant:e,cases:t})})),(0,o.default)(this,"parseFunctionDeclaration",(function(){r.advance();var e=r.parseIdentifier();r.expectPeek("LPAREN");var t=[];if("RPAREN"!==r.peekToken.type){r.advance();do{r.advance(),t.push(r.parseIdentifier())}while("COMMA"===r.peekToken.type)}r.expectPeek("RPAREN"),r.expectPeek("LBRACE");var i=r.parseBlockStatement();return r.createNode("FunctionDeclaration",{name:e,params:t,body:i})})),(0,o.default)(this,"parseTryStatement",(function(){r.expectPeek("LBRACE");var e=r.parseBlockStatement(),t=null;if("KEYWORD"===r.peekToken.type&&"catch"===r.peekToken.value){r.advance(),r.expectPeek("LPAREN"),r.advance();var i=r.parseIdentifier();r.expectPeek("RPAREN"),r.expectPeek("LBRACE"),t={param:i,body:r.parseBlockStatement()}}var s=null;if("KEYWORD"===r.peekToken.type&&"finally"===r.peekToken.value&&(r.advance(),r.expectPeek("LBRACE"),s=r.parseBlockStatement()),!t&&!s)throw new Error("Parser Error: 'try' must have at least a 'catch' or 'finally' block.");return r.createNode("TryStatement",{tryBlock:e,catchClause:t,finallyBlock:s})})),(0,o.default)(this,"parseExpressionStatement",(function(){var e=r.parseExpression(s.LOWEST);return"SEMICOLON"===r.peekToken.type&&r.advance(),r.createNode("ExpressionStatement",{expression:e})})),this.tokens=t,this.currentToken=this.tokens[0],this.peekToken=this.tokens[1],this.prefixParseFns=new Map,this.registerPrefix("IDENTIFIER",this.parseIdentifier),this.registerPrefix("NUMBER",this.parseNumericLiteral),this.registerPrefix("STRING",this.parseStringLiteral),this.registerPrefix("TRUE",this.parseBooleanLiteral),this.registerPrefix("FALSE",this.parseBooleanLiteral),this.registerPrefix("BANG",this.parsePrefixExpression),this.registerPrefix("MINUS",this.parsePrefixExpression),this.registerPrefix("PLUS_PLUS",this.parseUpdateExpression),this.registerPrefix("MINUS_MINUS",this.parseUpdateExpression),this.registerPrefix("LPAREN",this.parseGroupedOrTupleExpression),this.registerPrefix("LBRACKET",this.parseArrayLiteral),this.registerPrefix("LBRACE",this.parseObjectLiteral),this.infixParseFns=new Map,this.registerInfix("EQUALS",this.parseAssignmentExpression),this.registerInfix("PLUS",this.parseInfixExpression),this.registerInfix("MINUS",this.parseInfixExpression),this.registerInfix("STAR",this.parseInfixExpression),this.registerInfix("SLASH",this.parseInfixExpression),this.registerInfix("PERCENT",this.parseInfixExpression),this.registerInfix("EQUAL_EQUAL",this.parseInfixExpression),this.registerInfix("BANG_EQUAL",this.parseInfixExpression),this.registerInfix("GREATER",this.parseInfixExpression),this.registerInfix("GREATER_EQUAL",this.parseInfixExpression),this.registerInfix("LESS",this.parseInfixExpression),this.registerInfix("LESS_EQUAL",this.parseInfixExpression),this.registerInfix("AMPERSAND",this.parseInfixExpression),this.registerInfix("PIPE",this.parseInfixExpression),this.registerInfix("AND",this.parseLogicalExpression),this.registerInfix("OR",this.parseLogicalExpression),this.registerInfix("PLUS_PLUS",this.parseUpdateExpression),this.registerInfix("MINUS_MINUS",this.parseUpdateExpression),this.registerInfix("LPAREN",this.parseCallExpression),this.registerInfix("LBRACKET",this.parseMemberExpression),this.registerInfix("DOT",this.parseMemberExpression)}),[{key:"createNode",value:function(e,t){return l(l({type:e},t),{},{line:this.currentToken.line,column:this.currentToken.column})}},{key:"advance",value:function(){this.pos++,this.currentToken=this.peekToken,this.pos+1<this.tokens.length?this.peekToken=this.tokens[this.pos+1]:this.peekToken={type:"EOF",value:"",line:this.currentToken.line,column:this.currentToken.column+1}}},{key:"registerPrefix",value:function(e,t){this.prefixParseFns.set(e,t.bind(this))}},{key:"registerInfix",value:function(e,t){this.infixParseFns.set(e,t.bind(this))}},{key:"expectPeek",value:function(e){if(this.peekToken.type!==e)throw new Error("Parser Error: Expected next token to be ".concat(e,", got ").concat(this.peekToken.type," instead."));this.advance()}},{key:"peekPrecedence",value:function(){return u[this.peekToken.type]||s.LOWEST}},{key:"currentPrecedence",value:function(){return u[this.currentToken.type]||s.LOWEST}},{key:"parseExpression",value:function(e){var t,r=!0,i=this.prefixParseFns.get(this.currentToken.type);if(i||(r=!1),!r)throw!this.infixParseFns.get(this.currentToken.type)||"PLUS_PLUS"!==this.currentToken.type&&"MINUS_MINUS"!==this.currentToken.type?new Error("Parser Error: No prefix parse function for ".concat(this.currentToken.type," found.")):new Error("Postfix operators must follow an expression.");for(t=i();"SEMICOLON"!==this.peekToken.type&&e<this.peekPrecedence();){var s=this.infixParseFns.get(this.peekToken.type);if(!s)return t;this.advance(),t=s(t)}return t}},{key:"parseExpressionList",value:function(e){var t=[];if(this.peekToken.type===e)return this.advance(),t;for(this.advance(),t.push(this.parseExpression(s.LOWEST));"COMMA"===this.peekToken.type;)this.advance(),this.advance(),t.push(this.parseExpression(s.LOWEST));return this.expectPeek(e),t}},{key:"parseStatement",value:function(){if("SEMICOLON"===this.currentToken.type)return this.createNode("EmptyStatement",{});if("KEYWORD"===this.currentToken.type)switch(this.currentToken.value){case"let":case"const":return this.parseVariableDeclaration();case"return":return this.parseReturnStatement();case"if":return this.parseIfStatement();case"for":return this.parseForStatement();case"while":return this.parseWhileStatement();case"switch":return this.parseSwitchStatement();case"break":return this.parseBreakStatement();case"function":return this.parseFunctionDeclaration();case"try":return this.parseTryStatement()}return this.parseExpressionStatement()}},{key:"parse",value:function(){var e=this.createNode("Program",{body:[]});for(console.log(this.tokens);"EOF"!==this.currentToken.type;)if("SEMICOLON"!==this.currentToken.type){var t=this.parseStatement();t&&e.body.push(t),this.advance()}else this.advance();return e}}])},{"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/defineProperty":5,"@babel/runtime/helpers/interopRequireDefault":6}],17:[function(e,t,r){"use strict";var i;Object.defineProperty(r,"__esModule",{value:!0}),r.OpCode=void 0,function(e){e[e.PUSH_CONST=0]="PUSH_CONST",e[e.PUSH_NULL=1]="PUSH_NULL",e[e.PUSH_TRUE=2]="PUSH_TRUE",e[e.PUSH_FALSE=3]="PUSH_FALSE",e[e.ADD=4]="ADD",e[e.SUBTRACT=5]="SUBTRACT",e[e.MULTIPLY=6]="MULTIPLY",e[e.DIVIDE=7]="DIVIDE",e[e.MODULO=8]="MODULO",e[e.EQUAL=9]="EQUAL",e[e.NOT_EQUAL=10]="NOT_EQUAL",e[e.GREATER_THAN=11]="GREATER_THAN",e[e.GREATER_EQUAL=12]="GREATER_EQUAL",e[e.LESS_THAN=13]="LESS_THAN",e[e.LESS_EQUAL=14]="LESS_EQUAL",e[e.NEGATE=15]="NEGATE",e[e.BITWISE_AND=16]="BITWISE_AND",e[e.BITWISE_OR=17]="BITWISE_OR",e[e.POP=18]="POP",e[e.DEFINE_GLOBAL=19]="DEFINE_GLOBAL",e[e.GET_GLOBAL=20]="GET_GLOBAL",e[e.SET_GLOBAL=21]="SET_GLOBAL",e[e.GET_LOCAL=22]="GET_LOCAL",e[e.SET_LOCAL=23]="SET_LOCAL",e[e.BUILD_ARRAY=24]="BUILD_ARRAY",e[e.BUILD_OBJECT=25]="BUILD_OBJECT",e[e.GET_PROPERTY=26]="GET_PROPERTY",e[e.SET_PROPERTY=27]="SET_PROPERTY",e[e.JUMP=28]="JUMP",e[e.JUMP_IF_FALSE=29]="JUMP_IF_FALSE",e[e.LOOP=30]="LOOP",e[e.CALL=31]="CALL",e[e.RETURN=32]="RETURN",e[e.CALL_BUILTIN=33]="CALL_BUILTIN",e[e.CHECK_TYPE=34]="CHECK_TYPE",e[e.SETUP_EXCEPTION=35]="SETUP_EXCEPTION",e[e.TEARDOWN_EXCEPTION=36]="TEARDOWN_EXCEPTION",e[e.THROW=37]="THROW"}(i||(r.OpCode=i={}))},{}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("./main");"undefined"!=typeof window&&(window.SnowFall=i.SnowFall);r.default=i.SnowFall},{"./main":24}],19:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),s=e("@babel/runtime/helpers/typeof");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass")),o=i(e("@babel/runtime/helpers/defineProperty")),c=u(e("./config")),l=u(e("./util"));function u(e,t){if("function"==typeof WeakMap)var r=new WeakMap,i=new WeakMap;return(u=function(e,t){if(!t&&e&&e.__esModule)return e;var n,a,o={__proto__:null,default:e};if(null===e||"object"!=s(e)&&"function"!=typeof e)return o;if(n=t?i:r){if(n.has(e))return n.get(e);n.set(e,o)}for(var c in e)"default"!==c&&{}.hasOwnProperty.call(e,c)&&((a=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,c))&&(a.get||a.set)?n(o,c,a):o[c]=e[c]);return o})(e,t)}r.default=(0,a.default)((function e(t){(0,n.default)(this,e),(0,o.default)(this,"_data",null),(0,o.default)(this,"_table",null),(0,o.default)(this,"_result",null),(0,o.default)(this,"_offset",0),(0,o.default)(this,"_dataLen",0),(0,o.default)(this,"_index",0),(0,o.default)(this,"_length",0),this._init(t)}),[{key:"_init",value:function(e){e=e||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=e.onData,this._onEndCallback=e.onEnd}},{key:"_createTable",value:function(){for(var e=l.createBuffer(8,c.TABLE_LENGTH),t=0;t<c.TABLE_LENGTH;t++)e[t]=c.BASE62TABLE.charCodeAt(t);return e}},{key:"_onData",value:function(e,t){var r=l.bufferToString_fast(e,t);this._onDataCallback?this._onDataCallback(r):null!==this._result&&(this._result+=r)}},{key:"_onEnd",value:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null}},{key:"_search",value:function(){var e=2,t=this._data,r=this._offset,i=c.BUFFER_MAX;if(this._dataLen-r<i&&(i=this._dataLen-r),e>i)return!1;var s,n,a,o,l,u=r-c.WINDOW_BUFFER_MAX,p=t.substring(u,r+i),h=r+e-3-u;do{if(2===e){if(n=t.charAt(r)+t.charAt(r+1),-1===(a=p.indexOf(n))||a>h)break}else 3===e?n+=t.charAt(r+2):n=t.substr(r,e);if(-1===(o=c.STRING_LASTINDEXOF_BUG?t.substring(u,r+e-1).lastIndexOf(n):p.lastIndexOf(n,h)))break;l=o,s=u+o;do{if(t.charCodeAt(r+e)!==t.charCodeAt(s+e))break}while(++e<i);if(a===o){e++;break}}while(++e<i);return 2!==e&&(this._index=c.WINDOW_BUFFER_MAX-l,this._length=e-1,!0)}},{key:"compress",value:function(e){if(null==e||0===e.length)return"";var t,r=this._createTable(),i=l.createWindow(),s=l.createBuffer(8,c.COMPRESS_CHUNK_SIZE),n=0;this._result="",this._offset=i.length,this._data=i+e,this._dataLen=this._data.length;for(var a,o,u,p,h,f=-1,d=-1;this._offset<this._dataLen;)this._search()?(this._index<c.BUFFER_MAX?(o=this._index,u=0):(o=this._index%c.BUFFER_MAX,u=(this._index-o)/c.BUFFER_MAX),2===this._length?(s[n++]=r[u+c.COMPRESS_FIXED_START],s[n++]=r[o]):(s[n++]=r[u+c.COMPRESS_START],s[n++]=r[o],s[n++]=r[this._length]),this._offset+=this._length,~d&&(d=-1)):(a=this._data.charCodeAt(this._offset++))<c.LATIN_BUFFER_MAX?(a<c.UNICODE_CHAR_MAX?(o=a,f=c.LATIN_INDEX):f=(u=(a-(o=a%c.UNICODE_CHAR_MAX))/c.UNICODE_CHAR_MAX)+c.LATIN_INDEX,d===f?s[n++]=r[o]:(s[n++]=r[f-c.LATIN_INDEX_START],s[n++]=r[o],d=f)):(a<c.UNICODE_BUFFER_MAX?(f=c.UNICODE_INDEX,o=a):f=(u=(a-(o=a%c.UNICODE_BUFFER_MAX))/c.UNICODE_BUFFER_MAX)+c.UNICODE_INDEX,o<c.UNICODE_CHAR_MAX?(p=o,h=0):h=(o-(p=o%c.UNICODE_CHAR_MAX))/c.UNICODE_CHAR_MAX,d===f?(s[n++]=r[p],s[n++]=r[h]):(s[n++]=r[c.CHAR_START],s[n++]=r[f-c.TABLE_LENGTH],s[n++]=r[p],s[n++]=r[h],d=f)),n>=c.COMPRESS_CHUNK_MAX&&(this._onData(s,n),n=0);return n>0&&this._onData(s,n),this._onEnd(),t=this._result,this._result=null,null===t?"":t}}])},{"./config":20,"./util":23,"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/defineProperty":5,"@babel/runtime/helpers/interopRequireDefault":6,"@babel/runtime/helpers/typeof":12}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.WINDOW_MAX=r.WINDOW_BUFFER_MAX=r.UNICODE_INDEX=r.UNICODE_CHAR_MAX=r.UNICODE_BUFFER_MAX=r.TABLE_LENGTH=r.TABLE_DIFF=r.STRING_LASTINDEXOF_BUG=r.LATIN_INDEX_START=r.LATIN_INDEX=r.LATIN_DECODE_MAX=r.LATIN_BUFFER_MAX=r.HAS_TYPED=r.DECOMPRESS_CHUNK_SIZE=r.DECOMPRESS_CHUNK_MAX=r.DECODE_MAX=r.COMPRESS_START=r.COMPRESS_INDEX=r.COMPRESS_FIXED_START=r.COMPRESS_CHUNK_SIZE=r.COMPRESS_CHUNK_MAX=r.CHAR_START=r.CAN_CHARCODE_APPLY_TYPED=r.CAN_CHARCODE_APPLY=r.BUFFER_MAX=r.BASE62TABLE=r.APPLY_BUFFER_SIZE_OK=r.APPLY_BUFFER_SIZE=void 0,r.setApplyBufferSizeOk=function(e){r.APPLY_BUFFER_SIZE_OK=e};var i=r.HAS_TYPED="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array,s=!1;try{"a"===String.fromCharCode.apply(null,[97])&&(s=!0)}catch(e){}r.CAN_CHARCODE_APPLY=s;var n=!1;if(i)try{"a"===String.fromCharCode.apply(null,new Uint8Array([97]))&&(n=!0)}catch(e){}r.CAN_CHARCODE_APPLY_TYPED=n;var a=r.APPLY_BUFFER_SIZE=65533;r.APPLY_BUFFER_SIZE_OK=null;var o=!1;-1!=="abcほげ".lastIndexOf("ほげ",1)&&(o=!0);r.STRING_LASTINDEXOF_BUG=o;var c=r.BASE62TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",l=r.TABLE_LENGTH=c.length,u=r.TABLE_DIFF=Math.max(l,62)-Math.min(l,62),p=(r.BUFFER_MAX=l-1,r.WINDOW_MAX=1024),h=(r.WINDOW_BUFFER_MAX=304,r.COMPRESS_CHUNK_SIZE=a),f=(r.COMPRESS_CHUNK_MAX=h-l,r.DECOMPRESS_CHUNK_SIZE=a),d=(r.DECOMPRESS_CHUNK_MAX=f+2*p,r.LATIN_BUFFER_MAX=132,r.UNICODE_CHAR_MAX=40),E=(r.UNICODE_BUFFER_MAX=d*(d+1),r.LATIN_INDEX=l+1,r.LATIN_INDEX_START=u+20,r.UNICODE_INDEX=l+5,r.DECODE_MAX=l-u-19,r.LATIN_DECODE_MAX=d+7),m=r.CHAR_START=E+1,k=r.COMPRESS_START=m+1,b=r.COMPRESS_FIXED_START=k+5;r.COMPRESS_INDEX=b+5},{}],21:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),s=e("@babel/runtime/helpers/typeof");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass")),o=i(e("@babel/runtime/helpers/defineProperty")),c=u(e("./config")),l=u(e("./util"));function u(e,t){if("function"==typeof WeakMap)var r=new WeakMap,i=new WeakMap;return(u=function(e,t){if(!t&&e&&e.__esModule)return e;var n,a,o={__proto__:null,default:e};if(null===e||"object"!=s(e)&&"function"!=typeof e)return o;if(n=t?i:r){if(n.has(e))return n.get(e);n.set(e,o)}for(var c in e)"default"!==c&&{}.hasOwnProperty.call(e,c)&&((a=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,c))&&(a.get||a.set)?n(o,c,a):o[c]=e[c]);return o})(e,t)}r.default=(0,a.default)((function e(t){(0,n.default)(this,e),(0,o.default)(this,"_result",null),this._init(t)}),[{key:"_init",value:function(e){e=e||{},this._result=null,this._onDataCallback=e.onData,this._onEndCallback=e.onEnd}},{key:"_createTable",value:function(){for(var e={},t=0;t<c.TABLE_LENGTH;t++)e[c.BASE62TABLE.charAt(t)]=t;return e}},{key:"_onData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._onDataCallback&&this._result){var t;if(e)t=this._result,this._result=[];else{var r=c.DECOMPRESS_CHUNK_SIZE-c.WINDOW_MAX;t=this._result.slice(c.WINDOW_MAX,c.WINDOW_MAX+r),this._result=this._result.slice(0,c.WINDOW_MAX).concat(this._result.slice(c.WINDOW_MAX+r))}t.length>0&&this._onDataCallback(l.bufferToString_fast(t))}}},{key:"_onEnd",value:function(){this._onEndCallback&&this._onEndCallback()}},{key:"decompress",value:function(e){if(null==e||0===e.length)return"";this._result=l.stringToArray(l.createWindow());for(var t,r,i,s,n,a,o,u,p,h,f=this._createTable(),d=!1,E=null,m=e.length,k=0;k<m;k++)if(void 0!==(i=f[e.charAt(k)])){if(i<c.DECODE_MAX)n=d?f[e.charAt(++k)]*c.UNICODE_CHAR_MAX+i+c.UNICODE_BUFFER_MAX*E:E*c.UNICODE_CHAR_MAX+i,this._result[this._result.length]=n;else if(i<c.LATIN_DECODE_MAX)E=i-c.DECODE_MAX,d=!1;else if(i===c.CHAR_START)E=(s=f[e.charAt(++k)])-5,d=!0;else if(i<c.COMPRESS_INDEX){if(s=f[e.charAt(++k)],i<c.COMPRESS_FIXED_START?(a=(i-c.COMPRESS_START)*c.BUFFER_MAX+s,o=f[e.charAt(++k)]):(a=(i-c.COMPRESS_FIXED_START)*c.BUFFER_MAX+s,o=2),(u=this._result.slice(-a)).length>o&&(u.length=o),p=u.length,u.length>0)for(h=0;h<o;)for(r=0;r<p&&(this._result[this._result.length]=u[r],!(++h>=o));r++);E=null}this._result.length>=c.DECOMPRESS_CHUNK_MAX&&this._onData()}return this._result=this._result.slice(c.WINDOW_MAX),this._onData(!0),this._onEnd(),t=l.bufferToString_fast(this._result),this._result=null,t}}])},{"./config":20,"./util":23,"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/defineProperty":5,"@babel/runtime/helpers/interopRequireDefault":6,"@babel/runtime/helpers/typeof":12}],22:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.compress=a,r.decompress=o,r.version=r.default=void 0;var s=i(e("./compressor")),n=i(e("./decompressor"));r.version="2.0.0-ts";function a(e,t){return new s.default(t).compress(e)}function o(e,t){return new n.default(t).decompress(e)}
/**
 * forked from lzbase62
 * @module lzbase62
 * @see https://github.com/polygonplanet/lzbase62
 * @license MIT
 * @version 2.0.0
 */r.default={compress:a,decompress:o}},{"./compressor":19,"./decompressor":21,"@babel/runtime/helpers/interopRequireDefault":6}],23:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/typeof");Object.defineProperty(r,"__esModule",{value:!0}),r.bufferToString_chunked=o,r.bufferToString_fast=function(e,t){null==t?t=e.length:e=a(e,t);if(s.CAN_CHARCODE_APPLY&&s.CAN_CHARCODE_APPLY_TYPED){var r=e.length;if(r<s.APPLY_BUFFER_SIZE&&s.APPLY_BUFFER_SIZE_OK)return n.apply(null,e);if(null===s.APPLY_BUFFER_SIZE_OK)try{var i=n.apply(null,e);return r>s.APPLY_BUFFER_SIZE&&s.setApplyBufferSizeOk(!0),i}catch(e){s.setApplyBufferSizeOk(!1)}}return o(e)},r.bufferToString_slow=c,r.createBuffer=function(e,t){if(s.HAS_TYPED)switch(e){case 8:return new Uint8Array(t);case 16:return new Uint16Array(t)}return new Array(t)},r.createWindow=function(){var e=s.WINDOW_MAX>>7,t="        ";for(;!(e&s.WINDOW_MAX);)t+=t,e<<=1;return t},r.stringToArray=function(e){if(!e)return[];for(var t=[],r=e?e.length:0,i=0;i<r;i++)t[i]=e.charCodeAt(i);return t},r.truncateBuffer=a;var s=function(e,t){if("function"==typeof WeakMap)var r=new WeakMap,s=new WeakMap;return function(e,t){if(!t&&e&&e.__esModule)return e;var n,a,o={__proto__:null,default:e};if(null===e||"object"!=i(e)&&"function"!=typeof e)return o;if(n=t?s:r){if(n.has(e))return n.get(e);n.set(e,o)}for(var c in e)"default"!==c&&{}.hasOwnProperty.call(e,c)&&((a=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,c))&&(a.get||a.set)?n(o,c,a):o[c]=e[c]);return o}(e,t)}(e("./config"));var n=String.fromCharCode;function a(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)}function o(e){for(var t,r="",i=e.length,a=0;a<i;){if(t=!Array.isArray(e)&&e.subarray?e.subarray(a,a+s.APPLY_BUFFER_SIZE):e.slice(a,a+s.APPLY_BUFFER_SIZE),a+=s.APPLY_BUFFER_SIZE,!s.APPLY_BUFFER_SIZE_OK){if(null===s.APPLY_BUFFER_SIZE_OK)try{r+=n.apply(null,t),t.length>s.APPLY_BUFFER_SIZE&&s.setApplyBufferSizeOk(!0);continue}catch(e){s.setApplyBufferSizeOk(!1)}return c(e)}r+=n.apply(null,t)}return r}function c(e){for(var t="",r=e.length,i=0;i<r;i++)t+=n(e[i]);return t}},{"./config":20,"@babel/runtime/helpers/typeof":12}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SnowFall=void 0;var i=e("./compiler/compiler"),s=e("./compiler/libs/lexer"),n=e("./compiler/libs/parser"),a=e("./vm/vm"),o={builtInFunctions:{}};function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,r=new s.Lexer(e).tokenize(),a=new n.Parser(r).parse();return new i.Compiler(a,t).compile()}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;return new a.SnowFallVM(e,t).run()}r.SnowFall={compile:c,run:l,compileAndRun:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;return l(c(e,t),t)}}},{"./compiler/compiler":14,"./compiler/libs/lexer":15,"./compiler/libs/parser":16,"./vm/vm":28}],25:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.Compressor=void 0;var s=i(e("@babel/runtime/helpers/classCallCheck")),n=i(e("@babel/runtime/helpers/createClass")),a=i(e("@babel/runtime/helpers/defineProperty")),o=i(e("../libs/lzbase62/src/index")),c=i(e("./compressor/smartpack"));function l(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return u(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,s=function(){};return{s:s,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){o=!0,n=e},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw n}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var p=r.Compressor=(0,n.default)((function e(){(0,s.default)(this,e)}),null,[{key:"encodeNumbers",value:function(e){var t,r="",i=l(e);try{for(i.s();!(t=i.n()).done;){var s=t.value,n=[];do{var a=s&this.BYTE_MASK;(s>>>=7)>0&&(a|=this.BYTE_MSB),n.push(a)}while(s>0);for(var o=0,c=n;o<c.length;o++){var u=c[o];r+=String.fromCharCode(u)}}}catch(e){i.e(e)}finally{i.f()}return this.encodeString(r)}},{key:"encodeSmartPack",value:function(e){var t,r="",i=l(c.default.encode(e));try{for(i.s();!(t=i.n()).done;){var s=t.value;r+=String.fromCharCode(s)}}catch(e){i.e(e)}finally{i.f()}return this.encodeString(r)}},{key:"encodeJSON",value:function(e){return this.encodeString(JSON.stringify(e))}},{key:"encodeString",value:function(e){return o.default.compress(e)}},{key:"decodeNumbers",value:function(e){if(0===e.length)return[];for(var t=this.decodeString(e),r=[],i=0,s=0,n=0;n<t.length;n++){var a=t.charCodeAt(n);i|=(a&this.BYTE_MASK)<<s,0===(a&this.BYTE_MSB)?(r.push(i),i=0,s=0):s+=7}return r}},{key:"decodeSmartPack",value:function(e){for(var t=this.decodeString(e),r=[],i=0;i<t.length;i++)r.push(t.charCodeAt(i));return c.default.decode(new Uint8Array(r))}},{key:"decodeJSON",value:function(e){return JSON.parse(this.decodeString(e))}},{key:"decodeString",value:function(e){return o.default.decompress(e)}}]);(0,a.default)(p,"BYTE_MASK",127),(0,a.default)(p,"BYTE_MSB",128)},{"../libs/lzbase62/src/index":22,"./compressor/smartpack":27,"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/defineProperty":5,"@babel/runtime/helpers/interopRequireDefault":6}],26:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.BitWriter=r.BitReader=void 0;var s=i(e("@babel/runtime/helpers/classCallCheck")),n=i(e("@babel/runtime/helpers/createClass")),a=i(e("@babel/runtime/helpers/defineProperty"));r.BitWriter=(0,n.default)((function e(){(0,s.default)(this,e),(0,a.default)(this,"buffer",[]),(0,a.default)(this,"currentByte",0),(0,a.default)(this,"bitsFilled",0)}),[{key:"writeBits",value:function(e,t){for(var r=t-1;r>=0;r--){var i=e>>r&1;this.currentByte=this.currentByte<<1|i,this.bitsFilled++,8===this.bitsFilled&&(this.buffer.push(this.currentByte),this.currentByte=0,this.bitsFilled=0)}}},{key:"finish",value:function(){return this.bitsFilled>0&&(this.currentByte<<=8-this.bitsFilled,this.buffer.push(this.currentByte)),Uint8Array.from(this.buffer)}}]),r.BitReader=(0,n.default)((function e(t){(0,s.default)(this,e),(0,a.default)(this,"byteIndex",0),(0,a.default)(this,"bitsLeft",0),(0,a.default)(this,"currentByte",0),this.buffer=t}),[{key:"readBits",value:function(e){for(var t=0;e>0;){if(0===this.bitsLeft){if(this.byteIndex>=this.buffer.length)throw new Error("EOF");this.currentByte=this.buffer[this.byteIndex++],this.bitsLeft=8}var r=Math.min(e,this.bitsLeft),i=this.bitsLeft-r;t=t<<r|this.currentByte>>i&(1<<r)-1,this.bitsLeft-=r,this.currentByte&=(1<<this.bitsLeft)-1,e-=r}return t}}])},{"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/defineProperty":5,"@babel/runtime/helpers/interopRequireDefault":6}],27:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=i(e("@babel/runtime/helpers/classCallCheck")),n=i(e("@babel/runtime/helpers/createClass")),a=e("./bitwriter");r.default=(0,n.default)((function e(){(0,s.default)(this,e)}),null,[{key:"_encodeSigned",value:function(e,t){return e+(1<<t-1)}},{key:"_decodeSigned",value:function(e,t){return e-(1<<t-1)}},{key:"encode",value:function(e){if(0===e.length)return new Uint8Array;for(var t=[e[0]],r=1;r<e.length;r++)t.push(e[r]-e[r-1]);for(var i=new a.BitWriter,s=0;s<t.length;){for(var n=1;s+n<t.length&&t[s+n]===t[s];)n++;if(n>=3){var o=t[s],c=Math.ceil(Math.log2(Math.abs(o)+1))+1;i.writeBits(1,1),i.writeBits(c,5),i.writeBits(n,8),i.writeBits(this._encodeSigned(o,c),c),s+=n}else{for(var l=[];s<t.length&&l.length<255&&(s+2>=t.length||t[s]!==t[s+1]||t[s]!==t[s+2]);)l.push(t[s++]);var u=Math.min.apply(Math,l),p=Math.max.apply(Math,l),h=Math.ceil(Math.log2(Math.max(Math.abs(u),Math.abs(p))+1))+1;i.writeBits(0,1),i.writeBits(h,5),i.writeBits(l.length,8);for(var f=0,d=l;f<d.length;f++){var E=d[f];i.writeBits(this._encodeSigned(E,h),h)}}}return i.finish()}},{key:"decode",value:function(e){for(var t=new a.BitReader(e),r=[];;)try{var i=t.readBits(1),s=t.readBits(5),n=t.readBits(8);if(i)for(var o=this._decodeSigned(t.readBits(s),s),c=0;c<n;c++)r.push(o);else for(var l=0;l<n;l++)r.push(this._decodeSigned(t.readBits(s),s))}catch(e){break}for(var u=[],p=0;p<r.length;p++)u[p]=0===p?r[0]:u[p-1]+r[p];return u}}])},{"./bitwriter":26,"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/interopRequireDefault":6}],28:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.SnowFallVM=void 0;var s=i(e("@babel/runtime/helpers/toConsumableArray")),n=i(e("@babel/runtime/helpers/typeof")),a=i(e("@babel/runtime/helpers/classCallCheck")),o=i(e("@babel/runtime/helpers/createClass")),c=i(e("@babel/runtime/helpers/defineProperty")),l=e("../const/opcodes"),u=e("../util/compressor");r.SnowFallVM=(0,o.default)((function e(t,r){(0,a.default)(this,e),(0,c.default)(this,"frames",[]),(0,c.default)(this,"stack",[]),(0,c.default)(this,"globals",new Map),(0,c.default)(this,"handlerStack",[]),this.settings=r,console.log(t);var i=this.decompressData(t);this.stack.push(i);var s={func:i,ip:0,stackStart:0};this.frames.push(s),this.frame=s}),[{key:"readByte",value:function(){return this.frame.func.chunk.code[this.frame.ip++]}},{key:"readShort",value:function(){this.frame.ip+=2;var e=this.frame.func.chunk.code;return e[this.frame.ip-2]<<8|e[this.frame.ip-1]}},{key:"readConstant",value:function(){return this.frame.func.chunk.constants[this.readByte()]}},{key:"runtimeError",value:function(e){for(var t="\n--- Stack Trace ---\n",r=this.frames.length-1;r>=0;r--){var i=this.frames[r],s=i.func.name||"(script)",n=i.func.chunk.lines[i.ip-1]||"unknown";t+="  at ".concat(s," (line ").concat(n,")\n")}return new Error("".concat(e,"\n").concat(t))}},{key:"run",value:function(){try{for(;;){var e=this.readByte();switch(e){case l.OpCode.CHECK_TYPE:var t=this.readConstant().toLowerCase(),r=this.stack[this.stack.length-1],i=void 0;if(t!==(i=null===r?"null":Array.isArray(r)?"array":(0,n.default)(r)))throw this.runtimeError("TypeError: Expected type '".concat(t,"' but got '").concat(i,"'."));break;case l.OpCode.PUSH_TRUE:this.stack.push(!0);break;case l.OpCode.PUSH_FALSE:this.stack.push(!1);break;case l.OpCode.PUSH_CONST:this.stack.push(this.readConstant());break;case l.OpCode.PUSH_NULL:this.stack.push(null);break;case l.OpCode.POP:this.stack.pop();break;case l.OpCode.DEFINE_GLOBAL:var a=this.readConstant();this.globals.set(a,this.stack[this.stack.length-1]),this.stack.pop();break;case l.OpCode.GET_GLOBAL:var o=this.readConstant();if(!this.globals.has(o))throw new Error("VM Error: Undefined global variable '".concat(o,"'."));this.stack.push(this.globals.get(o));break;case l.OpCode.SET_GLOBAL:var c=this.readConstant();if(!this.globals.has(c))throw new Error("VM Error: Undefined global variable '".concat(c,"'."));this.globals.set(c,this.stack[this.stack.length-1]);break;case l.OpCode.GET_LOCAL:var u=this.readByte();this.stack.push(this.stack[this.frame.stackStart+u]);break;case l.OpCode.SET_LOCAL:var p=this.readByte();this.stack[this.frame.stackStart+p]=this.stack[this.stack.length-1];break;case l.OpCode.BUILD_ARRAY:var h=this.readByte(),f=this.stack.splice(this.stack.length-h,h);this.stack.push(f);break;case l.OpCode.BUILD_OBJECT:for(var d=this.readByte(),E={},m=0;m<d;m++){var k=this.stack.pop();E[this.stack.pop()]=k}this.stack.push(E);break;case l.OpCode.GET_PROPERTY:var b=this.stack.pop(),y=this.stack.pop();if(null==y)throw new Error("VM Error: Cannot read property of null or undefined.");this.stack.push(y[b]);break;case l.OpCode.SET_PROPERTY:var _=this.stack.pop(),v=this.stack.pop(),C=this.stack.pop();if(null==C)throw new Error("VM Error: Cannot set property of null or undefined.");C[v]=_,this.stack.push(_);break;case l.OpCode.EQUAL:var S=this.stack.pop(),O=this.stack.pop();this.stack.push(O===S);break;case l.OpCode.NOT_EQUAL:var A=this.stack.pop(),T=this.stack.pop();this.stack.push(T!==A);break;case l.OpCode.GREATER_THAN:var L=this.stack.pop(),P=this.stack.pop();this.stack.push(P>L);break;case l.OpCode.GREATER_EQUAL:var R=this.stack.pop(),N=this.stack.pop();this.stack.push(N>=R);break;case l.OpCode.LESS_THAN:var I=this.stack.pop(),x=this.stack.pop();this.stack.push(x<I);break;case l.OpCode.LESS_EQUAL:var g=this.stack.pop(),D=this.stack.pop();this.stack.push(D<=g);break;case l.OpCode.BITWISE_AND:var U=this.stack.pop(),M=this.stack.pop();if("number"!=typeof M||"number"!=typeof U)throw new Error("VM Error: Operands must be two numbers for bitwise AND.");this.stack.push(M&U);break;case l.OpCode.BITWISE_OR:var B=this.stack.pop(),w=this.stack.pop();if("number"!=typeof w||"number"!=typeof B)throw new Error("VM Error: Operands must be two numbers for bitwise OR.");this.stack.push(w|B);break;case l.OpCode.ADD:var F=this.stack.pop(),W=this.stack.pop();if("number"==typeof W&&"number"==typeof F)this.stack.push(W+F);else{if("string"!=typeof W&&"string"!=typeof F)throw new Error("VM Error: Operands must be two numbers or at least one string.");this.stack.push(String(W)+String(F))}break;case l.OpCode.SUBTRACT:var X=this.stack.pop(),j=this.stack.pop();if("number"!=typeof j||"number"!=typeof X)throw new Error("VM Error: Operands must be two numbers.");this.stack.push(j-X);break;case l.OpCode.MULTIPLY:var G=this.stack.pop(),H=this.stack.pop();if("number"==typeof H&&"number"==typeof G)this.stack.push(H*G);else if("string"==typeof H&&"number"==typeof G)this.stack.push(H.repeat(G));else{if("number"!=typeof H||"string"!=typeof G)throw new Error("VM Error: Operands must be two numbers. Or one string and one number.");this.stack.push(G.repeat(H))}break;case l.OpCode.DIVIDE:var Y=this.stack.pop(),J=this.stack.pop();if("number"!=typeof J||"number"!=typeof Y)throw new Error("VM Error: Operands must be two numbers.");if(0===Y)throw new Error("VM Error: Division by zero.");this.stack.push(J/Y);break;case l.OpCode.MODULO:var K=this.stack.pop(),Q=this.stack.pop();if("number"!=typeof Q||"number"!=typeof K)throw new Error("VM Error: Operands must be two numbers.");if(0===K)throw new Error("VM Error: Division by zero.");this.stack.push(Q%K);break;case l.OpCode.NEGATE:var V=this.stack.pop();"number"==typeof V?this.stack.push(-V):this.stack.push(!V);break;case l.OpCode.JUMP:var q,Z=this.readShort();null!==(q=this.settings.hooks)&&void 0!==q&&q.beforeJump&&this.settings.hooks.beforeJump(this,"JUMP"),this.frame.ip+=Z;break;case l.OpCode.JUMP_IF_FALSE:var z,$=this.readShort();null!==(z=this.settings.hooks)&&void 0!==z&&z.beforeJump&&this.settings.hooks.beforeJump(this,"JUMP_IF_FALSE"),this.stack[this.stack.length-1]||(this.frame.ip+=$);break;case l.OpCode.LOOP:var ee=this.readShort();this.frame.ip-=ee;break;case l.OpCode.CALL:var te=this.readByte(),re=this.stack[this.stack.length-1-te];if(!re||"object"!==(0,n.default)(re)||void 0===re.arity)throw new Error("VM Error: Can only call functions.");if(te!==re.arity)throw new Error("VM Error: Expected ".concat(re.arity," arguments but got ").concat(te,"."));var ie={func:this.decompressData(re),ip:0,stackStart:this.stack.length-te};this.frames.push(ie),this.frame=ie;break;case l.OpCode.RETURN:var se=this.stack.pop(),ne=this.frames.pop();if(0===this.frames.length)return se;this.stack.splice(ne.stackStart),this.stack.push(se),this.frame=this.frames[this.frames.length-1];break;case l.OpCode.CALL_BUILTIN:var ae=this.readConstant(),oe=this.readByte(),ce=this.stack.splice(this.stack.length-oe,oe),le=this.settings.builtInFunctions[ae];if(!le)throw new Error("VM Error: Built-in function ".concat(ae," not found."));var ue=le.apply(void 0,(0,s.default)(ce));this.stack.push(void 0===ue?null:ue);break;case l.OpCode.SETUP_EXCEPTION:var pe=this.readShort();this.handlerStack.push({catchAddress:this.frame.ip+pe,finallyAddress:null,stackDepth:this.stack.length});break;case l.OpCode.TEARDOWN_EXCEPTION:this.handlerStack.pop();break;default:throw new Error("VM Error: Unknown opcode ".concat(e))}}}catch(e){e.message.includes("--- Stack Trace ---")?console.error(e.message):console.error(this.runtimeError(e.message))}}},{key:"decompressData",value:function(e){return void 0!==e.chunk?e:{name:e.name,arity:e.arity,chunk:{code:u.Compressor.decodeNumbers(e.code),constants:u.Compressor.decodeJSON(e.constants),lines:u.Compressor.decodeSmartPack(e.lines)}}}}])},{"../const/opcodes":17,"../util/compressor":25,"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/defineProperty":5,"@babel/runtime/helpers/interopRequireDefault":6,"@babel/runtime/helpers/toConsumableArray":9,"@babel/runtime/helpers/typeof":12}]},{},[18]);
//# sourceMappingURL=SnowFall.min.js.map