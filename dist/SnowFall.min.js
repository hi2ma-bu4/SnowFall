!function e(t,r,i){function n(a,o){if(!r[a]){if(!t[a]){var c="function"==typeof require&&require;if(!o&&c)return c(a,!0);if(s)return s(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[a]={exports:{}};t[a][0].call(l.exports,(function(e){return n(t[a][1][e]||e)}),l,l.exports,e,t,r,i)}return r[a].exports}for(var s="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(e,t,r){t.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i},t.exports.__esModule=!0,t.exports.default=t.exports},{}],2:[function(e,t,r){var i=e("./arrayLikeToArray.js");t.exports=function(e){if(Array.isArray(e))return i(e)},t.exports.__esModule=!0,t.exports.default=t.exports},{"./arrayLikeToArray.js":1}],3:[function(e,t,r){t.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},{}],4:[function(e,t,r){var i=e("./toPropertyKey.js");function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}t.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},t.exports.__esModule=!0,t.exports.default=t.exports},{"./toPropertyKey.js":11}],5:[function(e,t,r){var i=e("./toPropertyKey.js");t.exports=function(e,t,r){return(t=i(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},t.exports.__esModule=!0,t.exports.default=t.exports},{"./toPropertyKey.js":11}],6:[function(e,t,r){t.exports=function(e){return e&&e.__esModule?e:{default:e}},t.exports.__esModule=!0,t.exports.default=t.exports},{}],7:[function(e,t,r){t.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},t.exports.__esModule=!0,t.exports.default=t.exports},{}],8:[function(e,t,r){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},{}],9:[function(e,t,r){var i=e("./arrayWithoutHoles.js"),n=e("./iterableToArray.js"),s=e("./unsupportedIterableToArray.js"),a=e("./nonIterableSpread.js");t.exports=function(e){return i(e)||n(e)||s(e)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},{"./arrayWithoutHoles.js":2,"./iterableToArray.js":7,"./nonIterableSpread.js":8,"./unsupportedIterableToArray.js":13}],10:[function(e,t,r){var i=e("./typeof.js").default;t.exports=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},t.exports.__esModule=!0,t.exports.default=t.exports},{"./typeof.js":12}],11:[function(e,t,r){var i=e("./typeof.js").default,n=e("./toPrimitive.js");t.exports=function(e){var t=n(e,"string");return"symbol"==i(t)?t:t+""},t.exports.__esModule=!0,t.exports.default=t.exports},{"./toPrimitive.js":10,"./typeof.js":12}],12:[function(e,t,r){function i(e){return t.exports=i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t.exports.__esModule=!0,t.exports.default=t.exports,i(e)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},{}],13:[function(e,t,r){var i=e("./arrayLikeToArray.js");t.exports=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports},{"./arrayLikeToArray.js":1}],14:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.Compiler=void 0;var n=i(e("@babel/runtime/helpers/defineProperty")),s=i(e("@babel/runtime/helpers/createClass")),a=i(e("@babel/runtime/helpers/classCallCheck")),o=e("../const/opcodes"),c=e("../util/compressor");function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return l(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){o=!0,s=e},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw s}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var p=(0,s.default)((function e(t,r,i,n){(0,a.default)(this,e),this.name=t,this.depth=r,this.index=i,this.isConst=n})),h=(0,s.default)((function e(t){(0,a.default)(this,e),(0,n.default)(this,"store",new Map),(0,n.default)(this,"localCount",0),(0,n.default)(this,"parentLocalCount",0),this.parent=t,t&&(this.parentLocalCount=t.parentLocalCount+t.localCount)}),[{key:"define",value:function(e,t,r){var i=this.parentLocalCount+this.localCount,n=new p(e,t,i,r);return this.store.set(e,n),this.localCount++,n}},{key:"resolve",value:function(e){var t=this.store.get(e);return t||(this.parent?this.parent.resolve(e):null)}}]),f=r.Compiler=function(){function e(t,r){var i=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,a.default)(this,e),(0,n.default)(this,"scopeDepth",0),(0,n.default)(this,"loopContext",[]),this.ast=t,this.currentNode=t,console.log(t),this.settings=r,this.parentCompiler=s,this.symbolTable=new h(null==s?void 0:s.symbolTable),this.scopeDepth=s?s.scopeDepth+1:0;var c="FunctionDeclaration"===t.type,u=c?t:null,l=c?u.name.name:"main",p=c?u.params.length:0;this.compiledFunction={name:l,arity:p,chunk:{code:[],constants:[],lines:[]}},c?this.symbolTable.define(l,this.scopeDepth,!0):this.symbolTable.define("main",this.scopeDepth,!0),c&&u.params.forEach((function(e,t){var r=i.symbolTable.define(e.name.name,i.scopeDepth,!1);if(e.typeAnnotation){var n=e.typeAnnotation.name;"any"!==n.toLowerCase()&&(i.emitBytes(o.OpCode.GET_LOCAL,r.index),i.emitBytes(o.OpCode.CHECK_TYPE,i.addConstant(n)),i.emit(o.OpCode.POP))}}))}return(0,s.default)(e,[{key:"currentChunk",value:function(){return this.compiledFunction.chunk}},{key:"emit",value:function(e){var t=this.currentChunk();t.code.push(e),t.lines.push(this.currentNode.line)}},{key:"emitBytes",value:function(){for(var e=this,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];r.forEach((function(t){return e.emit(t)}))}},{key:"addConstant",value:function(e){var t=this.currentChunk().constants,r=t.findIndex((function(t){return t===e}));return-1!==r?r:t.push(e)-1}},{key:"emitConstant",value:function(e){this.emitBytes(o.OpCode.PUSH_CONST,this.addConstant(e))}},{key:"emitJump",value:function(e){return this.emit(e),this.emit(255),this.emit(255),this.currentChunk().code.length-2}},{key:"patchJump",value:function(e){var t=this.currentChunk().code.length-e-2;if(t>65535)throw new Error("Compiler Error: Too much code to jump over.");this.currentChunk().code[e]=t>>8&255,this.currentChunk().code[e+1]=255&t}},{key:"emitLoop",value:function(e){this.emit(o.OpCode.LOOP);var t=this.currentChunk().code.length-e+2;if(t>65535)throw new Error("Compiler Error: Loop body too large.");this.emit(t>>8&255),this.emit(255&t)}},{key:"beginScope",value:function(){this.scopeDepth++,this.symbolTable=new h(this.symbolTable)}},{key:"endScope",value:function(){var e=this.symbolTable.localCount;if(this.currentChunk().code[this.currentChunk().code.length-1]!==o.OpCode.RETURN)for(var t=0;t<e;t++)this.emit(o.OpCode.POP);this.scopeDepth--,this.symbolTable.parent&&(this.symbolTable=this.symbolTable.parent)}},{key:"compileNode",value:function(e){var t=this.currentNode;switch(this.currentNode=e,e.type){case"Program":this.compileStatements(e.body);break;case"EmptyStatement":break;case"BlockStatement":this.beginScope(),this.compileStatements(e.body),this.endScope();break;case"ExpressionStatement":this.compileNode(e.expression),this.emit(o.OpCode.POP);break;case"VariableDeclaration":this.compileVariableDeclaration(e);break;case"Identifier":this.compileIdentifier(e);break;case"NumericLiteral":case"StringLiteral":this.emitConstant(e.value);break;case"BooleanLiteral":this.emit(e.value?o.OpCode.PUSH_TRUE:o.OpCode.PUSH_FALSE);break;case"ArrayLiteral":this.compileArrayLiteral(e);break;case"ObjectLiteral":this.compileObjectLiteral(e);break;case"IfStatement":this.compileIfStatement(e);break;case"ForStatement":this.compileForStatement(e);break;case"WhileStatement":this.compileWhileStatement(e);break;case"SwitchStatement":this.compileSwitchStatement(e);break;case"BreakStatement":this.compileBreakStatement(e);break;case"FunctionDeclaration":if("FunctionDeclaration"===this.ast.type&&e===this.ast){this.compileStatements(e.body.body);break}this.compileFunctionDeclaration(e);break;case"ReturnStatement":this.compileReturnStatement(e);break;case"CallExpression":this.compileCallExpression(e);break;case"MemberExpression":this.compileMemberExpression(e);break;case"AssignmentExpression":this.compileAssignmentExpression(e);break;case"UnaryExpression":this.compileUnaryExpression(e);break;case"UpdateExpression":this.compileUpdateExpression(e);break;case"BinaryExpression":this.compileBinaryExpression(e);break;case"LogicalExpression":this.compileLogicalExpression(e);break;case"TryStatement":this.compileTryStatement(e);break;default:throw new Error("Compiler Error: Unknown AST node type: ".concat(e.type))}this.currentNode=t}},{key:"compileStatements",value:function(e){var t=this;e.forEach((function(e){return t.compileNode(e)}))}},{key:"compileVariableDeclaration",value:function(e){if(e.init?this.compileNode(e.init):this.emit(o.OpCode.PUSH_NULL),e.typeAnnotation){var t=e.typeAnnotation.name;"any"!==t.toLowerCase()&&(this.emit(o.OpCode.DUP),this.emitBytes(o.OpCode.CHECK_TYPE,this.addConstant(t)))}0===this.scopeDepth?this.emitBytes(o.OpCode.DEFINE_GLOBAL,this.addConstant(e.identifier.name)):this.symbolTable.define(e.identifier.name,this.scopeDepth,"const"===e.kind)}},{key:"compileIdentifier",value:function(e){if(!this.settings.builtInFunctions[e.name]){var t=this.symbolTable.resolve(e.name);t?this.emitBytes(o.OpCode.GET_LOCAL,t.index):this.emitBytes(o.OpCode.GET_GLOBAL,this.addConstant(e.name))}}},{key:"compileAssignmentExpression",value:function(e){if(this.compileNode(e.right),"Identifier"===e.left.type){var t=e.left.name,r=this.symbolTable.resolve(t);if(r){if(r.isConst)throw new Error("Compiler Error: Cannot assign to constant variable '".concat(t,"'."));this.emitBytes(o.OpCode.SET_LOCAL,r.index)}else this.emitBytes(o.OpCode.SET_GLOBAL,this.addConstant(t))}else{if("MemberExpression"!==e.left.type)throw new Error("Compiler Error: Invalid assignment target.");var i=e.left;this.compileNode(i.object),this.compileNode(i.property),this.emit(o.OpCode.SET_PROPERTY)}}},{key:"compileUpdateExpression",value:function(e){var t=e.argument,r=e.operator,i=e.prefix;if("Identifier"!==t.type)throw new Error("Compiler Error: Update expressions currently only support identifiers.");var n=this.symbolTable.resolve(t.name),s=!!n;if(s&&n.isConst)throw new Error("Compiler Error: Cannot assign to constant variable '".concat(t.name,"'."));var a=s?o.OpCode.GET_LOCAL:o.OpCode.GET_GLOBAL,c=s?n.index:this.addConstant(t.name),u=s?o.OpCode.SET_LOCAL:o.OpCode.SET_GLOBAL,l=s?n.index:this.addConstant(t.name);this.emitBytes(a,c),i||this.emitBytes(a,c),this.emitConstant(1),this.emit("++"===r?o.OpCode.ADD:o.OpCode.SUBTRACT),this.emitBytes(u,l),i||this.emit(o.OpCode.POP)}},{key:"compileArrayLiteral",value:function(e){var t=this;e.elements.forEach((function(e){return t.compileNode(e)})),this.emitBytes(o.OpCode.BUILD_ARRAY,e.elements.length)}},{key:"compileObjectLiteral",value:function(e){var t=this;e.properties.forEach((function(e){t.emitConstant(e.key.value),t.compileNode(e.value)})),this.emitBytes(o.OpCode.BUILD_OBJECT,e.properties.length)}},{key:"compileMemberExpression",value:function(e){this.compileNode(e.object),"Identifier"===e.property.type?this.emitConstant(e.property.name):this.compileNode(e.property),this.emit(o.OpCode.GET_PROPERTY)}},{key:"compileIfStatement",value:function(e){this.compileNode(e.test);var t=this.emitJump(o.OpCode.JUMP_IF_FALSE);if(this.emit(o.OpCode.POP),this.compileNode(e.consequence),e.alternate){var r=this.emitJump(o.OpCode.JUMP);this.patchJump(t),this.emit(o.OpCode.POP),this.compileNode(e.alternate),this.patchJump(r)}else this.patchJump(t),this.emit(o.OpCode.POP)}},{key:"compileForStatement",value:function(e){var t=this;this.beginScope(),e.init&&(this.compileNode(e.init),"VariableDeclaration"!==e.init.type&&this.emit(o.OpCode.POP));var r=this.currentChunk().code.length;this.loopContext.push({loopStart:r,exitJumps:[]});var i=-1;e.test&&(this.compileNode(e.test),i=this.emitJump(o.OpCode.JUMP_IF_FALSE),this.emit(o.OpCode.POP)),this.compileNode(e.body),e.update&&(this.compileNode(e.update),this.emit(o.OpCode.POP)),this.emitLoop(r),-1!==i&&(this.patchJump(i),this.emit(o.OpCode.POP)),this.loopContext.pop().exitJumps.forEach((function(e){return t.patchJump(e)})),this.endScope()}},{key:"compileWhileStatement",value:function(e){var t=this,r=this.currentChunk().code.length;this.loopContext.push({loopStart:r,exitJumps:[]}),this.compileNode(e.test);var i=this.emitJump(o.OpCode.JUMP_IF_FALSE);this.emit(o.OpCode.POP),this.compileNode(e.body),this.emitLoop(r),this.patchJump(i),this.emit(o.OpCode.POP),this.loopContext.pop().exitJumps.forEach((function(e){return t.patchJump(e)}))}},{key:"compileSwitchStatement",value:function(e){var t=this;this.compileNode(e.discriminant),this.loopContext.push({loopStart:-1,exitJumps:[]});var r,i=e.cases.find((function(e){return null===e.test})),n=[],s=!1,a=u(e.cases);try{for(a.s();!(r=a.n()).done;){var c=r.value;if(null!==c.test){n.length>0&&(this.patchJump(n.pop()),this.emit(o.OpCode.POP)),s||(this.emit(o.OpCode.DUP),this.compileNode(c.test),this.emit(o.OpCode.EQUAL));var l=this.emitJump(o.OpCode.JUMP_IF_FALSE);n.push(l),this.emit(o.OpCode.POP),this.compileStatements(c.consequent),s=!1;var p=c.consequent[c.consequent.length-1].type;"BreakStatement"!==p&&"ReturnStatement"!==p&&(s=!0)}}}catch(e){a.e(e)}finally{a.f()}var h=this.emitJump(o.OpCode.JUMP);n.length>0&&(this.patchJump(n.pop()),this.emit(o.OpCode.POP)),i&&this.compileStatements(i.consequent),this.patchJump(h),this.loopContext.pop().exitJumps.forEach((function(e){return t.patchJump(e)})),this.emit(o.OpCode.POP)}},{key:"compileBreakStatement",value:function(e){if(0===this.loopContext.length)throw new Error("Compiler Error: 'break' statement outside of a loop or switch.");var t=this.emitJump(o.OpCode.JUMP);this.loopContext[this.loopContext.length-1].exitJumps.push(t)}},{key:"compileFunctionDeclaration",value:function(t){var r,i=new e(t,this.settings,this),n=i.compile();r=JSON.stringify(n).length*e.FUNCTION_COMPRESS_MAGNIFICATION<JSON.stringify(i.compiledFunction).length?n:i.compiledFunction;var s=this.addConstant(r);this.emitBytes(o.OpCode.PUSH_CONST,s),0===this.scopeDepth?this.emitBytes(o.OpCode.DEFINE_GLOBAL,this.addConstant(t.name.name)):this.symbolTable.define(t.name.name,this.scopeDepth,!1)}},{key:"compileReturnStatement",value:function(e){if(e.argument?this.compileNode(e.argument):this.emit(o.OpCode.PUSH_NULL),"FunctionDeclaration"===this.ast.type){var t=this.ast;if(t.returnType){var r=t.returnType.name;"any"!==r.toLowerCase()&&(this.emit(o.OpCode.DUP),this.emitBytes(o.OpCode.CHECK_TYPE,this.addConstant(r)))}}this.emit(o.OpCode.RETURN)}},{key:"compileCallExpression",value:function(e){this.compileNode(e.callee);var t,r=u(e.arguments);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.compileNode(i)}}catch(e){r.e(e)}finally{r.f()}if("Identifier"===e.callee.type&&this.settings.builtInFunctions[e.callee.name]){var n=this.addConstant(e.callee.name);this.emitBytes(o.OpCode.CALL_BUILTIN,n,e.arguments.length)}else this.emitBytes(o.OpCode.CALL,e.arguments.length)}},{key:"compileUnaryExpression",value:function(e){switch(e.operator){case"!":this.compileNode(e.right),this.emit(o.OpCode.NEGATE);break;case"-":this.emitConstant(0),this.compileNode(e.right),this.emit(o.OpCode.SUBTRACT);break;default:throw new Error("Compiler Error: Unknown unary operator ".concat(e.operator))}}},{key:"compileBinaryExpression",value:function(e){if("NumericLiteral"===e.left.type&&"NumericLiteral"===e.right.type){var t=e.left.value,r=e.right.value,i=null;switch(e.operator){case"+":i=t+r;break;case"-":i=t-r;break;case"*":i=t*r;break;case"/":i=0!==r?t/r:null;break;case"%":i=0!==r?t%r:null}if(null!==i)return void this.emitConstant(i)}switch(this.compileNode(e.left),this.compileNode(e.right),e.operator){case"+":this.emit(o.OpCode.ADD);break;case"-":this.emit(o.OpCode.SUBTRACT);break;case"*":this.emit(o.OpCode.MULTIPLY);break;case"/":this.emit(o.OpCode.DIVIDE);break;case"%":this.emit(o.OpCode.MODULO);break;case"==":this.emit(o.OpCode.EQUAL);break;case"!=":this.emit(o.OpCode.NOT_EQUAL);break;case"<":this.emit(o.OpCode.LESS_THAN);break;case"<=":this.emit(o.OpCode.LESS_EQUAL);break;case">":this.emit(o.OpCode.GREATER_THAN);break;case">=":this.emit(o.OpCode.GREATER_EQUAL);break;case"&":this.emit(o.OpCode.BITWISE_AND);break;case"|":this.emit(o.OpCode.BITWISE_OR);break;default:throw new Error("Compiler Error: Unknown binary operator ".concat(e.operator))}}},{key:"compileLogicalExpression",value:function(e){if("&&"===e.operator){this.compileNode(e.left);var t=this.emitJump(o.OpCode.JUMP_IF_FALSE);this.emit(o.OpCode.POP),this.compileNode(e.right),this.patchJump(t)}else if("||"===e.operator){this.compileNode(e.left);var r=this.emitJump(o.OpCode.JUMP_IF_FALSE),i=this.emitJump(o.OpCode.JUMP);this.patchJump(r),this.emit(o.OpCode.POP),this.compileNode(e.right),this.patchJump(i)}}},{key:"compileTryStatement",value:function(e){var t=this.emitJump(o.OpCode.SETUP_EXCEPTION);this.compileNode(e.tryBlock),this.emit(o.OpCode.TEARDOWN_EXCEPTION);var r=this.emitJump(o.OpCode.JUMP);this.patchJump(t),e.catchClause&&(this.beginScope(),this.symbolTable.define(e.catchClause.param.name,this.scopeDepth,!1),this.compileNode(e.catchClause.body),this.endScope()),this.patchJump(r),e.finallyBlock&&this.compileNode(e.finallyBlock)}},{key:"compressData",value:function(){var e;return null!==(e=this.settings.output)&&void 0!==e&&e.compact?{name:this.compiledFunction.name,arity:this.compiledFunction.arity,code:c.Compressor.encodeNumbers(this.compiledFunction.chunk.code),constants:c.Compressor.encodeJSON(this.compiledFunction.chunk.constants),lines:c.Compressor.encodeSmartPack(this.compiledFunction.chunk.lines)}:this.compiledFunction}},{key:"compile",value:function(){return this.compileNode(this.ast),"Program"!==this.ast.type&&"FunctionDeclaration"!==this.ast.type||(this.emit(o.OpCode.PUSH_NULL),this.emit(o.OpCode.RETURN)),this.compressData()}}])}();(0,n.default)(f,"FUNCTION_COMPRESS_MAGNIFICATION",4)},{"../const/opcodes":17,"../util/compressor":25,"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/defineProperty":5,"@babel/runtime/helpers/interopRequireDefault":6}],15:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.Lexer=void 0;var n=i(e("@babel/runtime/helpers/classCallCheck")),s=i(e("@babel/runtime/helpers/createClass")),a=i(e("@babel/runtime/helpers/defineProperty"));r.Lexer=(0,s.default)((function e(t){(0,n.default)(this,e),(0,a.default)(this,"pos",0),(0,a.default)(this,"line",1),(0,a.default)(this,"column",1),(0,a.default)(this,"keywords",{let:"KEYWORD",const:"KEYWORD",if:"KEYWORD",else:"KEYWORD",for:"KEYWORD",while:"KEYWORD",switch:"KEYWORD",case:"KEYWORD",default:"KEYWORD",break:"KEYWORD",function:"KEYWORD",return:"KEYWORD",true:"TRUE",false:"FALSE",try:"KEYWORD",catch:"KEYWORD",finally:"KEYWORD",throw:"KEYWORD"}),this.source=t,this.currentChar=this.source[this.pos]}),[{key:"advance",value:function(){"\n"===this.currentChar?(this.line++,this.column=1):this.column++,this.pos++,this.currentChar=this.pos<this.source.length?this.source[this.pos]:null}},{key:"peek",value:function(){return this.pos+1<this.source.length?this.source[this.pos+1]:null}},{key:"string",value:function(e){var t=this.line,r=this.column;this.advance();for(var i="";this.currentChar!==e&&null!==this.currentChar;){if("\n"===this.currentChar&&"`"!==e)throw new Error("Lexer Error: Unterminated string at line ".concat(t,", column ").concat(r,"."));i+=this.currentChar,this.advance()}if(null===this.currentChar)throw new Error("Lexer Error: Unterminated string.");return this.advance(),this.createToken("STRING",i)}},{key:"number",value:function(){for(var e="";null!==this.currentChar&&/\d/.test(this.currentChar);)e+=this.currentChar,this.advance();if("."===this.currentChar&&null!==this.peek()&&/\d/.test(this.peek()))for(e+=this.currentChar,this.advance();null!==this.currentChar&&/\d/.test(this.currentChar);)e+=this.currentChar,this.advance();return this.createToken("NUMBER",e)}},{key:"skipWhitespaceAndComments",value:function(){for(;null!==this.currentChar;)if(/\s/.test(this.currentChar))this.advance();else if("/"!==this.currentChar||"/"!==this.peek()){if("/"!==this.currentChar||"*"!==this.peek())break;for(this.advance(),this.advance();null!==this.currentChar&&("*"!==this.currentChar||"/"!==this.peek());)this.advance();null!==this.currentChar&&(this.advance(),this.advance())}else for(;"\n"!==this.currentChar&&null!==this.currentChar;)this.advance()}},{key:"createToken",value:function(e,t){return{type:e,value:t,line:this.line,column:this.column}}},{key:"identifier",value:function(){for(var e="";null!==this.currentChar&&/[a-zA-Z_0-9]/.test(this.currentChar);)e+=this.currentChar,this.advance();var t=this.keywords[e]||"IDENTIFIER";return this.createToken(t,e)}},{key:"tokenize",value:function(){for(var e=[];null!==this.currentChar&&(this.skipWhitespaceAndComments(),null!==this.currentChar);)if('"'!==this.currentChar&&"'"!==this.currentChar&&"`"!==this.currentChar)if(/\d/.test(this.currentChar))e.push(this.number());else if(/[a-zA-Z_]/.test(this.currentChar))e.push(this.identifier());else{switch(this.currentChar){case"=":e.push("="===this.peek()?(this.advance(),this.createToken("EQUAL_EQUAL","==")):this.createToken("EQUALS","="));break;case"!":e.push("="===this.peek()?(this.advance(),this.createToken("BANG_EQUAL","!=")):this.createToken("BANG","!"));break;case">":e.push("="===this.peek()?(this.advance(),this.createToken("GREATER_EQUAL",">=")):this.createToken("GREATER",">"));break;case"<":e.push("="===this.peek()?(this.advance(),this.createToken("LESS_EQUAL","<=")):this.createToken("LESS","<"));break;case"&":e.push("&"===this.peek()?(this.advance(),this.createToken("AND","&&")):this.createToken("AMPERSAND","&"));break;case"|":e.push("|"===this.peek()?(this.advance(),this.createToken("OR","||")):this.createToken("PIPE","|"));break;case"+":e.push("+"===this.peek()?(this.advance(),this.createToken("PLUS_PLUS","++")):this.createToken("PLUS","+"));break;case"-":e.push("-"===this.peek()?(this.advance(),this.createToken("MINUS_MINUS","--")):this.createToken("MINUS","-"));break;case"*":e.push(this.createToken("STAR","*"));break;case"/":e.push(this.createToken("SLASH","/"));break;case"%":e.push(this.createToken("PERCENT","%"));break;case"(":e.push(this.createToken("LPAREN","("));break;case")":e.push(this.createToken("RPAREN",")"));break;case"{":e.push(this.createToken("LBRACE","{"));break;case"}":e.push(this.createToken("RBRACE","}"));break;case"[":e.push(this.createToken("LBRACKET","["));break;case"]":e.push(this.createToken("RBRACKET","]"));break;case";":e.push(this.createToken("SEMICOLON",";"));break;case":":e.push(this.createToken("COLON",":"));break;case",":e.push(this.createToken("COMMA",","));break;default:throw new Error("Lexer Error: Unknown character: ".concat(this.currentChar))}this.advance()}else e.push(this.string(this.currentChar));return e.push(this.createToken("EOF","")),e}}])},{"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/defineProperty":5,"@babel/runtime/helpers/interopRequireDefault":6}],16:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.Parser=void 0;var n,s=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass")),o=i(e("@babel/runtime/helpers/defineProperty"));function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e[e.LOWEST=0]="LOWEST",e[e.ASSIGNMENT=1]="ASSIGNMENT",e[e.OR=2]="OR",e[e.AND=3]="AND",e[e.BITWISE_OR=4]="BITWISE_OR",e[e.BITWISE_AND=5]="BITWISE_AND",e[e.EQUALS=6]="EQUALS",e[e.LESS_GREATER=7]="LESS_GREATER",e[e.SUM=8]="SUM",e[e.PRODUCT=9]="PRODUCT",e[e.PREFIX=10]="PREFIX",e[e.POSTFIX=11]="POSTFIX",e[e.CALL=12]="CALL",e[e.INDEX=13]="INDEX"}(n||(n={}));var l={EQUALS:n.ASSIGNMENT,OR:n.OR,AND:n.AND,PIPE:n.BITWISE_OR,AMPERSAND:n.BITWISE_AND,EQUAL_EQUAL:n.EQUALS,BANG_EQUAL:n.EQUALS,GREATER:n.LESS_GREATER,GREATER_EQUAL:n.LESS_GREATER,LESS:n.LESS_GREATER,LESS_EQUAL:n.LESS_GREATER,PLUS:n.SUM,MINUS:n.SUM,STAR:n.PRODUCT,SLASH:n.PRODUCT,PERCENT:n.PRODUCT,PLUS_PLUS:n.POSTFIX,MINUS_MINUS:n.POSTFIX,LPAREN:n.CALL,LBRACKET:n.INDEX,DOT:n.INDEX};r.Parser=(0,a.default)((function e(t){var r=this;(0,s.default)(this,e),(0,o.default)(this,"pos",0),(0,o.default)(this,"parseIdentifier",(function(){return r.createNode("Identifier",{name:r.currentToken.value})})),(0,o.default)(this,"parseNumericLiteral",(function(){return r.createNode("NumericLiteral",{value:parseFloat(r.currentToken.value)})})),(0,o.default)(this,"parseStringLiteral",(function(){return r.createNode("StringLiteral",{value:r.currentToken.value})})),(0,o.default)(this,"parseBooleanLiteral",(function(){return r.createNode("BooleanLiteral",{value:"TRUE"===r.currentToken.type})})),(0,o.default)(this,"parseAssignmentExpression",(function(e){if("Identifier"!==e.type&&"MemberExpression"!==e.type)throw new Error("Parser Error: Invalid assignment target.");var t=r.currentPrecedence();r.advance();var i=r.parseExpression(t-1);return r.createNode("AssignmentExpression",{left:e,right:i})})),(0,o.default)(this,"parsePrefixExpression",(function(){var e=r.currentToken.value;r.advance();var t=r.parseExpression(n.PREFIX);return r.createNode("UnaryExpression",{operator:e,right:t})})),(0,o.default)(this,"parseUpdateExpression",(function(e){if(e){if("Identifier"!==e.type&&"MemberExpression"!==e.type)throw new Error("Parser Error: The left-hand side of a postfix operator must be an identifier.");return r.createNode("UpdateExpression",{operator:r.currentToken.value,argument:e,prefix:!1})}var t=r.currentToken.value;if(r.advance(),"IDENTIFIER"!==r.currentToken.type)throw new Error("Parser Error: The right-hand side of a prefix operator must be an identifier.");var i=r.parseIdentifier();return r.createNode("UpdateExpression",{operator:t,argument:i,prefix:!0})})),(0,o.default)(this,"parseInfixExpression",(function(e){var t=r.currentToken.value,i=r.currentPrecedence();r.advance();var n=r.parseExpression(i);return r.createNode("BinaryExpression",{left:e,operator:t,right:n})})),(0,o.default)(this,"parseLogicalExpression",(function(e){var t=r.currentToken.value,i=r.currentPrecedence();r.advance();var n=r.parseExpression(i);return r.createNode("LogicalExpression",{left:e,operator:t,right:n})})),(0,o.default)(this,"parseGroupedOrTupleExpression",(function(){if(r.advance(),"RPAREN"===r.peekToken.type)throw new Error("Parser Error: Empty parentheses is not allowed.");var e=r.parseExpression(n.LOWEST);if("COMMA"===r.peekToken.type){r.advance();for(var t=[e];"RPAREN"!==r.currentToken.type;)"COMMA"===r.peekToken.type&&r.advance(),t.push(r.parseExpression(n.LOWEST));return r.expectPeek("RPAREN"),r.createNode("TupleLiteral",{elements:t})}return r.expectPeek("RPAREN"),e})),(0,o.default)(this,"parseCallExpression",(function(e){var t=r.parseExpressionList("RPAREN");return r.createNode("CallExpression",{callee:e,arguments:t})})),(0,o.default)(this,"parseMemberExpression",(function(e){var t,i="LBRACKET"===r.currentToken.type;if(r.advance(),i)t=r.parseExpression(n.LOWEST),r.expectPeek("RBRACKET");else{if("IDENTIFIER"!==r.currentToken.type)throw new Error("Parser Error: Expected identifier after '.'.");t=r.parseIdentifier()}return r.createNode("MemberExpression",{object:e,property:t})})),(0,o.default)(this,"parseArrayLiteral",(function(){var e=r.parseExpressionList("RBRACKET");return r.createNode("ArrayLiteral",{elements:e})})),(0,o.default)(this,"parseObjectLiteral",(function(){var e=[];if("RBRACE"===r.peekToken.type)return r.advance(),r.createNode("ObjectLiteral",{properties:e});r.advance();do{if("RBRACE"===r.currentToken.type)break;if("COMMA"===r.currentToken.type&&r.advance(),"IDENTIFIER"!==r.currentToken.type&&"STRING"!==r.currentToken.type)throw new Error("Parser Error: Invalid key in object literal. Must be an identifier or a string.");var t="IDENTIFIER"===r.currentToken.type?r.parseIdentifier():r.parseStringLiteral();r.expectPeek("COLON"),r.advance();var i=r.parseExpression(n.LOWEST);e.push({key:t,value:i})}while("COMMA"===r.peekToken.type);return r.expectPeek("RBRACE"),r.createNode("ObjectLiteral",{properties:e})})),(0,o.default)(this,"parseBlockStatement",(function(){var e=[];for(r.advance();"RBRACE"!==r.currentToken.type&&"EOF"!==r.currentToken.type;){var t=r.parseStatement();t&&e.push(t),r.advance()}return r.createNode("BlockStatement",{body:e})})),(0,o.default)(this,"parseCondition",(function(){r.expectPeek("LPAREN"),r.advance();var e=r.parseExpression(n.LOWEST);return r.expectPeek("RPAREN"),e})),(0,o.default)(this,"parseVariableDeclaration",(function(){var e=r.currentToken.value;r.expectPeek("IDENTIFIER");var t,i,s=r.createNode("Identifier",{name:r.currentToken.value});return"COLON"===r.peekToken.type&&(r.advance(),r.advance(),t=r.parseIdentifier()),"EQUALS"===r.peekToken.type&&(r.advance(),r.advance(),i=r.parseExpression(n.LOWEST)),r.createNode("VariableDeclaration",{kind:e,identifier:s,typeAnnotation:t,init:i})})),(0,o.default)(this,"parseReturnStatement",(function(){if(r.advance(),"SEMICOLON"===r.currentToken.type||"RBRACE"===r.currentToken.type)return r.createNode("ReturnStatement",{});var e=r.parseExpression(n.LOWEST);return r.createNode("ReturnStatement",{argument:e})})),(0,o.default)(this,"parseBreakStatement",(function(){return r.createNode("BreakStatement",{})})),(0,o.default)(this,"parseIfStatement",(function(){var e,t,i=r.parseCondition();if("LBRACE"===r.peekToken.type?(r.expectPeek("LBRACE"),e=r.parseBlockStatement()):(r.advance(),e=r.parseStatement()),null===e)throw new Error("Parser Error: Consequence of 'if' statement is empty.");var n=r.peekToken,s=n.type,a=n.value;return"KEYWORD"===s&&"else"===a&&(r.advance(),"KEYWORD"===r.peekToken.type&&"if"===r.peekToken.value?(r.advance(),t=r.parseIfStatement()):"LBRACE"===r.peekToken.type?(r.expectPeek("LBRACE"),t=r.parseBlockStatement()):(r.advance(),t=r.parseStatement()||void 0)),r.createNode("IfStatement",{test:i,consequence:e,alternate:t})})),(0,o.default)(this,"parseForStatement",(function(){var e,t,i,s;if(r.expectPeek("LPAREN"),r.advance(),"SEMICOLON"!==r.currentToken.type&&(e="KEYWORD"!==r.currentToken.type||"let"!==r.currentToken.value&&"const"!==r.currentToken.value?r.parseExpression(n.LOWEST):r.parseVariableDeclaration()),r.expectPeek("SEMICOLON"),r.advance(),"SEMICOLON"!==r.currentToken.type&&(t=r.parseExpression(n.LOWEST)),r.expectPeek("SEMICOLON"),r.advance(),"RPAREN"!==r.currentToken.type&&(i=r.parseExpression(n.LOWEST)),r.expectPeek("RPAREN"),"LBRACE"===r.peekToken.type?(r.expectPeek("LBRACE"),s=r.parseBlockStatement()):(r.advance(),s=r.parseStatement()),null===s)throw new Error("Parser Error: Body of 'for' statement is empty.");return r.createNode("ForStatement",{init:e,test:t,update:i,body:s})})),(0,o.default)(this,"parseWhileStatement",(function(){var e,t=r.parseCondition();if("LBRACE"===r.peekToken.type?(r.expectPeek("LBRACE"),e=r.parseBlockStatement()):(r.advance(),e=r.parseStatement()),null===e)throw new Error("Parser Error: Body of 'while' statement is empty.");return r.createNode("WhileStatement",{test:t,body:e})})),(0,o.default)(this,"parseSwitchStatement",(function(){var e=r.parseCondition();r.expectPeek("LBRACE"),r.advance();for(var t=[];"RBRACE"!==r.currentToken.type&&"EOF"!==r.currentToken.type;){var i=null;if("KEYWORD"===r.currentToken.type&&"case"===r.currentToken.value)r.advance(),i=r.parseExpression(n.LOWEST);else if("KEYWORD"!==r.currentToken.type||"default"!==r.currentToken.value){if("RBRACE"===r.currentToken.type)break;throw new Error("Parser Error: Expected 'case', 'default' or '}', got ".concat(r.currentToken.type," instead."))}r.expectPeek("COLON"),r.advance();for(var s=[];"RBRACE"!==r.currentToken.type&&("KEYWORD"!==r.currentToken.type||"case"!==r.currentToken.value&&"default"!==r.currentToken.value);){var a=r.parseStatement();a&&"EmptyStatement"!==a.type&&s.push(a),"RBRACE"!==r.currentToken.type&&r.advance()}t.push(r.createNode("SwitchCase",{test:i,consequent:s}))}return r.createNode("SwitchStatement",{discriminant:e,cases:t})})),(0,o.default)(this,"parseFunctionDeclaration",(function(){r.advance();var e=r.parseIdentifier();r.expectPeek("LPAREN");var t,i=[];if("RPAREN"!==r.peekToken.type){r.advance();var n,s=r.parseIdentifier();for("COLON"===r.peekToken.type&&(r.advance(),r.advance(),n=r.parseIdentifier()),i.push({name:s,typeAnnotation:n});"COMMA"===r.peekToken.type;)r.advance(),r.advance(),s=r.parseIdentifier(),n=void 0,"COLON"===r.peekToken.type&&(r.advance(),r.advance(),n=r.parseIdentifier()),i.push({name:s,typeAnnotation:n})}r.expectPeek("RPAREN"),"COLON"===r.peekToken.type&&(r.advance(),r.advance(),t=r.parseIdentifier()),r.expectPeek("LBRACE");var a=r.parseBlockStatement();return r.createNode("FunctionDeclaration",{name:e,params:i,body:a,returnType:t})})),(0,o.default)(this,"parseTryStatement",(function(){r.expectPeek("LBRACE");var e=r.parseBlockStatement(),t=null;if("KEYWORD"===r.peekToken.type&&"catch"===r.peekToken.value){r.advance(),r.expectPeek("LPAREN"),r.advance();var i=r.parseIdentifier();r.expectPeek("RPAREN"),r.expectPeek("LBRACE"),t={param:i,body:r.parseBlockStatement()}}var n=null;if("KEYWORD"===r.peekToken.type&&"finally"===r.peekToken.value&&(r.advance(),r.expectPeek("LBRACE"),n=r.parseBlockStatement()),!t&&!n)throw new Error("Parser Error: 'try' must have at least a 'catch' or 'finally' block.");return r.createNode("TryStatement",{tryBlock:e,catchClause:t,finallyBlock:n})})),(0,o.default)(this,"parseExpressionStatement",(function(){var e=r.parseExpression(n.LOWEST);return r.createNode("ExpressionStatement",{expression:e})})),this.tokens=t,this.currentToken=this.tokens[0],this.peekToken=this.tokens[1],this.prefixParseFns=new Map,this.registerPrefix("IDENTIFIER",this.parseIdentifier),this.registerPrefix("NUMBER",this.parseNumericLiteral),this.registerPrefix("STRING",this.parseStringLiteral),this.registerPrefix("TRUE",this.parseBooleanLiteral),this.registerPrefix("FALSE",this.parseBooleanLiteral),this.registerPrefix("BANG",this.parsePrefixExpression),this.registerPrefix("MINUS",this.parsePrefixExpression),this.registerPrefix("PLUS_PLUS",this.parseUpdateExpression),this.registerPrefix("MINUS_MINUS",this.parseUpdateExpression),this.registerPrefix("LPAREN",this.parseGroupedOrTupleExpression),this.registerPrefix("LBRACKET",this.parseArrayLiteral),this.registerPrefix("LBRACE",this.parseObjectLiteral),this.infixParseFns=new Map,this.registerInfix("EQUALS",this.parseAssignmentExpression),this.registerInfix("PLUS",this.parseInfixExpression),this.registerInfix("MINUS",this.parseInfixExpression),this.registerInfix("STAR",this.parseInfixExpression),this.registerInfix("SLASH",this.parseInfixExpression),this.registerInfix("PERCENT",this.parseInfixExpression),this.registerInfix("EQUAL_EQUAL",this.parseInfixExpression),this.registerInfix("BANG_EQUAL",this.parseInfixExpression),this.registerInfix("GREATER",this.parseInfixExpression),this.registerInfix("GREATER_EQUAL",this.parseInfixExpression),this.registerInfix("LESS",this.parseInfixExpression),this.registerInfix("LESS_EQUAL",this.parseInfixExpression),this.registerInfix("AMPERSAND",this.parseInfixExpression),this.registerInfix("PIPE",this.parseInfixExpression),this.registerInfix("AND",this.parseLogicalExpression),this.registerInfix("OR",this.parseLogicalExpression),this.registerInfix("PLUS_PLUS",this.parseUpdateExpression),this.registerInfix("MINUS_MINUS",this.parseUpdateExpression),this.registerInfix("LPAREN",this.parseCallExpression),this.registerInfix("LBRACKET",this.parseMemberExpression),this.registerInfix("DOT",this.parseMemberExpression)}),[{key:"createNode",value:function(e,t){return u(u({type:e},t),{},{line:this.currentToken.line,column:this.currentToken.column})}},{key:"advance",value:function(){this.pos++,this.currentToken=this.peekToken,this.pos+1<this.tokens.length?this.peekToken=this.tokens[this.pos+1]:this.peekToken={type:"EOF",value:"",line:this.currentToken.line,column:this.currentToken.column+1}}},{key:"registerPrefix",value:function(e,t){this.prefixParseFns.set(e,t.bind(this))}},{key:"registerInfix",value:function(e,t){this.infixParseFns.set(e,t.bind(this))}},{key:"expectPeek",value:function(e){if(this.peekToken.type!==e)throw new Error("Parser Error: Expected next token to be ".concat(e,", got ").concat(this.peekToken.type," instead."));this.advance()}},{key:"peekPrecedence",value:function(){return l[this.peekToken.type]||n.LOWEST}},{key:"currentPrecedence",value:function(){return l[this.currentToken.type]||n.LOWEST}},{key:"parseExpression",value:function(e){var t=this.prefixParseFns.get(this.currentToken.type);if(!t)throw new Error("Parser Error: No prefix parse function for ".concat(this.currentToken.type," found."));for(var r=t();"SEMICOLON"!==this.peekToken.type&&e<this.peekPrecedence();){var i=this.infixParseFns.get(this.peekToken.type);if(!i)return r;this.advance(),r=i(r)}return r}},{key:"parseExpressionList",value:function(e){var t=[];if(this.peekToken.type===e)return this.advance(),t;for(this.advance(),t.push(this.parseExpression(n.LOWEST));"COMMA"===this.peekToken.type;)this.advance(),this.advance(),t.push(this.parseExpression(n.LOWEST));return this.expectPeek(e),t}},{key:"parseStatement",value:function(){if("SEMICOLON"===this.currentToken.type)return this.createNode("EmptyStatement",{});if("KEYWORD"===this.currentToken.type)switch(this.currentToken.value){case"let":case"const":return this.parseVariableDeclaration();case"return":return this.parseReturnStatement();case"if":return this.parseIfStatement();case"for":return this.parseForStatement();case"while":return this.parseWhileStatement();case"switch":return this.parseSwitchStatement();case"break":return this.parseBreakStatement();case"function":return this.parseFunctionDeclaration();case"try":return this.parseTryStatement()}return this.parseExpressionStatement()}},{key:"parse",value:function(){var e=this.createNode("Program",{body:[]});for(console.log(this.tokens);"EOF"!==this.currentToken.type;)if("SEMICOLON"!==this.currentToken.type){var t=this.parseStatement();t&&e.body.push(t),"RBRACE"!==this.currentToken.type&&"SEMICOLON"===this.peekToken.type&&this.advance(),this.advance()}else this.advance();return e}}])},{"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/defineProperty":5,"@babel/runtime/helpers/interopRequireDefault":6}],17:[function(e,t,r){"use strict";var i;Object.defineProperty(r,"__esModule",{value:!0}),r.OpCode=void 0,function(e){e[e.PUSH_CONST=0]="PUSH_CONST",e[e.PUSH_NULL=1]="PUSH_NULL",e[e.PUSH_TRUE=2]="PUSH_TRUE",e[e.PUSH_FALSE=3]="PUSH_FALSE",e[e.DUP=4]="DUP",e[e.ADD=5]="ADD",e[e.SUBTRACT=6]="SUBTRACT",e[e.MULTIPLY=7]="MULTIPLY",e[e.DIVIDE=8]="DIVIDE",e[e.MODULO=9]="MODULO",e[e.EQUAL=10]="EQUAL",e[e.NOT_EQUAL=11]="NOT_EQUAL",e[e.GREATER_THAN=12]="GREATER_THAN",e[e.GREATER_EQUAL=13]="GREATER_EQUAL",e[e.LESS_THAN=14]="LESS_THAN",e[e.LESS_EQUAL=15]="LESS_EQUAL",e[e.NEGATE=16]="NEGATE",e[e.BITWISE_AND=17]="BITWISE_AND",e[e.BITWISE_OR=18]="BITWISE_OR",e[e.POP=19]="POP",e[e.DEFINE_GLOBAL=20]="DEFINE_GLOBAL",e[e.GET_GLOBAL=21]="GET_GLOBAL",e[e.SET_GLOBAL=22]="SET_GLOBAL",e[e.GET_LOCAL=23]="GET_LOCAL",e[e.SET_LOCAL=24]="SET_LOCAL",e[e.BUILD_ARRAY=25]="BUILD_ARRAY",e[e.BUILD_OBJECT=26]="BUILD_OBJECT",e[e.GET_PROPERTY=27]="GET_PROPERTY",e[e.SET_PROPERTY=28]="SET_PROPERTY",e[e.JUMP=29]="JUMP",e[e.JUMP_IF_FALSE=30]="JUMP_IF_FALSE",e[e.LOOP=31]="LOOP",e[e.CALL=32]="CALL",e[e.RETURN=33]="RETURN",e[e.CALL_BUILTIN=34]="CALL_BUILTIN",e[e.CHECK_TYPE=35]="CHECK_TYPE",e[e.SETUP_EXCEPTION=36]="SETUP_EXCEPTION",e[e.TEARDOWN_EXCEPTION=37]="TEARDOWN_EXCEPTION",e[e.THROW=38]="THROW"}(i||(r.OpCode=i={}))},{}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("./main");"undefined"!=typeof window&&(window.SnowFall=i.SnowFall);r.default=i.SnowFall},{"./main":24}],19:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),n=e("@babel/runtime/helpers/typeof");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass")),o=i(e("@babel/runtime/helpers/defineProperty")),c=l(e("./config")),u=l(e("./util"));function l(e,t){if("function"==typeof WeakMap)var r=new WeakMap,i=new WeakMap;return(l=function(e,t){if(!t&&e&&e.__esModule)return e;var s,a,o={__proto__:null,default:e};if(null===e||"object"!=n(e)&&"function"!=typeof e)return o;if(s=t?i:r){if(s.has(e))return s.get(e);s.set(e,o)}for(var c in e)"default"!==c&&{}.hasOwnProperty.call(e,c)&&((a=(s=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,c))&&(a.get||a.set)?s(o,c,a):o[c]=e[c]);return o})(e,t)}r.default=(0,a.default)((function e(t){(0,s.default)(this,e),(0,o.default)(this,"_data",null),(0,o.default)(this,"_table",null),(0,o.default)(this,"_result",null),(0,o.default)(this,"_offset",0),(0,o.default)(this,"_dataLen",0),(0,o.default)(this,"_index",0),(0,o.default)(this,"_length",0),this._init(t)}),[{key:"_init",value:function(e){e=e||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=e.onData,this._onEndCallback=e.onEnd}},{key:"_createTable",value:function(){for(var e=u.createBuffer(8,c.TABLE_LENGTH),t=0;t<c.TABLE_LENGTH;t++)e[t]=c.BASE62TABLE.charCodeAt(t);return e}},{key:"_onData",value:function(e,t){var r=u.bufferToString_fast(e,t);this._onDataCallback?this._onDataCallback(r):null!==this._result&&(this._result+=r)}},{key:"_onEnd",value:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null}},{key:"_search",value:function(){var e=2,t=this._data,r=this._offset,i=c.BUFFER_MAX;if(this._dataLen-r<i&&(i=this._dataLen-r),e>i)return!1;var n,s,a,o,u,l=r-c.WINDOW_BUFFER_MAX,p=t.substring(l,r+i),h=r+e-3-l;do{if(2===e){if(s=t.charAt(r)+t.charAt(r+1),-1===(a=p.indexOf(s))||a>h)break}else 3===e?s+=t.charAt(r+2):s=t.substr(r,e);if(-1===(o=c.STRING_LASTINDEXOF_BUG?t.substring(l,r+e-1).lastIndexOf(s):p.lastIndexOf(s,h)))break;u=o,n=l+o;do{if(t.charCodeAt(r+e)!==t.charCodeAt(n+e))break}while(++e<i);if(a===o){e++;break}}while(++e<i);return 2!==e&&(this._index=c.WINDOW_BUFFER_MAX-u,this._length=e-1,!0)}},{key:"compress",value:function(e){if(null==e||0===e.length)return"";var t,r=this._createTable(),i=u.createWindow(),n=u.createBuffer(8,c.COMPRESS_CHUNK_SIZE),s=0;this._result="",this._offset=i.length,this._data=i+e,this._dataLen=this._data.length;for(var a,o,l,p,h,f=-1,d=-1;this._offset<this._dataLen;)this._search()?(this._index<c.BUFFER_MAX?(o=this._index,l=0):(o=this._index%c.BUFFER_MAX,l=(this._index-o)/c.BUFFER_MAX),2===this._length?(n[s++]=r[l+c.COMPRESS_FIXED_START],n[s++]=r[o]):(n[s++]=r[l+c.COMPRESS_START],n[s++]=r[o],n[s++]=r[this._length]),this._offset+=this._length,~d&&(d=-1)):(a=this._data.charCodeAt(this._offset++))<c.LATIN_BUFFER_MAX?(a<c.UNICODE_CHAR_MAX?(o=a,f=c.LATIN_INDEX):f=(l=(a-(o=a%c.UNICODE_CHAR_MAX))/c.UNICODE_CHAR_MAX)+c.LATIN_INDEX,d===f?n[s++]=r[o]:(n[s++]=r[f-c.LATIN_INDEX_START],n[s++]=r[o],d=f)):(a<c.UNICODE_BUFFER_MAX?(f=c.UNICODE_INDEX,o=a):f=(l=(a-(o=a%c.UNICODE_BUFFER_MAX))/c.UNICODE_BUFFER_MAX)+c.UNICODE_INDEX,o<c.UNICODE_CHAR_MAX?(p=o,h=0):h=(o-(p=o%c.UNICODE_CHAR_MAX))/c.UNICODE_CHAR_MAX,d===f?(n[s++]=r[p],n[s++]=r[h]):(n[s++]=r[c.CHAR_START],n[s++]=r[f-c.TABLE_LENGTH],n[s++]=r[p],n[s++]=r[h],d=f)),s>=c.COMPRESS_CHUNK_MAX&&(this._onData(n,s),s=0);return s>0&&this._onData(n,s),this._onEnd(),t=this._result,this._result=null,null===t?"":t}}])},{"./config":20,"./util":23,"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/defineProperty":5,"@babel/runtime/helpers/interopRequireDefault":6,"@babel/runtime/helpers/typeof":12}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.WINDOW_MAX=r.WINDOW_BUFFER_MAX=r.UNICODE_INDEX=r.UNICODE_CHAR_MAX=r.UNICODE_BUFFER_MAX=r.TABLE_LENGTH=r.TABLE_DIFF=r.STRING_LASTINDEXOF_BUG=r.LATIN_INDEX_START=r.LATIN_INDEX=r.LATIN_DECODE_MAX=r.LATIN_BUFFER_MAX=r.HAS_TYPED=r.DECOMPRESS_CHUNK_SIZE=r.DECOMPRESS_CHUNK_MAX=r.DECODE_MAX=r.COMPRESS_START=r.COMPRESS_INDEX=r.COMPRESS_FIXED_START=r.COMPRESS_CHUNK_SIZE=r.COMPRESS_CHUNK_MAX=r.CHAR_START=r.CAN_CHARCODE_APPLY_TYPED=r.CAN_CHARCODE_APPLY=r.BUFFER_MAX=r.BASE62TABLE=r.APPLY_BUFFER_SIZE_OK=r.APPLY_BUFFER_SIZE=void 0,r.setApplyBufferSizeOk=function(e){r.APPLY_BUFFER_SIZE_OK=e};var i=r.HAS_TYPED="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array,n=!1;try{"a"===String.fromCharCode.apply(null,[97])&&(n=!0)}catch(e){}r.CAN_CHARCODE_APPLY=n;var s=!1;if(i)try{"a"===String.fromCharCode.apply(null,new Uint8Array([97]))&&(s=!0)}catch(e){}r.CAN_CHARCODE_APPLY_TYPED=s;var a=r.APPLY_BUFFER_SIZE=65533;r.APPLY_BUFFER_SIZE_OK=null;var o=!1;-1!=="abcほげ".lastIndexOf("ほげ",1)&&(o=!0);r.STRING_LASTINDEXOF_BUG=o;var c=r.BASE62TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",u=r.TABLE_LENGTH=c.length,l=r.TABLE_DIFF=Math.max(u,62)-Math.min(u,62),p=(r.BUFFER_MAX=u-1,r.WINDOW_MAX=1024),h=(r.WINDOW_BUFFER_MAX=304,r.COMPRESS_CHUNK_SIZE=a),f=(r.COMPRESS_CHUNK_MAX=h-u,r.DECOMPRESS_CHUNK_SIZE=a),d=(r.DECOMPRESS_CHUNK_MAX=f+2*p,r.LATIN_BUFFER_MAX=132,r.UNICODE_CHAR_MAX=40),E=(r.UNICODE_BUFFER_MAX=d*(d+1),r.LATIN_INDEX=u+1,r.LATIN_INDEX_START=l+20,r.UNICODE_INDEX=u+5,r.DECODE_MAX=u-l-19,r.LATIN_DECODE_MAX=d+7),m=r.CHAR_START=E+1,k=r.COMPRESS_START=m+1,b=r.COMPRESS_FIXED_START=k+5;r.COMPRESS_INDEX=b+5},{}],21:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),n=e("@babel/runtime/helpers/typeof");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass")),o=i(e("@babel/runtime/helpers/defineProperty")),c=l(e("./config")),u=l(e("./util"));function l(e,t){if("function"==typeof WeakMap)var r=new WeakMap,i=new WeakMap;return(l=function(e,t){if(!t&&e&&e.__esModule)return e;var s,a,o={__proto__:null,default:e};if(null===e||"object"!=n(e)&&"function"!=typeof e)return o;if(s=t?i:r){if(s.has(e))return s.get(e);s.set(e,o)}for(var c in e)"default"!==c&&{}.hasOwnProperty.call(e,c)&&((a=(s=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,c))&&(a.get||a.set)?s(o,c,a):o[c]=e[c]);return o})(e,t)}r.default=(0,a.default)((function e(t){(0,s.default)(this,e),(0,o.default)(this,"_result",null),this._init(t)}),[{key:"_init",value:function(e){e=e||{},this._result=null,this._onDataCallback=e.onData,this._onEndCallback=e.onEnd}},{key:"_createTable",value:function(){for(var e={},t=0;t<c.TABLE_LENGTH;t++)e[c.BASE62TABLE.charAt(t)]=t;return e}},{key:"_onData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._onDataCallback&&this._result){var t;if(e)t=this._result,this._result=[];else{var r=c.DECOMPRESS_CHUNK_SIZE-c.WINDOW_MAX;t=this._result.slice(c.WINDOW_MAX,c.WINDOW_MAX+r),this._result=this._result.slice(0,c.WINDOW_MAX).concat(this._result.slice(c.WINDOW_MAX+r))}t.length>0&&this._onDataCallback(u.bufferToString_fast(t))}}},{key:"_onEnd",value:function(){this._onEndCallback&&this._onEndCallback()}},{key:"decompress",value:function(e){if(null==e||0===e.length)return"";this._result=u.stringToArray(u.createWindow());for(var t,r,i,n,s,a,o,l,p,h,f=this._createTable(),d=!1,E=null,m=e.length,k=0;k<m;k++)if(void 0!==(i=f[e.charAt(k)])){if(i<c.DECODE_MAX)s=d?f[e.charAt(++k)]*c.UNICODE_CHAR_MAX+i+c.UNICODE_BUFFER_MAX*E:E*c.UNICODE_CHAR_MAX+i,this._result[this._result.length]=s;else if(i<c.LATIN_DECODE_MAX)E=i-c.DECODE_MAX,d=!1;else if(i===c.CHAR_START)E=(n=f[e.charAt(++k)])-5,d=!0;else if(i<c.COMPRESS_INDEX){if(n=f[e.charAt(++k)],i<c.COMPRESS_FIXED_START?(a=(i-c.COMPRESS_START)*c.BUFFER_MAX+n,o=f[e.charAt(++k)]):(a=(i-c.COMPRESS_FIXED_START)*c.BUFFER_MAX+n,o=2),(l=this._result.slice(-a)).length>o&&(l.length=o),p=l.length,l.length>0)for(h=0;h<o;)for(r=0;r<p&&(this._result[this._result.length]=l[r],!(++h>=o));r++);E=null}this._result.length>=c.DECOMPRESS_CHUNK_MAX&&this._onData()}return this._result=this._result.slice(c.WINDOW_MAX),this._onData(!0),this._onEnd(),t=u.bufferToString_fast(this._result),this._result=null,t}}])},{"./config":20,"./util":23,"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/defineProperty":5,"@babel/runtime/helpers/interopRequireDefault":6,"@babel/runtime/helpers/typeof":12}],22:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.compress=a,r.decompress=o,r.version=r.default=void 0;var n=i(e("./compressor")),s=i(e("./decompressor"));r.version="2.0.0-ts";function a(e,t){return new n.default(t).compress(e)}function o(e,t){return new s.default(t).decompress(e)}
/**
 * forked from lzbase62
 * @module lzbase62
 * @see https://github.com/polygonplanet/lzbase62
 * @license MIT
 * @version 2.0.0
 */r.default={compress:a,decompress:o}},{"./compressor":19,"./decompressor":21,"@babel/runtime/helpers/interopRequireDefault":6}],23:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/typeof");Object.defineProperty(r,"__esModule",{value:!0}),r.bufferToString_chunked=o,r.bufferToString_fast=function(e,t){null==t?t=e.length:e=a(e,t);if(n.CAN_CHARCODE_APPLY&&n.CAN_CHARCODE_APPLY_TYPED){var r=e.length;if(r<n.APPLY_BUFFER_SIZE&&n.APPLY_BUFFER_SIZE_OK)return s.apply(null,e);if(null===n.APPLY_BUFFER_SIZE_OK)try{var i=s.apply(null,e);return r>n.APPLY_BUFFER_SIZE&&n.setApplyBufferSizeOk(!0),i}catch(e){n.setApplyBufferSizeOk(!1)}}return o(e)},r.bufferToString_slow=c,r.createBuffer=function(e,t){if(n.HAS_TYPED)switch(e){case 8:return new Uint8Array(t);case 16:return new Uint16Array(t)}return new Array(t)},r.createWindow=function(){var e=n.WINDOW_MAX>>7,t="        ";for(;!(e&n.WINDOW_MAX);)t+=t,e<<=1;return t},r.stringToArray=function(e){if(!e)return[];for(var t=[],r=e?e.length:0,i=0;i<r;i++)t[i]=e.charCodeAt(i);return t},r.truncateBuffer=a;var n=function(e,t){if("function"==typeof WeakMap)var r=new WeakMap,n=new WeakMap;return function(e,t){if(!t&&e&&e.__esModule)return e;var s,a,o={__proto__:null,default:e};if(null===e||"object"!=i(e)&&"function"!=typeof e)return o;if(s=t?n:r){if(s.has(e))return s.get(e);s.set(e,o)}for(var c in e)"default"!==c&&{}.hasOwnProperty.call(e,c)&&((a=(s=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,c))&&(a.get||a.set)?s(o,c,a):o[c]=e[c]);return o}(e,t)}(e("./config"));var s=String.fromCharCode;function a(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)}function o(e){for(var t,r="",i=e.length,a=0;a<i;){if(t=!Array.isArray(e)&&e.subarray?e.subarray(a,a+n.APPLY_BUFFER_SIZE):e.slice(a,a+n.APPLY_BUFFER_SIZE),a+=n.APPLY_BUFFER_SIZE,!n.APPLY_BUFFER_SIZE_OK){if(null===n.APPLY_BUFFER_SIZE_OK)try{r+=s.apply(null,t),t.length>n.APPLY_BUFFER_SIZE&&n.setApplyBufferSizeOk(!0);continue}catch(e){n.setApplyBufferSizeOk(!1)}return c(e)}r+=s.apply(null,t)}return r}function c(e){for(var t="",r=e.length,i=0;i<r;i++)t+=s(e[i]);return t}},{"./config":20,"@babel/runtime/helpers/typeof":12}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SnowFall=void 0;var i=e("./compiler/compiler"),n=e("./compiler/libs/lexer"),s=e("./compiler/libs/parser"),a=e("./vm/vm"),o={builtInFunctions:{}};function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,r=new n.Lexer(e).tokenize(),a=new s.Parser(r).parse();return new i.Compiler(a,t).compile()}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;return new a.SnowFallVM(e,t).run()}r.SnowFall={compile:c,run:u,compileAndRun:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;return u(c(e,t),t)}}},{"./compiler/compiler":14,"./compiler/libs/lexer":15,"./compiler/libs/parser":16,"./vm/vm":28}],25:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.Compressor=void 0;var n=i(e("@babel/runtime/helpers/classCallCheck")),s=i(e("@babel/runtime/helpers/createClass")),a=i(e("@babel/runtime/helpers/defineProperty")),o=i(e("../libs/lzbase62/src/index")),c=i(e("./compressor/smartpack"));function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return l(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){o=!0,s=e},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw s}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var p=r.Compressor=(0,s.default)((function e(){(0,n.default)(this,e)}),null,[{key:"encodeNumbers",value:function(e){var t,r="",i=u(e);try{for(i.s();!(t=i.n()).done;){var n=t.value,s=[];do{var a=n&this.BYTE_MASK;(n>>>=7)>0&&(a|=this.BYTE_MSB),s.push(a)}while(n>0);for(var o=0,c=s;o<c.length;o++){var l=c[o];r+=String.fromCharCode(l)}}}catch(e){i.e(e)}finally{i.f()}return this.encodeString(r)}},{key:"encodeSmartPack",value:function(e){var t,r="",i=u(c.default.encode(e));try{for(i.s();!(t=i.n()).done;){var n=t.value;r+=String.fromCharCode(n)}}catch(e){i.e(e)}finally{i.f()}return this.encodeString(r)}},{key:"encodeJSON",value:function(e){return this.encodeString(JSON.stringify(e))}},{key:"encodeString",value:function(e){return o.default.compress(e)}},{key:"decodeNumbers",value:function(e){if(0===e.length)return[];for(var t=this.decodeString(e),r=[],i=0,n=0,s=0;s<t.length;s++){var a=t.charCodeAt(s);i|=(a&this.BYTE_MASK)<<n,0===(a&this.BYTE_MSB)?(r.push(i),i=0,n=0):n+=7}return r}},{key:"decodeSmartPack",value:function(e){for(var t=this.decodeString(e),r=[],i=0;i<t.length;i++)r.push(t.charCodeAt(i));return c.default.decode(new Uint8Array(r))}},{key:"decodeJSON",value:function(e){return JSON.parse(this.decodeString(e))}},{key:"decodeString",value:function(e){return o.default.decompress(e)}}]);(0,a.default)(p,"BYTE_MASK",127),(0,a.default)(p,"BYTE_MSB",128)},{"../libs/lzbase62/src/index":22,"./compressor/smartpack":27,"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/defineProperty":5,"@babel/runtime/helpers/interopRequireDefault":6}],26:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.BitWriter=r.BitReader=void 0;var n=i(e("@babel/runtime/helpers/classCallCheck")),s=i(e("@babel/runtime/helpers/createClass")),a=i(e("@babel/runtime/helpers/defineProperty"));r.BitWriter=(0,s.default)((function e(){(0,n.default)(this,e),(0,a.default)(this,"buffer",[]),(0,a.default)(this,"currentByte",0),(0,a.default)(this,"bitsFilled",0)}),[{key:"writeBits",value:function(e,t){for(var r=t-1;r>=0;r--){var i=e>>r&1;this.currentByte=this.currentByte<<1|i,this.bitsFilled++,8===this.bitsFilled&&(this.buffer.push(this.currentByte),this.currentByte=0,this.bitsFilled=0)}}},{key:"finish",value:function(){return this.bitsFilled>0&&(this.currentByte<<=8-this.bitsFilled,this.buffer.push(this.currentByte)),Uint8Array.from(this.buffer)}}]),r.BitReader=(0,s.default)((function e(t){(0,n.default)(this,e),(0,a.default)(this,"byteIndex",0),(0,a.default)(this,"bitsLeft",0),(0,a.default)(this,"currentByte",0),this.buffer=t}),[{key:"readBits",value:function(e){for(var t=0;e>0;){if(0===this.bitsLeft){if(this.byteIndex>=this.buffer.length)throw new Error("EOF");this.currentByte=this.buffer[this.byteIndex++],this.bitsLeft=8}var r=Math.min(e,this.bitsLeft),i=this.bitsLeft-r;t=t<<r|this.currentByte>>i&(1<<r)-1,this.bitsLeft-=r,this.currentByte&=(1<<this.bitsLeft)-1,e-=r}return t}}])},{"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/defineProperty":5,"@babel/runtime/helpers/interopRequireDefault":6}],27:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("@babel/runtime/helpers/classCallCheck")),s=i(e("@babel/runtime/helpers/createClass")),a=e("./bitwriter");r.default=(0,s.default)((function e(){(0,n.default)(this,e)}),null,[{key:"_encodeSigned",value:function(e,t){return e+(1<<t-1)}},{key:"_decodeSigned",value:function(e,t){return e-(1<<t-1)}},{key:"encode",value:function(e){if(0===e.length)return new Uint8Array;for(var t=[e[0]],r=1;r<e.length;r++)t.push(e[r]-e[r-1]);for(var i=new a.BitWriter,n=0;n<t.length;){for(var s=1;n+s<t.length&&t[n+s]===t[n];)s++;if(s>=3){var o=t[n],c=Math.ceil(Math.log2(Math.abs(o)+1))+1;i.writeBits(1,1),i.writeBits(c,5),i.writeBits(s,8),i.writeBits(this._encodeSigned(o,c),c),n+=s}else{for(var u=[];n<t.length&&u.length<255&&(n+2>=t.length||t[n]!==t[n+1]||t[n]!==t[n+2]);)u.push(t[n++]);var l=Math.min.apply(Math,u),p=Math.max.apply(Math,u),h=Math.ceil(Math.log2(Math.max(Math.abs(l),Math.abs(p))+1))+1;i.writeBits(0,1),i.writeBits(h,5),i.writeBits(u.length,8);for(var f=0,d=u;f<d.length;f++){var E=d[f];i.writeBits(this._encodeSigned(E,h),h)}}}return i.finish()}},{key:"decode",value:function(e){for(var t=new a.BitReader(e),r=[];;)try{var i=t.readBits(1),n=t.readBits(5),s=t.readBits(8);if(i)for(var o=this._decodeSigned(t.readBits(n),n),c=0;c<s;c++)r.push(o);else for(var u=0;u<s;u++)r.push(this._decodeSigned(t.readBits(n),n))}catch(e){break}for(var l=[],p=0;p<r.length;p++)l[p]=0===p?r[0]:l[p-1]+r[p];return l}}])},{"./bitwriter":26,"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/interopRequireDefault":6}],28:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.SnowFallVM=void 0;var n=i(e("@babel/runtime/helpers/toConsumableArray")),s=i(e("@babel/runtime/helpers/typeof")),a=i(e("@babel/runtime/helpers/classCallCheck")),o=i(e("@babel/runtime/helpers/createClass")),c=i(e("@babel/runtime/helpers/defineProperty")),u=e("../const/opcodes"),l=e("../util/compressor");r.SnowFallVM=(0,o.default)((function e(t,r){(0,a.default)(this,e),(0,c.default)(this,"frames",[]),(0,c.default)(this,"stack",[]),(0,c.default)(this,"globals",new Map),(0,c.default)(this,"handlerStack",[]),this.settings=r,console.log(t);var i=this.decompressData(t);this.stack.push(i);var n={func:i,ip:0,stackStart:0};this.frames.push(n),this.frame=n}),[{key:"readByte",value:function(){return this.frame.func.chunk.code[this.frame.ip++]}},{key:"readShort",value:function(){this.frame.ip+=2;var e=this.frame.func.chunk.code;return e[this.frame.ip-2]<<8|e[this.frame.ip-1]}},{key:"readConstant",value:function(){return this.frame.func.chunk.constants[this.readByte()]}},{key:"runtimeError",value:function(e){for(var t="\n--- Stack Trace ---\n",r=this.frames.length-1;r>=0;r--){var i=this.frames[r],n=i.func.name||"(script)",s=i.func.chunk.lines[i.ip-1]||"unknown";t+="  at ".concat(n," (line ").concat(s,")\n")}return new Error("".concat(e,"\n").concat(t))}},{key:"run",value:function(){try{for(;;){var e=this.readByte();switch(e){case u.OpCode.CHECK_TYPE:var t=this.readConstant().toLowerCase(),r=this.stack[this.stack.length-1],i=void 0;if(t!==(i=null===r?"null":Array.isArray(r)?"array":(0,s.default)(r)))throw this.runtimeError("TypeError: Expected type '".concat(t,"' but got '").concat(i,"'."));break;case u.OpCode.PUSH_TRUE:this.stack.push(!0);break;case u.OpCode.PUSH_FALSE:this.stack.push(!1);break;case u.OpCode.PUSH_CONST:this.stack.push(this.readConstant());break;case u.OpCode.PUSH_NULL:this.stack.push(null);break;case u.OpCode.POP:this.stack.pop();break;case u.OpCode.DUP:this.stack.push(this.stack[this.stack.length-1]);break;case u.OpCode.DEFINE_GLOBAL:var a=this.readConstant();this.globals.set(a,this.stack[this.stack.length-1]),this.stack.pop();break;case u.OpCode.GET_GLOBAL:var o=this.readConstant();if(!this.globals.has(o))throw new Error("VM Error: Undefined global variable '".concat(o,"'."));this.stack.push(this.globals.get(o));break;case u.OpCode.SET_GLOBAL:var c=this.readConstant();if(!this.globals.has(c))throw new Error("VM Error: Undefined global variable '".concat(c,"'."));this.globals.set(c,this.stack[this.stack.length-1]);break;case u.OpCode.GET_LOCAL:var l=this.readByte();this.stack.push(this.stack[this.frame.stackStart+l]);break;case u.OpCode.SET_LOCAL:var p=this.readByte();this.stack[this.frame.stackStart+p]=this.stack[this.stack.length-1];break;case u.OpCode.BUILD_ARRAY:var h=this.readByte(),f=this.stack.splice(this.stack.length-h,h);this.stack.push(f);break;case u.OpCode.BUILD_OBJECT:for(var d=this.readByte(),E={},m=0;m<d;m++){var k=this.stack.pop();E[this.stack.pop()]=k}this.stack.push(E);break;case u.OpCode.GET_PROPERTY:var b=this.stack.pop(),C=this.stack.pop();if(null==C)throw new Error("VM Error: Cannot read property of null or undefined.");this.stack.push(C[b]);break;case u.OpCode.SET_PROPERTY:var y=this.stack.pop(),v=this.stack.pop(),_=this.stack.pop();if(null==_)throw new Error("VM Error: Cannot set property of null or undefined.");_[v]=y,this.stack.push(y);break;case u.OpCode.EQUAL:var O=this.stack.pop(),S=this.stack.pop();this.stack.push(S===O);break;case u.OpCode.NOT_EQUAL:var A=this.stack.pop(),T=this.stack.pop();this.stack.push(T!==A);break;case u.OpCode.GREATER_THAN:var L=this.stack.pop(),P=this.stack.pop();this.stack.push(P>L);break;case u.OpCode.GREATER_EQUAL:var R=this.stack.pop(),N=this.stack.pop();this.stack.push(N>=R);break;case u.OpCode.LESS_THAN:var I=this.stack.pop(),x=this.stack.pop();this.stack.push(x<I);break;case u.OpCode.LESS_EQUAL:var g=this.stack.pop(),D=this.stack.pop();this.stack.push(D<=g);break;case u.OpCode.BITWISE_AND:var U=this.stack.pop(),B=this.stack.pop();if("number"!=typeof B||"number"!=typeof U)throw new Error("VM Error: Operands must be two numbers for bitwise AND.");this.stack.push(B&U);break;case u.OpCode.BITWISE_OR:var M=this.stack.pop(),w=this.stack.pop();if("number"!=typeof w||"number"!=typeof M)throw new Error("VM Error: Operands must be two numbers for bitwise OR.");this.stack.push(w|M);break;case u.OpCode.ADD:var F=this.stack.pop(),W=this.stack.pop();if("number"==typeof W&&"number"==typeof F)this.stack.push(W+F);else{if("string"!=typeof W&&"string"!=typeof F)throw new Error("VM Error: Operands must be two numbers or at least one string.");this.stack.push(String(W)+String(F))}break;case u.OpCode.SUBTRACT:var X=this.stack.pop(),j=this.stack.pop();if("number"!=typeof j||"number"!=typeof X)throw new Error("VM Error: Operands must be two numbers.");this.stack.push(j-X);break;case u.OpCode.MULTIPLY:var G=this.stack.pop(),H=this.stack.pop();if("number"==typeof H&&"number"==typeof G)this.stack.push(H*G);else if("string"==typeof H&&"number"==typeof G)this.stack.push(H.repeat(G));else{if("number"!=typeof H||"string"!=typeof G)throw new Error("VM Error: Operands must be two numbers. Or one string and one number.");this.stack.push(G.repeat(H))}break;case u.OpCode.DIVIDE:var Y=this.stack.pop(),J=this.stack.pop();if("number"!=typeof J||"number"!=typeof Y)throw new Error("VM Error: Operands must be two numbers.");if(0===Y)throw new Error("VM Error: Division by zero.");this.stack.push(J/Y);break;case u.OpCode.MODULO:var K=this.stack.pop(),Q=this.stack.pop();if("number"!=typeof Q||"number"!=typeof K)throw new Error("VM Error: Operands must be two numbers.");if(0===K)throw new Error("VM Error: Division by zero.");this.stack.push(Q%K);break;case u.OpCode.NEGATE:var q=this.stack.pop();this.stack.push(!q);break;case u.OpCode.JUMP:var V,Z=this.readShort();null!==(V=this.settings.hooks)&&void 0!==V&&V.beforeJump&&this.settings.hooks.beforeJump(this,"JUMP"),this.frame.ip+=Z;break;case u.OpCode.JUMP_IF_FALSE:var z,$=this.readShort();null!==(z=this.settings.hooks)&&void 0!==z&&z.beforeJump&&this.settings.hooks.beforeJump(this,"JUMP_IF_FALSE"),this.stack[this.stack.length-1]||(this.frame.ip+=$);break;case u.OpCode.LOOP:var ee=this.readShort();this.frame.ip-=ee;break;case u.OpCode.CALL:var te=this.readByte(),re=this.stack[this.stack.length-1-te];if(!re||"object"!==(0,s.default)(re)||void 0===re.arity)throw new Error("VM Error: Can only call functions.");if(te!==re.arity)throw new Error("VM Error: Expected ".concat(re.arity," arguments but got ").concat(te,"."));var ie={func:this.decompressData(re),ip:0,stackStart:this.stack.length-te};this.frames.push(ie),this.frame=ie;break;case u.OpCode.RETURN:var ne=this.stack.pop(),se=this.frames.pop();if(0===this.frames.length)return ne;this.stack.splice(se.stackStart),this.stack.push(ne),this.frame=this.frames[this.frames.length-1];break;case u.OpCode.CALL_BUILTIN:var ae=this.readConstant(),oe=this.readByte(),ce=this.stack.splice(this.stack.length-oe,oe),ue=this.settings.builtInFunctions[ae];if(!ue)throw new Error("VM Error: Built-in function ".concat(ae," not found."));var le=ue.apply(void 0,(0,n.default)(ce));this.stack.push(void 0===le?null:le);break;case u.OpCode.SETUP_EXCEPTION:var pe=this.readShort();this.handlerStack.push({catchAddress:this.frame.ip+pe,finallyAddress:null,stackDepth:this.stack.length});break;case u.OpCode.TEARDOWN_EXCEPTION:this.handlerStack.pop();break;default:throw new Error("VM Error: Unknown opcode ".concat(e))}}}catch(e){e.message.includes("--- Stack Trace ---")?console.error(e.message):console.error(this.runtimeError(e.message))}}},{key:"decompressData",value:function(e){return void 0!==e.chunk?e:{name:e.name,arity:e.arity,chunk:{code:l.Compressor.decodeNumbers(e.code),constants:l.Compressor.decodeJSON(e.constants),lines:l.Compressor.decodeSmartPack(e.lines)}}}}])},{"../const/opcodes":17,"../util/compressor":25,"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/defineProperty":5,"@babel/runtime/helpers/interopRequireDefault":6,"@babel/runtime/helpers/toConsumableArray":9,"@babel/runtime/helpers/typeof":12}]},{},[18]);
//# sourceMappingURL=SnowFall.min.js.map