!function e(t,r,n){function i(a,o){if(!r[a]){if(!t[a]){var u="function"==typeof require&&require;if(!o&&u)return u(a,!0);if(s)return s(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[a]={exports:{}};t[a][0].call(l.exports,(function(e){return i(t[a][1][e]||e)}),l,l.exports,e,t,r,n)}return r[a].exports}for(var s="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,r){t.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n},t.exports.__esModule=!0,t.exports.default=t.exports},{}],2:[function(e,t,r){var n=e("./arrayLikeToArray.js");t.exports=function(e){if(Array.isArray(e))return n(e)},t.exports.__esModule=!0,t.exports.default=t.exports},{"./arrayLikeToArray.js":1}],3:[function(e,t,r){t.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},t.exports.__esModule=!0,t.exports.default=t.exports},{}],4:[function(e,t,r){t.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},{}],5:[function(e,t,r){var n=e("./isNativeReflectConstruct.js"),i=e("./setPrototypeOf.js");t.exports=function(e,t,r){if(n())return Reflect.construct.apply(null,arguments);var s=[null];s.push.apply(s,t);var a=new(e.bind.apply(e,s));return r&&i(a,r.prototype),a},t.exports.__esModule=!0,t.exports.default=t.exports},{"./isNativeReflectConstruct.js":12,"./setPrototypeOf.js":16}],6:[function(e,t,r){var n=e("./toPropertyKey.js");function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,n(i.key),i)}}t.exports=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},t.exports.__esModule=!0,t.exports.default=t.exports},{"./toPropertyKey.js":19}],7:[function(e,t,r){var n=e("./toPropertyKey.js");t.exports=function(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},t.exports.__esModule=!0,t.exports.default=t.exports},{"./toPropertyKey.js":19}],8:[function(e,t,r){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},t.exports.__esModule=!0,t.exports.default=t.exports,n(e)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},{}],9:[function(e,t,r){var n=e("./setPrototypeOf.js");t.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)},t.exports.__esModule=!0,t.exports.default=t.exports},{"./setPrototypeOf.js":16}],10:[function(e,t,r){t.exports=function(e){return e&&e.__esModule?e:{default:e}},t.exports.__esModule=!0,t.exports.default=t.exports},{}],11:[function(e,t,r){t.exports=function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}},t.exports.__esModule=!0,t.exports.default=t.exports},{}],12:[function(e,t,r){function n(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(t.exports=n=function(){return!!e},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},{}],13:[function(e,t,r){t.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},t.exports.__esModule=!0,t.exports.default=t.exports},{}],14:[function(e,t,r){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},{}],15:[function(e,t,r){var n=e("./typeof.js").default,i=e("./assertThisInitialized.js");t.exports=function(e,t){if(t&&("object"==n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)},t.exports.__esModule=!0,t.exports.default=t.exports},{"./assertThisInitialized.js":3,"./typeof.js":20}],16:[function(e,t,r){function n(e,r){return t.exports=n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},t.exports.__esModule=!0,t.exports.default=t.exports,n(e,r)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},{}],17:[function(e,t,r){var n=e("./arrayWithoutHoles.js"),i=e("./iterableToArray.js"),s=e("./unsupportedIterableToArray.js"),a=e("./nonIterableSpread.js");t.exports=function(e){return n(e)||i(e)||s(e)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},{"./arrayWithoutHoles.js":2,"./iterableToArray.js":13,"./nonIterableSpread.js":14,"./unsupportedIterableToArray.js":21}],18:[function(e,t,r){var n=e("./typeof.js").default;t.exports=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},t.exports.__esModule=!0,t.exports.default=t.exports},{"./typeof.js":20}],19:[function(e,t,r){var n=e("./typeof.js").default,i=e("./toPrimitive.js");t.exports=function(e){var t=i(e,"string");return"symbol"==n(t)?t:t+""},t.exports.__esModule=!0,t.exports.default=t.exports},{"./toPrimitive.js":18,"./typeof.js":20}],20:[function(e,t,r){function n(e){return t.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t.exports.__esModule=!0,t.exports.default=t.exports,n(e)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},{}],21:[function(e,t,r){var n=e("./arrayLikeToArray.js");t.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports},{"./arrayLikeToArray.js":1}],22:[function(e,t,r){var n=e("./getPrototypeOf.js"),i=e("./setPrototypeOf.js"),s=e("./isNativeFunction.js"),a=e("./construct.js");function o(e){var r="function"==typeof Map?new Map:void 0;return t.exports=o=function(e){if(null===e||!s(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return a(e,arguments,n(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports,o(e)}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},{"./construct.js":5,"./getPrototypeOf.js":8,"./isNativeFunction.js":11,"./setPrototypeOf.js":16}],23:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.Compiler=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("@babel/runtime/helpers/createClass")),a=n(e("@babel/runtime/helpers/classCallCheck")),o=e("../const/errors"),u=e("../const/opcodes"),c=e("../util/compressor"),l=n(e("../util/jsonextended"));function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return h(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){o=!0,s=e},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw s}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var f=(0,s.default)((function e(t,r,n,i){(0,a.default)(this,e),this.name=t,this.depth=r,this.index=n,this.isConst=i})),d=(0,s.default)((function e(t){(0,a.default)(this,e),(0,i.default)(this,"store",new Map),(0,i.default)(this,"localCount",0),(0,i.default)(this,"parentLocalCount",0),this.parent=t,t&&(this.parentLocalCount=t.parentLocalCount+t.localCount)}),[{key:"define",value:function(e,t,r){if(this.store.has(e))throw new o.SymbolTableError("Identifier '".concat(e,"' has already been declared in this scope."));var n=this.parentLocalCount+this.localCount,i=new f(e,t,n,r);return this.store.set(e,i),this.localCount++,i}},{key:"has",value:function(e){return this.store.has(e)}},{key:"resolve",value:function(e){var t=this.store.get(e);return t||(this.parent?this.parent.resolve(e):null)}}]),m=r.Compiler=function(){function e(t,r){var n=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,a.default)(this,e),(0,i.default)(this,"scopeDepth",0),(0,i.default)(this,"loopContext",[]),this.ast=t,this.currentNode=t,console.log(t),this.settings=r,this.parentCompiler=s,this.symbolTable=new d(null==s?void 0:s.symbolTable),this.scopeDepth=s?s.scopeDepth+1:0;var o="FunctionDeclaration"===t.type,c=o?t:null,l=o?c.name.name:"main",p=o?c.params.length:0;this.compiledFunction={name:l,arity:p,chunk:{code:[],constants:[],lines:[]}},o&&(this.symbolTable.define(l,this.scopeDepth,!0),c.params.forEach((function(e,t){var r=n.symbolTable.define(e.name.name,n.scopeDepth,!1).index;if(e.defaultValue){n.emitBytes(u.OpCode.GET_LOCAL,r),n.emit(u.OpCode.PUSH_NULL),n.emit(u.OpCode.EQUAL);var i=n.emitJump(u.OpCode.JUMP_IF_FALSE);n.emit(u.OpCode.POP),n.compileNode(e.defaultValue),n.emitBytes(u.OpCode.SET_LOCAL,r),n.emit(u.OpCode.POP);var s=n.emitJump(u.OpCode.JUMP);n.patchJump(i),n.emit(u.OpCode.POP),n.patchJump(s)}if(e.typeAnnotation){var a=e.typeAnnotation.name;"any"!==a.toLowerCase()&&(n.emitBytes(u.OpCode.GET_LOCAL,r),n.emitBytes(u.OpCode.CHECK_TYPE,n.addConstant(a)),n.emit(u.OpCode.POP))}})))}return(0,s.default)(e,[{key:"currentChunk",value:function(){return this.compiledFunction.chunk}},{key:"emit",value:function(e){var t=this.currentChunk();t.code.push(e),t.lines.push(this.currentNode.line)}},{key:"emitBytes",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];r.forEach((function(t){return e.emit(t)}))}},{key:"addConstant",value:function(e){var t=this.currentChunk().constants,r=t.findIndex((function(t){return t===e}));return-1!==r?r:t.push(e)-1}},{key:"emitConstant",value:function(e){this.emitBytes(u.OpCode.PUSH_CONST,this.addConstant(e))}},{key:"emitJump",value:function(e){return this.emit(e),this.emit(255),this.emit(255),this.currentChunk().code.length-2}},{key:"patchJump",value:function(e){var t=this.currentChunk().code.length-e-2;if(t>65535)throw new o.CompilerError("Too much code to jump over.",this.currentNode.line,this.currentNode.column);this.currentChunk().code[e]=t>>8&255,this.currentChunk().code[e+1]=255&t}},{key:"emitLoop",value:function(e){this.emit(u.OpCode.LOOP);var t=this.currentChunk().code.length-e+2;if(t>65535)throw new o.CompilerError("Loop body too large.",this.currentNode.line,this.currentNode.column);this.emit(t>>8&255),this.emit(255&t)}},{key:"beginScope",value:function(){this.scopeDepth++,this.symbolTable=new d(this.symbolTable)}},{key:"endScope",value:function(){var e=this.symbolTable.localCount;if(this.currentChunk().code[this.currentChunk().code.length-1]!==u.OpCode.RETURN)for(var t=0;t<e;t++)this.emit(u.OpCode.POP);this.scopeDepth--,this.symbolTable.parent&&(this.symbolTable=this.symbolTable.parent)}},{key:"compileNode",value:function(e){var t=this.currentNode;switch(this.currentNode=e,e.type){case"Program":this.compileStatements(e.body);break;case"EmptyStatement":break;case"BlockStatement":this.beginScope(),this.compileStatements(e.body),this.endScope();break;case"ExpressionStatement":this.compileNode(e.expression),this.emit(u.OpCode.POP);break;case"VariableDeclaration":this.compileVariableDeclaration(e);break;case"Identifier":this.compileIdentifier(e);break;case"NumericLiteral":case"StringLiteral":this.emitConstant(e.value);break;case"BigIntLiteral":this.emitConstant(BigInt(e.value));break;case"BooleanLiteral":this.emit(e.value?u.OpCode.PUSH_TRUE:u.OpCode.PUSH_FALSE);break;case"NullLiteral":this.emit(u.OpCode.PUSH_NULL);break;case"ArrayLiteral":this.compileArrayLiteral(e);break;case"ObjectLiteral":this.compileObjectLiteral(e);break;case"TupleLiteral":this.compileTupleLiteral(e);break;case"IfStatement":this.compileIfStatement(e);break;case"ForStatement":this.compileForStatement(e);break;case"WhileStatement":this.compileWhileStatement(e);break;case"SwitchStatement":this.compileSwitchStatement(e);break;case"BreakStatement":this.compileBreakStatement(e);break;case"FunctionDeclaration":if("FunctionDeclaration"===this.ast.type&&e===this.ast){this.compileStatements(e.body.body);break}this.compileFunctionDeclaration(e);break;case"ReturnStatement":this.compileReturnStatement(e);break;case"CallExpression":this.compileCallExpression(e);break;case"MemberExpression":this.compileMemberExpression(e);break;case"AssignmentExpression":this.compileAssignmentExpression(e);break;case"UnaryExpression":this.compileUnaryExpression(e);break;case"UpdateExpression":this.compileUpdateExpression(e);break;case"BinaryExpression":this.compileBinaryExpression(e);break;case"LogicalExpression":this.compileLogicalExpression(e);break;case"TryStatement":this.compileTryStatement(e);break;default:throw new o.CompilerError("Unknown AST node type: ".concat(e.type),e.line,e.column)}this.currentNode=t}},{key:"compileStatements",value:function(e){var t=this;e.forEach((function(e){return t.compileNode(e)}))}},{key:"compileVariableDeclaration",value:function(e){if(this.symbolTable.has(e.identifier.name))throw new o.CompilerError("Variable '".concat(e.identifier.name,"' already declared in this scope."),e.identifier.line,e.identifier.column);if(e.init?this.compileNode(e.init):this.emit(u.OpCode.PUSH_NULL),e.typeAnnotation){var t=e.typeAnnotation.name;"any"!==t.toLowerCase()&&(this.emit(u.OpCode.DUP),this.emitBytes(u.OpCode.CHECK_TYPE,this.addConstant(t)),this.emit(u.OpCode.POP))}0===this.scopeDepth?this.emitBytes(u.OpCode.DEFINE_GLOBAL,this.addConstant(e.identifier.name)):this.symbolTable.define(e.identifier.name,this.scopeDepth,"const"===e.kind)}},{key:"compileIdentifier",value:function(e){var t=this.symbolTable.resolve(e.name);t?this.emitBytes(u.OpCode.GET_LOCAL,t.index):this.emitBytes(u.OpCode.GET_GLOBAL,this.addConstant(e.name))}},{key:"compileAssignmentExpression",value:function(e){if(this.compileNode(e.right),"Identifier"===e.left.type){var t=e.left.name,r=this.symbolTable.resolve(t);if(r){if(r.isConst)throw new o.CompilerError("Cannot assign to constant variable '".concat(t,"'."),e.left.line,e.left.column);0===r.depth?this.emitBytes(u.OpCode.SET_GLOBAL,this.addConstant(t)):this.emitBytes(u.OpCode.SET_LOCAL,r.index)}else this.emitBytes(u.OpCode.SET_GLOBAL,this.addConstant(t))}else{if("MemberExpression"!==e.left.type)throw new o.CompilerError("Invalid assignment target.",e.line,e.column);var n=e.left;this.compileNode(n.object),this.compileNode(n.property),this.emit(u.OpCode.SET_PROPERTY)}}},{key:"compileUpdateExpression",value:function(e){var t=e.argument,r=e.operator,n=e.prefix;if("Identifier"!==t.type)throw new o.CompilerError("Update expressions currently only support identifiers.",t.line,t.column);var i,s,a,c,l=this.symbolTable.resolve(t.name);if(l&&l.isConst)throw new o.CompilerError("Cannot assign to constant variable '".concat(t.name,"'."),t.line,t.column);if(!l||0===l.depth){var p=this.addConstant(t.name);i=u.OpCode.GET_GLOBAL,s=p,a=u.OpCode.SET_GLOBAL,c=p}else i=u.OpCode.GET_LOCAL,s=l.index,a=u.OpCode.SET_LOCAL,c=l.index;this.emitBytes(i,s),n||this.emit(u.OpCode.DUP),this.emitConstant(1),this.emit("++"===r?u.OpCode.ADD:u.OpCode.SUBTRACT),this.emitBytes(a,c),n||this.emit(u.OpCode.POP)}},{key:"compileArrayLiteral",value:function(e){var t=this;e.elements.forEach((function(e){return t.compileNode(e)})),this.emitBytes(u.OpCode.BUILD_ARRAY,e.elements.length)}},{key:"compileObjectLiteral",value:function(e){var t=this;e.properties.forEach((function(e){t.emitConstant("Identifier"===e.key.type?e.key.name:e.key.value),t.compileNode(e.value)})),this.emitBytes(u.OpCode.BUILD_OBJECT,e.properties.length)}},{key:"compileTupleLiteral",value:function(e){var t=this;e.elements.forEach((function(e){return t.compileNode(e)})),this.emitBytes(u.OpCode.BUILD_TUPLE,e.elements.length)}},{key:"compileMemberExpression",value:function(e){this.compileNode(e.object),"Identifier"===e.property.type?this.emitConstant(e.property.name):this.compileNode(e.property),this.emit(u.OpCode.GET_PROPERTY)}},{key:"compileIfStatement",value:function(e){this.compileNode(e.test);var t=this.emitJump(u.OpCode.JUMP_IF_FALSE);if(this.emit(u.OpCode.POP),this.compileNode(e.consequence),e.alternate){var r=this.emitJump(u.OpCode.JUMP);this.patchJump(t),this.emit(u.OpCode.POP),this.compileNode(e.alternate),this.patchJump(r)}else this.patchJump(t),this.emit(u.OpCode.POP)}},{key:"compileForStatement",value:function(e){var t=this;this.beginScope(),e.init&&(this.compileNode(e.init),"VariableDeclaration"!==e.init.type&&this.emit(u.OpCode.POP));var r=this.currentChunk().code.length;this.loopContext.push({loopStart:r,exitJumps:[]});var n=-1;e.test&&(this.compileNode(e.test),n=this.emitJump(u.OpCode.JUMP_IF_FALSE),this.emit(u.OpCode.POP)),this.compileNode(e.body),e.update&&(this.compileNode(e.update),this.emit(u.OpCode.POP)),this.emitLoop(r),-1!==n&&(this.patchJump(n),this.emit(u.OpCode.POP)),this.loopContext.pop().exitJumps.forEach((function(e){return t.patchJump(e)})),this.endScope()}},{key:"compileWhileStatement",value:function(e){var t=this,r=this.currentChunk().code.length;this.loopContext.push({loopStart:r,exitJumps:[]}),this.compileNode(e.test);var n=this.emitJump(u.OpCode.JUMP_IF_FALSE);this.emit(u.OpCode.POP),this.compileNode(e.body),this.emitLoop(r),this.patchJump(n),this.emit(u.OpCode.POP),this.loopContext.pop().exitJumps.forEach((function(e){return t.patchJump(e)}))}},{key:"compileSwitchStatement",value:function(e){var t=this;this.compileNode(e.discriminant),this.loopContext.push({loopStart:-1,exitJumps:[]});var r,n=e.cases.find((function(e){return null===e.test})),i=[],s=!1,a=p(e.cases);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(null!==o.test){i.length>0&&(this.patchJump(i.pop()),this.emit(u.OpCode.POP)),s||(this.emit(u.OpCode.DUP),this.compileNode(o.test),this.emit(u.OpCode.EQUAL));var c=this.emitJump(u.OpCode.JUMP_IF_FALSE);i.push(c),this.emit(u.OpCode.POP),this.compileStatements(o.consequent),s=!1;var l=o.consequent[o.consequent.length-1].type;"BreakStatement"!==l&&"ReturnStatement"!==l&&(s=!0)}}}catch(e){a.e(e)}finally{a.f()}var h=this.emitJump(u.OpCode.JUMP);i.length>0&&(this.patchJump(i.pop()),this.emit(u.OpCode.POP)),n&&this.compileStatements(n.consequent),this.patchJump(h),this.loopContext.pop().exitJumps.forEach((function(e){return t.patchJump(e)})),this.emit(u.OpCode.POP)}},{key:"compileBreakStatement",value:function(e){if(0===this.loopContext.length)throw new o.CompilerError("'break' statement outside of a loop or switch.",e.line,e.column);var t=this.emitJump(u.OpCode.JUMP);this.loopContext[this.loopContext.length-1].exitJumps.push(t)}},{key:"compileFunctionDeclaration",value:function(t){var r,n=new e(t,this.settings,this),i=n.compile();r=l.default.stringify(i).length*e.FUNCTION_COMPRESS_MAGNIFICATION<l.default.stringify(n.compiledFunction).length?i:n.compiledFunction;var s=this.addConstant(r);this.emitBytes(u.OpCode.PUSH_CONST,s),0===this.scopeDepth?this.emitBytes(u.OpCode.DEFINE_GLOBAL,this.addConstant(t.name.name)):this.symbolTable.define(t.name.name,this.scopeDepth,!1)}},{key:"compileReturnStatement",value:function(e){if(e.argument?this.compileNode(e.argument):this.emit(u.OpCode.PUSH_NULL),"FunctionDeclaration"===this.ast.type){var t=this.ast;if(t.returnType){var r=t.returnType.name;"any"!==r.toLowerCase()&&(this.emit(u.OpCode.DUP),this.emitBytes(u.OpCode.CHECK_TYPE,this.addConstant(r)),this.emit(u.OpCode.POP))}}this.emit(u.OpCode.RETURN)}},{key:"compileCallExpression",value:function(e){this.compileNode(e.callee);var t,r=p(e.arguments);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.compileNode(n)}}catch(e){r.e(e)}finally{r.f()}this.emitBytes(u.OpCode.CALL,e.arguments.length)}},{key:"compileUnaryExpression",value:function(e){switch(e.operator){case"!":this.compileNode(e.right),this.emit(u.OpCode.NEGATE);break;case"-":this.emitConstant(0),this.compileNode(e.right),this.emit(u.OpCode.SUBTRACT);break;default:throw new o.CompilerError("Unknown unary operator ".concat(e.operator),e.line,e.column)}}},{key:"compileBinaryExpression",value:function(e){if("NumericLiteral"===e.left.type&&"NumericLiteral"===e.right.type){var t=e.left.value,r=e.right.value,n=null;switch(e.operator){case"+":n=t+r;break;case"-":n=t-r;break;case"*":n=t*r;break;case"/":n=0!==r?t/r:null;break;case"%":n=0!==r?t%r:null}if(null!==n)return void this.emitConstant(n)}switch(this.compileNode(e.left),this.compileNode(e.right),e.operator){case"+":this.emit(u.OpCode.ADD);break;case"-":this.emit(u.OpCode.SUBTRACT);break;case"*":this.emit(u.OpCode.MULTIPLY);break;case"/":this.emit(u.OpCode.DIVIDE);break;case"%":this.emit(u.OpCode.MODULO);break;case"==":this.emit(u.OpCode.EQUAL);break;case"!=":this.emit(u.OpCode.NOT_EQUAL);break;case"<":this.emit(u.OpCode.LESS_THAN);break;case"<=":this.emit(u.OpCode.LESS_EQUAL);break;case">":this.emit(u.OpCode.GREATER_THAN);break;case">=":this.emit(u.OpCode.GREATER_EQUAL);break;case"&":this.emit(u.OpCode.BITWISE_AND);break;case"|":this.emit(u.OpCode.BITWISE_OR);break;default:throw new o.CompilerError("Unknown binary operator ".concat(e.operator),e.line,e.column)}}},{key:"compileLogicalExpression",value:function(e){if("&&"===e.operator){this.compileNode(e.left);var t=this.emitJump(u.OpCode.JUMP_IF_FALSE);this.emit(u.OpCode.POP),this.compileNode(e.right),this.patchJump(t)}else if("||"===e.operator){this.compileNode(e.left);var r=this.emitJump(u.OpCode.JUMP_IF_FALSE),n=this.emitJump(u.OpCode.JUMP);this.patchJump(r),this.emit(u.OpCode.POP),this.compileNode(e.right),this.patchJump(n)}}},{key:"compileTryStatement",value:function(e){var t=this.emitJump(u.OpCode.SETUP_EXCEPTION);this.compileNode(e.tryBlock),this.emit(u.OpCode.TEARDOWN_EXCEPTION);var r=this.emitJump(u.OpCode.JUMP);this.patchJump(t),e.catchClause&&(this.beginScope(),this.symbolTable.define(e.catchClause.param.name,this.scopeDepth,!1),this.compileNode(e.catchClause.body),this.endScope()),this.patchJump(r),e.finallyBlock&&this.compileNode(e.finallyBlock)}},{key:"compressData",value:function(){var e;return null!==(e=this.settings.output)&&void 0!==e&&e.compact?{name:this.compiledFunction.name,arity:this.compiledFunction.arity,code:c.Compressor.encodeNumbers(this.compiledFunction.chunk.code),constants:c.Compressor.encodeJSON(this.compiledFunction.chunk.constants),lines:c.Compressor.encodeSmartPack(this.compiledFunction.chunk.lines)}:this.compiledFunction}},{key:"compile",value:function(){return this.compileNode(this.ast),"Program"!==this.ast.type&&"FunctionDeclaration"!==this.ast.type||(this.emit(u.OpCode.PUSH_NULL),this.emit(u.OpCode.RETURN)),this.compressData()}}])}();(0,i.default)(m,"FUNCTION_COMPRESS_MAGNIFICATION",4)},{"../const/errors":26,"../const/opcodes":27,"../util/compressor":35,"../util/jsonextended":38,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":6,"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":10}],24:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.Lexer=void 0;var i=n(e("@babel/runtime/helpers/classCallCheck")),s=n(e("@babel/runtime/helpers/createClass")),a=n(e("@babel/runtime/helpers/defineProperty")),o=e("../../const/errors");r.Lexer=(0,s.default)((function e(t){(0,i.default)(this,e),(0,a.default)(this,"pos",0),(0,a.default)(this,"line",1),(0,a.default)(this,"column",1),(0,a.default)(this,"keywords",{let:"KEYWORD",const:"KEYWORD",if:"KEYWORD",else:"KEYWORD",for:"KEYWORD",while:"KEYWORD",switch:"KEYWORD",case:"KEYWORD",default:"KEYWORD",break:"KEYWORD",function:"KEYWORD",return:"KEYWORD",true:"TRUE",false:"FALSE",null:"NULL",try:"KEYWORD",catch:"KEYWORD",finally:"KEYWORD",throw:"KEYWORD"}),""===t&&(t=" "),this.source=t,this.currentChar=this.source[this.pos]}),[{key:"advance",value:function(){"\n"===this.currentChar?(this.line++,this.column=1):this.column++,this.pos++,this.currentChar=this.pos<this.source.length?this.source[this.pos]:null}},{key:"peek",value:function(){return this.pos+1<this.source.length?this.source[this.pos+1]:null}},{key:"string",value:function(e){var t=this.line,r=this.column;this.advance();for(var n="";this.currentChar!==e&&null!==this.currentChar;)if("\\"===this.currentChar)this.advance(),null!==this.currentChar&&(n+=this.currentChar,this.advance());else{if("\n"===this.currentChar&&"`"!==e)throw new o.LexerError("Unterminated string at line ".concat(t,", column ").concat(r,"."),t,r);n+=this.currentChar,this.advance()}if(null===this.currentChar)throw new o.LexerError("Unterminated string.",t,r);return this.advance(),this.createToken("STRING",n)}},{key:"number",value:function(){if("0"===this.currentChar&&this.peek()&&/[bdx]/.test(this.peek())){this.advance();var e,t,r=this.currentChar;switch(this.advance(),r){case"b":e=2,t=/[01]/;break;case"d":e=10,t=/\d/;break;case"x":e=16,t=/[0-9a-fA-F]/;break;default:throw new o.LexerError("Invalid numeric prefix '0".concat(r,"'"),this.line,this.column)}for(var n="";null!==this.currentChar&&t.test(this.currentChar);)n+=this.currentChar,this.advance();if(0===n.length)throw new o.LexerError("Number literal has no digits after prefix '0".concat(r,"'"),this.line,this.column);var i=parseInt(n,e);return this.createToken("NUMBER",String(i))}for(var s="";null!==this.currentChar&&/\d/.test(this.currentChar);)s+=this.currentChar,this.advance();if("."===this.currentChar)for(s+=this.currentChar,this.advance();null!==this.currentChar&&/\d/.test(this.currentChar);)s+=this.currentChar,this.advance();else if("n"===this.currentChar)return this.advance(),this.createToken("BIGINT",s);return this.createToken("NUMBER",s)}},{key:"skipWhitespaceAndComments",value:function(){for(;null!==this.currentChar;)if(/\s/.test(this.currentChar))this.advance();else if("/"!==this.currentChar||"/"!==this.peek()){if("/"!==this.currentChar||"*"!==this.peek())break;for(this.advance(),this.advance();null!==this.currentChar&&("*"!==this.currentChar||"/"!==this.peek());)this.advance();null!==this.currentChar&&(this.advance(),this.advance())}else for(;"\n"!==this.currentChar&&null!==this.currentChar;)this.advance()}},{key:"createToken",value:function(e,t){return{type:e,value:t,line:this.line,column:this.column}}},{key:"identifier",value:function(){for(var e="";null!==this.currentChar&&/[a-zA-Z_0-9]/.test(this.currentChar);)e+=this.currentChar,this.advance();var t=this.keywords[e]||"IDENTIFIER";return this.createToken(t,e)}},{key:"tokenize",value:function(){for(var e=[];null!==this.currentChar&&(this.skipWhitespaceAndComments(),null!==this.currentChar);)if('"'!==this.currentChar&&"'"!==this.currentChar&&"`"!==this.currentChar)if(/\d/.test(this.currentChar))e.push(this.number());else if(/[a-zA-Z_]/.test(this.currentChar))e.push(this.identifier());else{switch(this.currentChar){case"=":e.push("="===this.peek()?(this.advance(),this.createToken("EQUAL_EQUAL","==")):this.createToken("EQUALS","="));break;case"!":e.push("="===this.peek()?(this.advance(),this.createToken("BANG_EQUAL","!=")):this.createToken("BANG","!"));break;case">":e.push("="===this.peek()?(this.advance(),this.createToken("GREATER_EQUAL",">=")):this.createToken("GREATER",">"));break;case"<":e.push("="===this.peek()?(this.advance(),this.createToken("LESS_EQUAL","<=")):this.createToken("LESS","<"));break;case"&":e.push("&"===this.peek()?(this.advance(),this.createToken("AND","&&")):this.createToken("AMPERSAND","&"));break;case"|":e.push("|"===this.peek()?(this.advance(),this.createToken("OR","||")):this.createToken("PIPE","|"));break;case"+":e.push("+"===this.peek()?(this.advance(),this.createToken("PLUS_PLUS","++")):this.createToken("PLUS","+"));break;case"-":e.push("-"===this.peek()?(this.advance(),this.createToken("MINUS_MINUS","--")):this.createToken("MINUS","-"));break;case"*":e.push(this.createToken("STAR","*"));break;case"/":e.push(this.createToken("SLASH","/"));break;case"%":e.push(this.createToken("PERCENT","%"));break;case"(":e.push(this.createToken("LPAREN","("));break;case")":e.push(this.createToken("RPAREN",")"));break;case"{":e.push(this.createToken("LBRACE","{"));break;case"}":e.push(this.createToken("RBRACE","}"));break;case"[":e.push(this.createToken("LBRACKET","["));break;case"]":e.push(this.createToken("RBRACKET","]"));break;case";":e.push(this.createToken("SEMICOLON",";"));break;case":":e.push(this.createToken("COLON",":"));break;case",":e.push(this.createToken("COMMA",","));break;default:throw new o.LexerError("Unknown character: ".concat(this.currentChar),this.line,this.column)}this.advance()}else e.push(this.string(this.currentChar));return e.push(this.createToken("EOF","")),e}}])},{"../../const/errors":26,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":6,"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":10}],25:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.Parser=void 0;var i,s=n(e("@babel/runtime/helpers/classCallCheck")),a=n(e("@babel/runtime/helpers/createClass")),o=n(e("@babel/runtime/helpers/defineProperty")),u=e("../../const/errors");function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e[e.LOWEST=0]="LOWEST",e[e.ASSIGNMENT=1]="ASSIGNMENT",e[e.OR=2]="OR",e[e.AND=3]="AND",e[e.BITWISE_OR=4]="BITWISE_OR",e[e.BITWISE_AND=5]="BITWISE_AND",e[e.EQUALS=6]="EQUALS",e[e.LESS_GREATER=7]="LESS_GREATER",e[e.SUM=8]="SUM",e[e.PRODUCT=9]="PRODUCT",e[e.PREFIX=10]="PREFIX",e[e.POSTFIX=11]="POSTFIX",e[e.CALL=12]="CALL",e[e.INDEX=13]="INDEX"}(i||(i={}));var p={EQUALS:i.ASSIGNMENT,OR:i.OR,AND:i.AND,PIPE:i.BITWISE_OR,AMPERSAND:i.BITWISE_AND,EQUAL_EQUAL:i.EQUALS,BANG_EQUAL:i.EQUALS,GREATER:i.LESS_GREATER,GREATER_EQUAL:i.LESS_GREATER,LESS:i.LESS_GREATER,LESS_EQUAL:i.LESS_GREATER,PLUS:i.SUM,MINUS:i.SUM,STAR:i.PRODUCT,SLASH:i.PRODUCT,PERCENT:i.PRODUCT,PLUS_PLUS:i.POSTFIX,MINUS_MINUS:i.POSTFIX,LPAREN:i.CALL,LBRACKET:i.INDEX,DOT:i.INDEX};r.Parser=(0,a.default)((function e(t){var r=this;(0,s.default)(this,e),(0,o.default)(this,"pos",0),(0,o.default)(this,"parseIdentifier",(function(){return r.createNode("Identifier",{name:r.currentToken.value})})),(0,o.default)(this,"parseNumericLiteral",(function(){return r.createNode("NumericLiteral",{value:parseFloat(r.currentToken.value)})})),(0,o.default)(this,"parseBigIntLiteral",(function(){return r.createNode("BigIntLiteral",{value:r.currentToken.value})})),(0,o.default)(this,"parseStringLiteral",(function(){return r.createNode("StringLiteral",{value:r.currentToken.value})})),(0,o.default)(this,"parseBooleanLiteral",(function(){return r.createNode("BooleanLiteral",{value:"TRUE"===r.currentToken.type})})),(0,o.default)(this,"parseNullLiteral",(function(){return r.createNode("NullLiteral",{})})),(0,o.default)(this,"parseAssignmentExpression",(function(e){if("Identifier"!==e.type&&"MemberExpression"!==e.type)throw new u.ParserError("Invalid assignment target.",e.line,e.column);var t=r.currentPrecedence();r.advance();var n=r.parseExpression(t-1);return r.createNode("AssignmentExpression",{left:e,right:n})})),(0,o.default)(this,"parsePrefixExpression",(function(){var e=r.currentToken.value;r.advance();var t=r.parseExpression(i.PREFIX);return r.createNode("UnaryExpression",{operator:e,right:t})})),(0,o.default)(this,"parseUpdateExpression",(function(e){if(e){if("Identifier"!==e.type&&"MemberExpression"!==e.type)throw new u.ParserError("The left-hand side of a postfix operator must be an identifier.",e.line,e.column);return r.createNode("UpdateExpression",{operator:r.currentToken.value,argument:e,prefix:!1})}var t=r.currentToken.value;if(r.advance(),"IDENTIFIER"!==r.currentToken.type)throw new u.ParserError("The right-hand side of a prefix operator must be an identifier.",r.currentToken.line,r.currentToken.column);var n=r.parseIdentifier();return r.createNode("UpdateExpression",{operator:t,argument:n,prefix:!0})})),(0,o.default)(this,"parseInfixExpression",(function(e){var t=r.currentToken.value,n=r.currentPrecedence();r.advance();var i=r.parseExpression(n);return r.createNode("BinaryExpression",{left:e,operator:t,right:i})})),(0,o.default)(this,"parseLogicalExpression",(function(e){var t=r.currentToken.value,n=r.currentPrecedence();r.advance();var i=r.parseExpression(n);return r.createNode("LogicalExpression",{left:e,operator:t,right:i})})),(0,o.default)(this,"parseGroupedOrTupleExpression",(function(){var e=r.currentToken;if(r.advance(),"RPAREN"===r.peekToken.type)throw new u.ParserError("Empty parentheses `()` is not allowed.",e.line,e.column);var t=r.parseExpression(i.LOWEST);if("RPAREN"===r.currentToken.type)return r.advance(),t;if("COMMA"===r.peekToken.type){r.advance();for(var n=[t];"RPAREN"!==r.currentToken.type&&(n.push(r.parseExpression(i.LOWEST)),"RPAREN"!==r.currentToken.type);){if("COMMA"!==r.currentToken.type)throw new u.ParserError("Expected ',' or ')' in tuple, got ".concat(r.currentToken.type),r.currentToken.line,r.currentToken.column);r.advance()}return r.advance(),r.createNode("TupleLiteral",{elements:n})}throw new u.ParserError("Expected ')' or ',' after expression, got ".concat(r.currentToken.type),r.currentToken.line,r.currentToken.column)})),(0,o.default)(this,"parseCallExpression",(function(e){var t=r.parseExpressionList("RPAREN");return r.createNode("CallExpression",{callee:e,arguments:t})})),(0,o.default)(this,"parseMemberExpression",(function(e){var t,n="LBRACKET"===r.currentToken.type;if(r.advance(),n)t=r.parseExpression(i.LOWEST),r.expectPeek("RBRACKET");else{if("IDENTIFIER"!==r.currentToken.type)throw new u.ParserError("Expected identifier after '.' operator.",r.currentToken.line,r.currentToken.column);t=r.parseIdentifier()}return r.createNode("MemberExpression",{object:e,property:t})})),(0,o.default)(this,"parseArrayLiteral",(function(){var e=r.parseExpressionList("RBRACKET");return r.createNode("ArrayLiteral",{elements:e})})),(0,o.default)(this,"parseObjectLiteral",(function(){var e=[];if("RBRACE"===r.peekToken.type)return r.advance(),r.createNode("ObjectLiteral",{properties:e});r.advance();do{if("RBRACE"===r.currentToken.type)break;if("COMMA"===r.currentToken.type&&r.advance(),"IDENTIFIER"!==r.currentToken.type&&"STRING"!==r.currentToken.type)throw new u.ParserError("Invalid key in object literal. Must be an identifier or a string.",r.currentToken.line,r.currentToken.column);var t="IDENTIFIER"===r.currentToken.type?r.parseIdentifier():r.parseStringLiteral();r.expectPeek("COLON"),r.advance();var n=r.parseExpression(i.LOWEST);e.push({key:t,value:n})}while("COMMA"===r.peekToken.type);return r.expectPeek("RBRACE"),r.createNode("ObjectLiteral",{properties:e})})),(0,o.default)(this,"parseBlockStatement",(function(){var e=[];for(r.advance();"RBRACE"!==r.currentToken.type&&"EOF"!==r.currentToken.type;){var t=r.parseStatement();t&&e.push(t),r.advance()}return r.createNode("BlockStatement",{body:e})})),(0,o.default)(this,"parseCondition",(function(){r.expectPeek("LPAREN"),r.advance();var e=r.parseExpression(i.LOWEST);return r.expectPeek("RPAREN"),e})),(0,o.default)(this,"parseVariableDeclaration",(function(){var e=r.currentToken.value;r.expectPeek("IDENTIFIER");var t,n,s=r.createNode("Identifier",{name:r.currentToken.value});return"COLON"===r.peekToken.type&&(r.advance(),r.advance(),t=r.parseIdentifier()),"EQUALS"===r.peekToken.type&&(r.advance(),r.advance(),n=r.parseExpression(i.LOWEST)),r.createNode("VariableDeclaration",{kind:e,identifier:s,typeAnnotation:t,init:n})})),(0,o.default)(this,"parseReturnStatement",(function(){if(r.advance(),"SEMICOLON"===r.currentToken.type||"RBRACE"===r.currentToken.type)return r.createNode("ReturnStatement",{});var e=r.parseExpression(i.LOWEST);return r.createNode("ReturnStatement",{argument:e})})),(0,o.default)(this,"parseBreakStatement",(function(){return r.createNode("BreakStatement",{})})),(0,o.default)(this,"parseIfStatement",(function(){var e=r.currentToken,t=r.parseCondition();r.advance();var n,i=r.parseStatement();if(null===i)throw new u.ParserError("Consequence of 'if' statement is empty.",e.line,e.column);var s=r.peekToken,a=s.type,o=s.value;return"KEYWORD"===a&&"else"===o&&(r.advance(),r.advance(),r.advance(),n=r.parseStatement()),null===n&&(n=void 0),r.createNode("IfStatement",{test:t,consequence:i,alternate:n})})),(0,o.default)(this,"parseForStatement",(function(){var e,t,n,s=r.currentToken;r.expectPeek("LPAREN"),r.advance(),"SEMICOLON"!==r.currentToken.type&&(e="KEYWORD"!==r.currentToken.type||"let"!==r.currentToken.value&&"const"!==r.currentToken.value?r.parseExpression(i.LOWEST):r.parseVariableDeclaration()),r.expectPeek("SEMICOLON"),r.advance(),"SEMICOLON"!==r.currentToken.type&&(t=r.parseExpression(i.LOWEST)),r.expectPeek("SEMICOLON"),r.advance(),"RPAREN"!==r.currentToken.type&&(n=r.parseExpression(i.LOWEST)),r.expectPeek("RPAREN"),r.advance();var a=r.parseStatement();if(null===a)throw new u.ParserError("Body of 'for' statement is empty.",s.line,s.column);return r.createNode("ForStatement",{init:e,test:t,update:n,body:a})})),(0,o.default)(this,"parseWhileStatement",(function(){var e=r.currentToken,t=r.parseCondition();r.advance();var n=r.parseStatement();if(null===n)throw new u.ParserError("Body of 'while' statement is empty.",e.line,e.column);return r.createNode("WhileStatement",{test:t,body:n})})),(0,o.default)(this,"parseSwitchStatement",(function(){var e=r.parseCondition();r.expectPeek("LBRACE"),r.advance();for(var t=[];"RBRACE"!==r.currentToken.type&&"EOF"!==r.currentToken.type;){var n=null;if("KEYWORD"===r.currentToken.type&&"case"===r.currentToken.value)r.advance(),n=r.parseExpression(i.LOWEST);else if("KEYWORD"!==r.currentToken.type||"default"!==r.currentToken.value){if("RBRACE"===r.currentToken.type)break;throw new u.ParserError("Expected 'case', 'default' or '}', got ".concat(r.currentToken.type," instead."),r.currentToken.line,r.currentToken.column)}r.expectPeek("COLON"),r.advance();for(var s=[];"RBRACE"!==r.currentToken.type&&("KEYWORD"!==r.currentToken.type||"case"!==r.currentToken.value&&"default"!==r.currentToken.value);){var a=r.parseStatement();a&&"EmptyStatement"!==a.type&&s.push(a),"RBRACE"!==r.currentToken.type&&r.advance()}t.push(r.createNode("SwitchCase",{test:n,consequent:s}))}return r.createNode("SwitchStatement",{discriminant:e,cases:t})})),(0,o.default)(this,"parseFunctionDeclaration",(function(){r.advance();var e=r.parseIdentifier();r.expectPeek("LPAREN");var t,n=[];if("RPAREN"!==r.peekToken.type){r.advance();var s=!0;do{"COMMA"!==r.peekToken.type||s?s=!1:(r.advance(),r.advance());var a=r.parseIdentifier(),o=void 0;"COLON"===r.peekToken.type&&(r.advance(),r.advance(),o=r.parseIdentifier());var u=void 0;"EQUALS"===r.peekToken.type&&(r.advance(),r.advance(),u=r.parseExpression(i.LOWEST)),n.push({name:a,typeAnnotation:o,defaultValue:u})}while("COMMA"===r.peekToken.type)}r.expectPeek("RPAREN"),"COLON"===r.peekToken.type&&(r.advance(),r.advance(),t=r.parseIdentifier()),r.expectPeek("LBRACE");var c=r.parseBlockStatement();return r.createNode("FunctionDeclaration",{name:e,params:n,body:c,returnType:t})})),(0,o.default)(this,"parseTryStatement",(function(){r.expectPeek("LBRACE");var e=r.parseBlockStatement(),t=null,n=r.peekToken;if("KEYWORD"===r.peekToken.type&&"catch"===r.peekToken.value){r.advance(),r.expectPeek("LPAREN"),r.advance();var i=r.parseIdentifier();r.expectPeek("RPAREN"),r.expectPeek("LBRACE"),t={param:i,body:r.parseBlockStatement()}}var s=null;if("KEYWORD"===r.peekToken.type&&"finally"===r.peekToken.value&&(r.advance(),r.expectPeek("LBRACE"),s=r.parseBlockStatement()),!t&&!s)throw new u.ParserError("'try' must have at least a 'catch' or 'finally' block.",n.line,n.column);return r.createNode("TryStatement",{tryBlock:e,catchClause:t,finallyBlock:s})})),(0,o.default)(this,"parseExpressionStatement",(function(){var e=r.parseExpression(i.LOWEST);return r.createNode("ExpressionStatement",{expression:e})})),this.tokens=t,this.currentToken=this.tokens[0],this.peekToken=this.tokens[1],this.prefixParseFns=new Map,this.registerPrefix("IDENTIFIER",this.parseIdentifier),this.registerPrefix("NUMBER",this.parseNumericLiteral),this.registerPrefix("BIGINT",this.parseBigIntLiteral),this.registerPrefix("STRING",this.parseStringLiteral),this.registerPrefix("TRUE",this.parseBooleanLiteral),this.registerPrefix("FALSE",this.parseBooleanLiteral),this.registerPrefix("NULL",this.parseNullLiteral),this.registerPrefix("BANG",this.parsePrefixExpression),this.registerPrefix("MINUS",this.parsePrefixExpression),this.registerPrefix("PLUS_PLUS",this.parseUpdateExpression),this.registerPrefix("MINUS_MINUS",this.parseUpdateExpression),this.registerPrefix("LPAREN",this.parseGroupedOrTupleExpression),this.registerPrefix("LBRACKET",this.parseArrayLiteral),this.registerPrefix("LBRACE",this.parseObjectLiteral),this.infixParseFns=new Map,this.registerInfix("EQUALS",this.parseAssignmentExpression),this.registerInfix("PLUS",this.parseInfixExpression),this.registerInfix("MINUS",this.parseInfixExpression),this.registerInfix("STAR",this.parseInfixExpression),this.registerInfix("SLASH",this.parseInfixExpression),this.registerInfix("PERCENT",this.parseInfixExpression),this.registerInfix("EQUAL_EQUAL",this.parseInfixExpression),this.registerInfix("BANG_EQUAL",this.parseInfixExpression),this.registerInfix("GREATER",this.parseInfixExpression),this.registerInfix("GREATER_EQUAL",this.parseInfixExpression),this.registerInfix("LESS",this.parseInfixExpression),this.registerInfix("LESS_EQUAL",this.parseInfixExpression),this.registerInfix("AMPERSAND",this.parseInfixExpression),this.registerInfix("PIPE",this.parseInfixExpression),this.registerInfix("AND",this.parseLogicalExpression),this.registerInfix("OR",this.parseLogicalExpression),this.registerInfix("PLUS_PLUS",this.parseUpdateExpression),this.registerInfix("MINUS_MINUS",this.parseUpdateExpression),this.registerInfix("LPAREN",this.parseCallExpression),this.registerInfix("LBRACKET",this.parseMemberExpression),this.registerInfix("DOT",this.parseMemberExpression)}),[{key:"createNode",value:function(e,t){return l(l({type:e},t),{},{line:this.currentToken.line,column:this.currentToken.column})}},{key:"advance",value:function(){this.pos++,this.currentToken=this.peekToken,this.pos+1<this.tokens.length?this.peekToken=this.tokens[this.pos+1]:this.peekToken={type:"EOF",value:"",line:this.currentToken.line,column:this.currentToken.column+1}}},{key:"registerPrefix",value:function(e,t){this.prefixParseFns.set(e,t.bind(this))}},{key:"registerInfix",value:function(e,t){this.infixParseFns.set(e,t.bind(this))}},{key:"expectPeek",value:function(e){if(this.peekToken.type!==e)throw new u.ParserError("Expected next token to be ".concat(e,", got ").concat(this.peekToken.type," instead."),this.peekToken.line,this.peekToken.column);this.advance()}},{key:"peekPrecedence",value:function(){return p[this.peekToken.type]||i.LOWEST}},{key:"currentPrecedence",value:function(){return p[this.currentToken.type]||i.LOWEST}},{key:"parseExpression",value:function(e){var t=this.prefixParseFns.get(this.currentToken.type);if(!t)throw new u.ParserError("No prefix parse function for ".concat(this.currentToken.type," found."),this.currentToken.line,this.currentToken.column);for(var r=t();"SEMICOLON"!==this.peekToken.type&&e<this.peekPrecedence();){var n=this.infixParseFns.get(this.peekToken.type);if(!n)return r;this.advance(),r=n(r)}return r}},{key:"parseExpressionList",value:function(e){var t=[];if(this.peekToken.type===e)return this.advance(),t;for(this.advance(),t.push(this.parseExpression(i.LOWEST));"COMMA"===this.peekToken.type;)this.advance(),this.advance(),t.push(this.parseExpression(i.LOWEST));return this.expectPeek(e),t}},{key:"parseStatement",value:function(){if("SEMICOLON"===this.currentToken.type)return this.createNode("EmptyStatement",{});switch(this.currentToken.type){case"LBRACE":return this.parseBlockStatement();case"KEYWORD":switch(this.currentToken.value){case"let":case"const":return this.parseVariableDeclaration();case"return":return this.parseReturnStatement();case"if":return this.parseIfStatement();case"for":return this.parseForStatement();case"while":return this.parseWhileStatement();case"switch":return this.parseSwitchStatement();case"break":return this.parseBreakStatement();case"function":return this.parseFunctionDeclaration();case"try":return this.parseTryStatement()}default:return this.parseExpressionStatement()}}},{key:"parse",value:function(){var e=this.createNode("Program",{body:[]});for(console.log(this.tokens);"EOF"!==this.currentToken.type;)if("SEMICOLON"!==this.currentToken.type){var t=this.parseStatement();t&&e.body.push(t),"RBRACE"!==this.currentToken.type&&"SEMICOLON"===this.peekToken.type&&this.advance(),this.advance()}else this.advance();return e}}])},{"../../const/errors":26,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":6,"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":10}],26:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.VMError=r.SymbolTableError=r.SnowFallBaseError=r.SimpleError=r.PositionedError=r.ParserError=r.LexerError=r.CompilerError=void 0;var i=n(e("@babel/runtime/helpers/createClass")),s=n(e("@babel/runtime/helpers/classCallCheck")),a=n(e("@babel/runtime/helpers/possibleConstructorReturn")),o=n(e("@babel/runtime/helpers/getPrototypeOf")),u=n(e("@babel/runtime/helpers/inherits")),c=n(e("@babel/runtime/helpers/wrapNativeSuper"));function l(e,t,r){return t=(0,o.default)(t),(0,a.default)(e,p()?Reflect.construct(t,r||[],(0,o.default)(e).constructor):t.apply(e,r))}function p(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(p=function(){return!!e})()}var h=r.SnowFallBaseError=function(e){function t(e){var r;(0,s.default)(this,t),(r=l(this,t,[e])).name=r.constructor.name;var n=Error;return n.captureStackTrace&&n.captureStackTrace(r,r.constructor),r}return(0,u.default)(t,e),(0,i.default)(t)}((0,c.default)(Error)),f=r.PositionedError=function(e){function t(e,r,n){var i;return(0,s.default)(this,t),(i=l(this,t,["".concat(e,"\n (at line ").concat(r,", column ").concat(n,")")])).line=r,i.column=n,i}return(0,u.default)(t,e),(0,i.default)(t)}(h),d=r.SimpleError=function(e){function t(e){return(0,s.default)(this,t),l(this,t,[e])}return(0,u.default)(t,e),(0,i.default)(t)}(h);r.LexerError=function(e){function t(){return(0,s.default)(this,t),l(this,t,arguments)}return(0,u.default)(t,e),(0,i.default)(t)}(f),r.ParserError=function(e){function t(){return(0,s.default)(this,t),l(this,t,arguments)}return(0,u.default)(t,e),(0,i.default)(t)}(f),r.CompilerError=function(e){function t(){return(0,s.default)(this,t),l(this,t,arguments)}return(0,u.default)(t,e),(0,i.default)(t)}(f),r.SymbolTableError=function(e){function t(){return(0,s.default)(this,t),l(this,t,arguments)}return(0,u.default)(t,e),(0,i.default)(t)}(d),r.VMError=function(e){function t(e){return(0,s.default)(this,t),l(this,t,[e])}return(0,u.default)(t,e),(0,i.default)(t)}(h)},{"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":6,"@babel/runtime/helpers/getPrototypeOf":8,"@babel/runtime/helpers/inherits":9,"@babel/runtime/helpers/interopRequireDefault":10,"@babel/runtime/helpers/possibleConstructorReturn":15,"@babel/runtime/helpers/wrapNativeSuper":22}],27:[function(e,t,r){"use strict";var n;Object.defineProperty(r,"__esModule",{value:!0}),r.OpCode=void 0,function(e){e[e.PUSH_CONST=0]="PUSH_CONST",e[e.PUSH_NULL=1]="PUSH_NULL",e[e.PUSH_TRUE=2]="PUSH_TRUE",e[e.PUSH_FALSE=3]="PUSH_FALSE",e[e.DUP=4]="DUP",e[e.ADD=5]="ADD",e[e.SUBTRACT=6]="SUBTRACT",e[e.MULTIPLY=7]="MULTIPLY",e[e.DIVIDE=8]="DIVIDE",e[e.MODULO=9]="MODULO",e[e.EQUAL=10]="EQUAL",e[e.NOT_EQUAL=11]="NOT_EQUAL",e[e.GREATER_THAN=12]="GREATER_THAN",e[e.GREATER_EQUAL=13]="GREATER_EQUAL",e[e.LESS_THAN=14]="LESS_THAN",e[e.LESS_EQUAL=15]="LESS_EQUAL",e[e.NEGATE=16]="NEGATE",e[e.BITWISE_AND=17]="BITWISE_AND",e[e.BITWISE_OR=18]="BITWISE_OR",e[e.POP=19]="POP",e[e.DEFINE_GLOBAL=20]="DEFINE_GLOBAL",e[e.GET_GLOBAL=21]="GET_GLOBAL",e[e.SET_GLOBAL=22]="SET_GLOBAL",e[e.GET_LOCAL=23]="GET_LOCAL",e[e.SET_LOCAL=24]="SET_LOCAL",e[e.BUILD_ARRAY=25]="BUILD_ARRAY",e[e.BUILD_OBJECT=26]="BUILD_OBJECT",e[e.GET_PROPERTY=27]="GET_PROPERTY",e[e.SET_PROPERTY=28]="SET_PROPERTY",e[e.BUILD_TUPLE=29]="BUILD_TUPLE",e[e.JUMP=30]="JUMP",e[e.JUMP_IF_FALSE=31]="JUMP_IF_FALSE",e[e.LOOP=32]="LOOP",e[e.CALL=33]="CALL",e[e.RETURN=34]="RETURN",e[e.CHECK_TYPE=35]="CHECK_TYPE",e[e.SETUP_EXCEPTION=36]="SETUP_EXCEPTION",e[e.TEARDOWN_EXCEPTION=37]="TEARDOWN_EXCEPTION",e[e.THROW=38]="THROW"}(n||(r.OpCode=n={}))},{}],28:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("./main");"undefined"!=typeof window&&(window.SnowFall=n.SnowFall);r.default=n.SnowFall},{"./main":34}],29:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault"),i=e("@babel/runtime/helpers/typeof");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=n(e("@babel/runtime/helpers/classCallCheck")),a=n(e("@babel/runtime/helpers/createClass")),o=n(e("@babel/runtime/helpers/defineProperty")),u=l(e("./config")),c=l(e("./util"));function l(e,t){if("function"==typeof WeakMap)var r=new WeakMap,n=new WeakMap;return(l=function(e,t){if(!t&&e&&e.__esModule)return e;var s,a,o={__proto__:null,default:e};if(null===e||"object"!=i(e)&&"function"!=typeof e)return o;if(s=t?n:r){if(s.has(e))return s.get(e);s.set(e,o)}for(var u in e)"default"!==u&&{}.hasOwnProperty.call(e,u)&&((a=(s=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,u))&&(a.get||a.set)?s(o,u,a):o[u]=e[u]);return o})(e,t)}r.default=(0,a.default)((function e(t){(0,s.default)(this,e),(0,o.default)(this,"_data",null),(0,o.default)(this,"_table",null),(0,o.default)(this,"_result",null),(0,o.default)(this,"_offset",0),(0,o.default)(this,"_dataLen",0),(0,o.default)(this,"_index",0),(0,o.default)(this,"_length",0),this._init(t)}),[{key:"_init",value:function(e){e=e||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=e.onData,this._onEndCallback=e.onEnd}},{key:"_createTable",value:function(){for(var e=c.createBuffer(8,u.TABLE_LENGTH),t=0;t<u.TABLE_LENGTH;t++)e[t]=u.BASE62TABLE.charCodeAt(t);return e}},{key:"_onData",value:function(e,t){var r=c.bufferToString_fast(e,t);this._onDataCallback?this._onDataCallback(r):null!==this._result&&(this._result+=r)}},{key:"_onEnd",value:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null}},{key:"_search",value:function(){var e=2,t=this._data,r=this._offset,n=u.BUFFER_MAX;if(this._dataLen-r<n&&(n=this._dataLen-r),e>n)return!1;var i,s,a,o,c,l=r-u.WINDOW_BUFFER_MAX,p=t.substring(l,r+n),h=r+e-3-l;do{if(2===e){if(s=t.charAt(r)+t.charAt(r+1),-1===(a=p.indexOf(s))||a>h)break}else 3===e?s+=t.charAt(r+2):s=t.substr(r,e);if(-1===(o=u.STRING_LASTINDEXOF_BUG?t.substring(l,r+e-1).lastIndexOf(s):p.lastIndexOf(s,h)))break;c=o,i=l+o;do{if(t.charCodeAt(r+e)!==t.charCodeAt(i+e))break}while(++e<n);if(a===o){e++;break}}while(++e<n);return 2!==e&&(this._index=u.WINDOW_BUFFER_MAX-c,this._length=e-1,!0)}},{key:"compress",value:function(e){if(null==e||0===e.length)return"";var t,r=this._createTable(),n=c.createWindow(),i=c.createBuffer(8,u.COMPRESS_CHUNK_SIZE),s=0;this._result="",this._offset=n.length,this._data=n+e,this._dataLen=this._data.length;for(var a,o,l,p,h,f=-1,d=-1;this._offset<this._dataLen;)this._search()?(this._index<u.BUFFER_MAX?(o=this._index,l=0):(o=this._index%u.BUFFER_MAX,l=(this._index-o)/u.BUFFER_MAX),2===this._length?(i[s++]=r[l+u.COMPRESS_FIXED_START],i[s++]=r[o]):(i[s++]=r[l+u.COMPRESS_START],i[s++]=r[o],i[s++]=r[this._length]),this._offset+=this._length,~d&&(d=-1)):(a=this._data.charCodeAt(this._offset++))<u.LATIN_BUFFER_MAX?(a<u.UNICODE_CHAR_MAX?(o=a,f=u.LATIN_INDEX):f=(l=(a-(o=a%u.UNICODE_CHAR_MAX))/u.UNICODE_CHAR_MAX)+u.LATIN_INDEX,d===f?i[s++]=r[o]:(i[s++]=r[f-u.LATIN_INDEX_START],i[s++]=r[o],d=f)):(a<u.UNICODE_BUFFER_MAX?(f=u.UNICODE_INDEX,o=a):f=(l=(a-(o=a%u.UNICODE_BUFFER_MAX))/u.UNICODE_BUFFER_MAX)+u.UNICODE_INDEX,o<u.UNICODE_CHAR_MAX?(p=o,h=0):h=(o-(p=o%u.UNICODE_CHAR_MAX))/u.UNICODE_CHAR_MAX,d===f?(i[s++]=r[p],i[s++]=r[h]):(i[s++]=r[u.CHAR_START],i[s++]=r[f-u.TABLE_LENGTH],i[s++]=r[p],i[s++]=r[h],d=f)),s>=u.COMPRESS_CHUNK_MAX&&(this._onData(i,s),s=0);return s>0&&this._onData(i,s),this._onEnd(),t=this._result,this._result=null,null===t?"":t}}])},{"./config":30,"./util":33,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":6,"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":10,"@babel/runtime/helpers/typeof":20}],30:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.WINDOW_MAX=r.WINDOW_BUFFER_MAX=r.UNICODE_INDEX=r.UNICODE_CHAR_MAX=r.UNICODE_BUFFER_MAX=r.TABLE_LENGTH=r.TABLE_DIFF=r.STRING_LASTINDEXOF_BUG=r.LATIN_INDEX_START=r.LATIN_INDEX=r.LATIN_DECODE_MAX=r.LATIN_BUFFER_MAX=r.HAS_TYPED=r.DECOMPRESS_CHUNK_SIZE=r.DECOMPRESS_CHUNK_MAX=r.DECODE_MAX=r.COMPRESS_START=r.COMPRESS_INDEX=r.COMPRESS_FIXED_START=r.COMPRESS_CHUNK_SIZE=r.COMPRESS_CHUNK_MAX=r.CHAR_START=r.CAN_CHARCODE_APPLY_TYPED=r.CAN_CHARCODE_APPLY=r.BUFFER_MAX=r.BASE62TABLE=r.APPLY_BUFFER_SIZE_OK=r.APPLY_BUFFER_SIZE=void 0,r.setApplyBufferSizeOk=function(e){r.APPLY_BUFFER_SIZE_OK=e};var n=r.HAS_TYPED="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array,i=!1;try{"a"===String.fromCharCode.apply(null,[97])&&(i=!0)}catch(e){}r.CAN_CHARCODE_APPLY=i;var s=!1;if(n)try{"a"===String.fromCharCode.apply(null,new Uint8Array([97]))&&(s=!0)}catch(e){}r.CAN_CHARCODE_APPLY_TYPED=s;var a=r.APPLY_BUFFER_SIZE=65533;r.APPLY_BUFFER_SIZE_OK=null;var o=!1;-1!=="abc".lastIndexOf("",1)&&(o=!0);r.STRING_LASTINDEXOF_BUG=o;var u=r.BASE62TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=r.TABLE_LENGTH=u.length,l=r.TABLE_DIFF=Math.max(c,62)-Math.min(c,62),p=(r.BUFFER_MAX=c-1,r.WINDOW_MAX=1024),h=(r.WINDOW_BUFFER_MAX=304,r.COMPRESS_CHUNK_SIZE=a),f=(r.COMPRESS_CHUNK_MAX=h-c,r.DECOMPRESS_CHUNK_SIZE=a),d=(r.DECOMPRESS_CHUNK_MAX=f+2*p,r.LATIN_BUFFER_MAX=132,r.UNICODE_CHAR_MAX=40),m=(r.UNICODE_BUFFER_MAX=d*(d+1),r.LATIN_INDEX=c+1,r.LATIN_INDEX_START=l+20,r.UNICODE_INDEX=c+5,r.DECODE_MAX=c-l-19,r.LATIN_DECODE_MAX=d+7),E=r.CHAR_START=m+1,b=r.COMPRESS_START=E+1,y=r.COMPRESS_FIXED_START=b+5;r.COMPRESS_INDEX=y+5},{}],31:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault"),i=e("@babel/runtime/helpers/typeof");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=n(e("@babel/runtime/helpers/classCallCheck")),a=n(e("@babel/runtime/helpers/createClass")),o=n(e("@babel/runtime/helpers/defineProperty")),u=l(e("./config")),c=l(e("./util"));function l(e,t){if("function"==typeof WeakMap)var r=new WeakMap,n=new WeakMap;return(l=function(e,t){if(!t&&e&&e.__esModule)return e;var s,a,o={__proto__:null,default:e};if(null===e||"object"!=i(e)&&"function"!=typeof e)return o;if(s=t?n:r){if(s.has(e))return s.get(e);s.set(e,o)}for(var u in e)"default"!==u&&{}.hasOwnProperty.call(e,u)&&((a=(s=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,u))&&(a.get||a.set)?s(o,u,a):o[u]=e[u]);return o})(e,t)}r.default=(0,a.default)((function e(t){(0,s.default)(this,e),(0,o.default)(this,"_result",null),this._init(t)}),[{key:"_init",value:function(e){e=e||{},this._result=null,this._onDataCallback=e.onData,this._onEndCallback=e.onEnd}},{key:"_createTable",value:function(){for(var e={},t=0;t<u.TABLE_LENGTH;t++)e[u.BASE62TABLE.charAt(t)]=t;return e}},{key:"_onData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._onDataCallback&&this._result){var t;if(e)t=this._result,this._result=[];else{var r=u.DECOMPRESS_CHUNK_SIZE-u.WINDOW_MAX;t=this._result.slice(u.WINDOW_MAX,u.WINDOW_MAX+r),this._result=this._result.slice(0,u.WINDOW_MAX).concat(this._result.slice(u.WINDOW_MAX+r))}t.length>0&&this._onDataCallback(c.bufferToString_fast(t))}}},{key:"_onEnd",value:function(){this._onEndCallback&&this._onEndCallback()}},{key:"decompress",value:function(e){if(null==e||0===e.length)return"";this._result=c.stringToArray(c.createWindow());for(var t,r,n,i,s,a,o,l,p,h,f=this._createTable(),d=!1,m=null,E=e.length,b=0;b<E;b++)if(void 0!==(n=f[e.charAt(b)])){if(n<u.DECODE_MAX)s=d?f[e.charAt(++b)]*u.UNICODE_CHAR_MAX+n+u.UNICODE_BUFFER_MAX*m:m*u.UNICODE_CHAR_MAX+n,this._result[this._result.length]=s;else if(n<u.LATIN_DECODE_MAX)m=n-u.DECODE_MAX,d=!1;else if(n===u.CHAR_START)m=(i=f[e.charAt(++b)])-5,d=!0;else if(n<u.COMPRESS_INDEX){if(i=f[e.charAt(++b)],n<u.COMPRESS_FIXED_START?(a=(n-u.COMPRESS_START)*u.BUFFER_MAX+i,o=f[e.charAt(++b)]):(a=(n-u.COMPRESS_FIXED_START)*u.BUFFER_MAX+i,o=2),(l=this._result.slice(-a)).length>o&&(l.length=o),p=l.length,l.length>0)for(h=0;h<o;)for(r=0;r<p&&(this._result[this._result.length]=l[r],!(++h>=o));r++);m=null}this._result.length>=u.DECOMPRESS_CHUNK_MAX&&this._onData()}return this._result=this._result.slice(u.WINDOW_MAX),this._onData(!0),this._onEnd(),t=c.bufferToString_fast(this._result),this._result=null,t}}])},{"./config":30,"./util":33,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":6,"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":10,"@babel/runtime/helpers/typeof":20}],32:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.compress=a,r.decompress=o,r.version=r.default=void 0;var i=n(e("./compressor")),s=n(e("./decompressor"));r.version="2.0.0-ts";function a(e,t){return new i.default(t).compress(e)}function o(e,t){return new s.default(t).decompress(e)}
/**
 * forked from lzbase62
 * @module lzbase62
 * @see https://github.com/polygonplanet/lzbase62
 * @license MIT
 * @version 2.0.0
 */r.default={compress:a,decompress:o}},{"./compressor":29,"./decompressor":31,"@babel/runtime/helpers/interopRequireDefault":10}],33:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/typeof");Object.defineProperty(r,"__esModule",{value:!0}),r.bufferToString_chunked=o,r.bufferToString_fast=function(e,t){null==t?t=e.length:e=a(e,t);if(i.CAN_CHARCODE_APPLY&&i.CAN_CHARCODE_APPLY_TYPED){var r=e.length;if(r<i.APPLY_BUFFER_SIZE&&i.APPLY_BUFFER_SIZE_OK)return s.apply(null,e);if(null===i.APPLY_BUFFER_SIZE_OK)try{var n=s.apply(null,e);return r>i.APPLY_BUFFER_SIZE&&i.setApplyBufferSizeOk(!0),n}catch(e){i.setApplyBufferSizeOk(!1)}}return o(e)},r.bufferToString_slow=u,r.createBuffer=function(e,t){if(i.HAS_TYPED)switch(e){case 8:return new Uint8Array(t);case 16:return new Uint16Array(t)}return new Array(t)},r.createWindow=function(){var e=i.WINDOW_MAX>>7,t="        ";for(;!(e&i.WINDOW_MAX);)t+=t,e<<=1;return t},r.stringToArray=function(e){if(!e)return[];for(var t=[],r=e?e.length:0,n=0;n<r;n++)t[n]=e.charCodeAt(n);return t},r.truncateBuffer=a;var i=function(e,t){if("function"==typeof WeakMap)var r=new WeakMap,i=new WeakMap;return function(e,t){if(!t&&e&&e.__esModule)return e;var s,a,o={__proto__:null,default:e};if(null===e||"object"!=n(e)&&"function"!=typeof e)return o;if(s=t?i:r){if(s.has(e))return s.get(e);s.set(e,o)}for(var u in e)"default"!==u&&{}.hasOwnProperty.call(e,u)&&((a=(s=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,u))&&(a.get||a.set)?s(o,u,a):o[u]=e[u]);return o}(e,t)}(e("./config"));var s=String.fromCharCode;function a(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)}function o(e){for(var t,r="",n=e.length,a=0;a<n;){if(t=!Array.isArray(e)&&e.subarray?e.subarray(a,a+i.APPLY_BUFFER_SIZE):e.slice(a,a+i.APPLY_BUFFER_SIZE),a+=i.APPLY_BUFFER_SIZE,!i.APPLY_BUFFER_SIZE_OK){if(null===i.APPLY_BUFFER_SIZE_OK)try{r+=s.apply(null,t),t.length>i.APPLY_BUFFER_SIZE&&i.setApplyBufferSizeOk(!0);continue}catch(e){i.setApplyBufferSizeOk(!1)}return u(e)}r+=s.apply(null,t)}return r}function u(e){for(var t="",r=e.length,n=0;n<r;n++)t+=s(e[n]);return t}},{"./config":30,"@babel/runtime/helpers/typeof":20}],34:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SnowFall=void 0;var n=e("./compiler/compiler"),i=e("./compiler/libs/lexer"),s=e("./compiler/libs/parser"),a=e("./vm/vm"),o={builtInFunctions:{}};function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,r=new i.Lexer(e).tokenize(),a=new s.Parser(r).parse();return new n.Compiler(a,t).compile()}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;return new a.SnowFallVM(e,t).run()}r.SnowFall={compile:u,run:c,compileAndRun:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;return c(u(e,t),t)}}},{"./compiler/compiler":23,"./compiler/libs/lexer":24,"./compiler/libs/parser":25,"./vm/vm":39}],35:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.Compressor=void 0;var i=n(e("@babel/runtime/helpers/classCallCheck")),s=n(e("@babel/runtime/helpers/createClass")),a=n(e("@babel/runtime/helpers/defineProperty")),o=n(e("../libs/lzbase62/src/index")),u=n(e("./compressor/smartpack")),c=n(e("./jsonextended"));function l(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return p(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){o=!0,s=e},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw s}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var h=r.Compressor=(0,s.default)((function e(){(0,i.default)(this,e)}),null,[{key:"encodeNumbers",value:function(e){var t,r="",n=l(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,s=[];do{var a=i&this.BYTE_MASK;(i>>>=7)>0&&(a|=this.BYTE_MSB),s.push(a)}while(i>0);for(var o=0,u=s;o<u.length;o++){var c=u[o];r+=String.fromCharCode(c)}}}catch(e){n.e(e)}finally{n.f()}return this.encodeString(r)}},{key:"encodeSmartPack",value:function(e){var t,r="",n=l(u.default.encode(e));try{for(n.s();!(t=n.n()).done;){var i=t.value;r+=String.fromCharCode(i)}}catch(e){n.e(e)}finally{n.f()}return this.encodeString(r)}},{key:"encodeJSON",value:function(e){return this.encodeString(c.default.stringify(e))}},{key:"encodeString",value:function(e){return o.default.compress(e)}},{key:"decodeNumbers",value:function(e){if(0===e.length)return[];for(var t=this.decodeString(e),r=[],n=0,i=0,s=0;s<t.length;s++){var a=t.charCodeAt(s);n|=(a&this.BYTE_MASK)<<i,0===(a&this.BYTE_MSB)?(r.push(n),n=0,i=0):i+=7}return r}},{key:"decodeSmartPack",value:function(e){for(var t=this.decodeString(e),r=[],n=0;n<t.length;n++)r.push(t.charCodeAt(n));return u.default.decode(new Uint8Array(r))}},{key:"decodeJSON",value:function(e){return c.default.parse(this.decodeString(e))}},{key:"decodeString",value:function(e){return o.default.decompress(e)}}]);(0,a.default)(h,"BYTE_MASK",127),(0,a.default)(h,"BYTE_MSB",128)},{"../libs/lzbase62/src/index":32,"./compressor/smartpack":37,"./jsonextended":38,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":6,"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":10}],36:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.BitWriter=r.BitReader=void 0;var i=n(e("@babel/runtime/helpers/classCallCheck")),s=n(e("@babel/runtime/helpers/createClass")),a=n(e("@babel/runtime/helpers/defineProperty"));r.BitWriter=(0,s.default)((function e(){(0,i.default)(this,e),(0,a.default)(this,"buffer",[]),(0,a.default)(this,"currentByte",0),(0,a.default)(this,"bitsFilled",0)}),[{key:"writeBits",value:function(e,t){for(var r=t-1;r>=0;r--){var n=e>>r&1;this.currentByte=this.currentByte<<1|n,this.bitsFilled++,8===this.bitsFilled&&(this.buffer.push(this.currentByte),this.currentByte=0,this.bitsFilled=0)}}},{key:"finish",value:function(){return this.bitsFilled>0&&(this.currentByte<<=8-this.bitsFilled,this.buffer.push(this.currentByte)),Uint8Array.from(this.buffer)}}]),r.BitReader=(0,s.default)((function e(t){(0,i.default)(this,e),(0,a.default)(this,"byteIndex",0),(0,a.default)(this,"bitsLeft",0),(0,a.default)(this,"currentByte",0),this.buffer=t}),[{key:"readBits",value:function(e){for(var t=0;e>0;){if(0===this.bitsLeft){if(this.byteIndex>=this.buffer.length)throw new Error("EOF");this.currentByte=this.buffer[this.byteIndex++],this.bitsLeft=8}var r=Math.min(e,this.bitsLeft),n=this.bitsLeft-r;t=t<<r|this.currentByte>>n&(1<<r)-1,this.bitsLeft-=r,this.currentByte&=(1<<this.bitsLeft)-1,e-=r}return t}}])},{"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":6,"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":10}],37:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/classCallCheck")),s=n(e("@babel/runtime/helpers/createClass")),a=e("./bitwriter");r.default=(0,s.default)((function e(){(0,i.default)(this,e)}),null,[{key:"_encodeSigned",value:function(e,t){return e+(1<<t-1)}},{key:"_decodeSigned",value:function(e,t){return e-(1<<t-1)}},{key:"encode",value:function(e){if(0===e.length)return new Uint8Array;for(var t=[e[0]],r=1;r<e.length;r++)t.push(e[r]-e[r-1]);for(var n=new a.BitWriter,i=0;i<t.length;){for(var s=1;i+s<t.length&&t[i+s]===t[i];)s++;if(s>=3){var o=t[i],u=Math.ceil(Math.log2(Math.abs(o)+1))+1;n.writeBits(1,1),n.writeBits(u,5),n.writeBits(s,8),n.writeBits(this._encodeSigned(o,u),u),i+=s}else{for(var c=[];i<t.length&&c.length<255&&(i+2>=t.length||t[i]!==t[i+1]||t[i]!==t[i+2]);)c.push(t[i++]);var l=Math.min.apply(Math,c),p=Math.max.apply(Math,c),h=Math.ceil(Math.log2(Math.max(Math.abs(l),Math.abs(p))+1))+1;n.writeBits(0,1),n.writeBits(h,5),n.writeBits(c.length,8);for(var f=0,d=c;f<d.length;f++){var m=d[f];n.writeBits(this._encodeSigned(m,h),h)}}}return n.finish()}},{key:"decode",value:function(e){for(var t=new a.BitReader(e),r=[];;)try{var n=t.readBits(1),i=t.readBits(5),s=t.readBits(8);if(n)for(var o=this._decodeSigned(t.readBits(i),i),u=0;u<s;u++)r.push(o);else for(var c=0;c<s;c++)r.push(this._decodeSigned(t.readBits(i),i))}catch(e){break}for(var l=[],p=0;p<r.length;p++)l[p]=0===p?r[0]:l[p-1]+r[p];return l}}])},{"./bitwriter":36,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":6,"@babel/runtime/helpers/interopRequireDefault":10}],38:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/typeof"));r.default={stringify:function(e){return JSON.stringify(e,(function(e,t){if("bigint"==typeof t)return{__type:"BigInt",value:t.toString()};if(t instanceof Date)return{__type:"Date",value:t.toISOString()};if(t instanceof Map)return{__type:"Map",value:Array.from(t.entries())};if(t instanceof Set)return{__type:"Set",value:Array.from(t)};if("number"==typeof t&&!isFinite(t)){var r="NaN";return t===1/0&&(r="Infinity"),t===-1/0&&(r="-Infinity"),{__type:"Number",value:r}}return void 0===t?{__type:"Undefined"}:t}))},parse:function(e){return JSON.parse(e,(function(e,t){if(t&&"object"===(0,i.default)(t)&&"__type"in t)switch(t.__type){case"BigInt":return BigInt(t.value);case"Date":return new Date(t.value);case"Map":return new Map(t.value);case"Set":return new Set(t.value);case"Number":switch(t.value){case"NaN":return NaN;case"Infinity":return 1/0;case"-Infinity":return-1/0}break;case"Undefined":return}return t}))}}},{"@babel/runtime/helpers/interopRequireDefault":10,"@babel/runtime/helpers/typeof":20}],39:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.SnowFallVM=void 0;var i=n(e("@babel/runtime/helpers/toConsumableArray")),s=n(e("@babel/runtime/helpers/typeof")),a=n(e("@babel/runtime/helpers/classCallCheck")),o=n(e("@babel/runtime/helpers/createClass")),u=n(e("@babel/runtime/helpers/defineProperty")),c=e("../const/errors"),l=e("../const/opcodes"),p=e("../util/compressor"),h=r.SnowFallVM=function(){function e(t,r){for(var n in(0,a.default)(this,e),(0,u.default)(this,"frames",[]),(0,u.default)(this,"stack",[]),(0,u.default)(this,"globals",new Map),(0,u.default)(this,"handlerStack",[]),this.settings=r,console.log(t),r.builtInFunctions){var i={type:"builtin",name:n,func:r.builtInFunctions[n]};this.globals.set(n,i)}var s=this.decompressData(t);this.stack.push(s);var o={func:s,ip:0,stackStart:0};this.frames.push(o),this.frame=o}return(0,o.default)(e,[{key:"readByte",value:function(){return this.frame.func.chunk.code[this.frame.ip++]}},{key:"readShort",value:function(){this.frame.ip+=2;var e=this.frame.func.chunk.code;return e[this.frame.ip-2]<<8|e[this.frame.ip-1]}},{key:"readConstant",value:function(){return this.frame.func.chunk.constants[this.readByte()]}},{key:"runtimeError",value:function(e){for(var t="\n--- Stack Trace ---\n",r=this.frames.length-1;r>=0;r--){var n=this.frames[r],i=n.func.name||"(script)",s=n.func.chunk.lines[n.ip-1]||"unknown";t+="  at ".concat(i," (line ").concat(s,")\n")}return new c.VMError("".concat(e,"\n").concat(t))}},{key:"run",value:function(){try{for(;;){var t=this.readByte();switch(t){case l.OpCode.CHECK_TYPE:var r=this.readConstant().toLowerCase(),n=this.stack[this.stack.length-1];if("any"===r)break;if(void 0===n)break;var a=void 0;if(r!==(a=null===n?"null":Array.isArray(n)?"array":(0,s.default)(n))&&"null"!==a)throw this.runtimeError("Expected type '".concat(r,"' but got '").concat(a,"'."));break;case l.OpCode.PUSH_TRUE:this.stack.push(!0);break;case l.OpCode.PUSH_FALSE:this.stack.push(!1);break;case l.OpCode.PUSH_CONST:this.stack.push(this.readConstant());break;case l.OpCode.PUSH_NULL:this.stack.push(null);break;case l.OpCode.POP:this.stack.pop();break;case l.OpCode.DUP:this.stack.push(this.stack[this.stack.length-1]);break;case l.OpCode.DEFINE_GLOBAL:var o=this.readConstant();this.globals.set(o,this.stack[this.stack.length-1]),this.stack.pop();break;case l.OpCode.GET_GLOBAL:var u=this.readConstant();if(!this.globals.has(u))throw this.runtimeError("Undefined global variable '".concat(u,"'."));this.stack.push(this.globals.get(u));break;case l.OpCode.SET_GLOBAL:var p=this.readConstant();if(!this.globals.has(p))throw this.runtimeError("Undefined global variable '".concat(p,"'."));this.globals.set(p,this.stack[this.stack.length-1]);break;case l.OpCode.GET_LOCAL:var h=this.readByte();this.stack.push(this.stack[this.frame.stackStart+h]);break;case l.OpCode.SET_LOCAL:var f=this.readByte();this.stack[this.frame.stackStart+f]=this.stack[this.stack.length-1];break;case l.OpCode.BUILD_ARRAY:var d=this.readByte(),m=this.stack.splice(this.stack.length-d,d);this.stack.push(m);break;case l.OpCode.BUILD_OBJECT:for(var E=this.readByte(),b={},y=0;y<E;y++){var k=this.stack.pop();b[this.stack.pop()]=k}this.stack.push(b);break;case l.OpCode.BUILD_TUPLE:var v=this.readByte(),C=this.stack.splice(this.stack.length-v,v);Object.defineProperty(C,e.TUPLE_MARKER,{value:!0}),Object.freeze(C),this.stack.push(C);break;case l.OpCode.GET_PROPERTY:var _=this.stack.pop(),O=this.stack.pop();if(null==O)throw this.runtimeError("Cannot read property of null or undefined.");this.stack.push(O[_]);break;case l.OpCode.SET_PROPERTY:var S=this.stack.pop(),T=this.stack.pop(),A=this.stack.pop();if(null==A)throw this.runtimeError("Cannot set property of null or undefined.");if(A[e.TUPLE_MARKER])throw this.runtimeError("Cannot modify a tuple, as it is immutable.");A[T]=S,this.stack.push(S);break;case l.OpCode.EQUAL:var P=this.stack.pop(),L=this.stack.pop();this.stack.push(L===P);break;case l.OpCode.NOT_EQUAL:var g=this.stack.pop(),R=this.stack.pop();this.stack.push(R!==g);break;case l.OpCode.GREATER_THAN:var I=this.stack.pop(),N=this.stack.pop();this.stack.push(N>I);break;case l.OpCode.GREATER_EQUAL:var x=this.stack.pop(),B=this.stack.pop();this.stack.push(B>=x);break;case l.OpCode.LESS_THAN:var U=this.stack.pop(),D=this.stack.pop();this.stack.push(D<U);break;case l.OpCode.LESS_EQUAL:var M=this.stack.pop(),w=this.stack.pop();this.stack.push(w<=M);break;case l.OpCode.BITWISE_AND:var F=this.stack.pop(),j=this.stack.pop();if("number"!=typeof j||"number"!=typeof F)throw this.runtimeError("Operands must be two numbers for bitwise AND.");this.stack.push(j&F);break;case l.OpCode.BITWISE_OR:var W=this.stack.pop(),X=this.stack.pop();if("number"!=typeof X||"number"!=typeof W)throw this.runtimeError("Operands must be two numbers for bitwise OR.");this.stack.push(X|W);break;case l.OpCode.ADD:var G=this.stack.pop(),H=this.stack.pop();if("number"==typeof H&&"number"==typeof G)this.stack.push(H+G);else if("bigint"==typeof H&&"bigint"==typeof G)this.stack.push(H+G);else if("string"==typeof H||"string"==typeof G)this.stack.push(String(H)+String(G));else if("number"==typeof H&&"bigint"==typeof G)try{this.stack.push(BigInt(Math.floor(H))+G)}catch(e){throw this.runtimeError("Cannot multiply non-integer number by BigInt: number=".concat(String(H),", BigInt=").concat(String(G)))}else{if("bigint"!=typeof H||"number"!=typeof G)throw this.runtimeError("Invalid operand types for addition. Received: ".concat((0,s.default)(H)," + ").concat((0,s.default)(G)));try{this.stack.push(H+BigInt(Math.floor(G)))}catch(e){throw this.runtimeError("Cannot multiply BigInt by non-integer number: BigInt=".concat(String(H),", number=").concat(String(G)))}}break;case l.OpCode.SUBTRACT:var Y=this.stack.pop(),J=this.stack.pop();if("number"==typeof J&&"number"==typeof Y)this.stack.push(J-Y);else if("bigint"==typeof J&&"bigint"==typeof Y)this.stack.push(J-Y);else if("number"==typeof J&&"bigint"==typeof Y)try{this.stack.push(BigInt(Math.floor(J))-Y)}catch(e){throw this.runtimeError("Cannot multiply non-integer number by BigInt: number=".concat(String(J),", BigInt=").concat(String(Y)))}else{if("bigint"!=typeof J||"number"!=typeof Y)throw this.runtimeError("Invalid operand types for subtraction. Received: ".concat((0,s.default)(J)," - ").concat((0,s.default)(Y)));try{this.stack.push(J-BigInt(Math.floor(Y)))}catch(e){throw this.runtimeError("Cannot multiply BigInt by non-integer number: BigInt=".concat(String(J),", number=").concat(String(Y)))}}break;case l.OpCode.MULTIPLY:var K=this.stack.pop(),Q=this.stack.pop();if("number"==typeof Q&&"number"==typeof K)this.stack.push(Q*K);else if("bigint"==typeof Q&&"bigint"==typeof K)this.stack.push(Q*K);else if("string"==typeof Q&&"number"==typeof K)this.stack.push(Q.repeat(K));else if("number"==typeof Q&&"string"==typeof K)this.stack.push(K.repeat(Q));else if("number"==typeof Q&&"bigint"==typeof K)try{this.stack.push(BigInt(Math.floor(Q))*K)}catch(e){throw this.runtimeError("Cannot multiply non-integer number by BigInt: number=".concat(String(Q),", BigInt=").concat(String(K)))}else{if("bigint"!=typeof Q||"number"!=typeof K)throw this.runtimeError("Invalid operand types for multiplication. Received: ".concat((0,s.default)(Q)," * ").concat((0,s.default)(K)));try{this.stack.push(Q*BigInt(Math.floor(K)))}catch(e){throw this.runtimeError("Cannot multiply BigInt by non-integer number: BigInt=".concat(String(Q),", number=").concat(String(K)))}}break;case l.OpCode.DIVIDE:var q=this.stack.pop(),Z=this.stack.pop();if("number"==typeof Z&&"number"==typeof q){if(0===q)throw this.runtimeError("Division by zero.");this.stack.push(Z/q)}else if("bigint"==typeof Z&&"bigint"==typeof q){if(0n===q)throw this.runtimeError("Division by zero.");this.stack.push(Z/q)}else if("number"==typeof Z&&"bigint"==typeof q)try{if(0n===q)throw this.runtimeError("Division by zero.");this.stack.push(BigInt(Math.floor(Z))/q)}catch(e){throw this.runtimeError("Cannot divide non-integer number by BigInt: number=".concat(String(Z),", BigInt=").concat(String(q)))}else{if("bigint"!=typeof Z||"number"!=typeof q)throw this.runtimeError("Invalid operand types for division. Received: ".concat((0,s.default)(Z)," / ").concat((0,s.default)(q)));try{var z=BigInt(Math.floor(q));if(0n===z)throw this.runtimeError("Division by zero.");this.stack.push(Z/z)}catch(e){throw this.runtimeError("Cannot divide BigInt by non-integer number: BigInt=".concat(String(Z),", number=").concat(String(q)))}}break;case l.OpCode.MODULO:var V=this.stack.pop(),$=this.stack.pop();if("number"==typeof $&&"number"==typeof V){if(0===V)throw this.runtimeError("Modulo by zero.");this.stack.push($%V)}else if("bigint"==typeof $&&"bigint"==typeof V){if(0n===V)throw this.runtimeError("Modulo by zero.");this.stack.push($%V)}else if("number"==typeof $&&"bigint"==typeof V)try{if(0n===V)throw this.runtimeError("Modulo by zero.");this.stack.push(BigInt(Math.floor($))%V)}catch(e){throw this.runtimeError("Cannot perform modulo of non-integer number by BigInt. number=".concat(String($),", BigInt=").concat(String(V)))}else{if("bigint"!=typeof $||"number"!=typeof V)throw this.runtimeError("Invalid operand types for modulo. Received: ".concat((0,s.default)($)," % ").concat((0,s.default)(V)));try{var ee=BigInt(Math.floor(V));if(0n===ee)throw this.runtimeError("Modulo by zero.");this.stack.push($%ee)}catch(e){throw this.runtimeError("Cannot perform modulo of BigInt by non-integer number. BigInt=".concat(String($),", number=").concat(String(V)))}}break;case l.OpCode.NEGATE:var te=this.stack.pop();this.stack.push(!te);break;case l.OpCode.JUMP:var re,ne=this.readShort();null!==(re=this.settings.hooks)&&void 0!==re&&re.beforeJump&&this.settings.hooks.beforeJump(this,"JUMP"),this.frame.ip+=ne;break;case l.OpCode.JUMP_IF_FALSE:var ie,se=this.readShort();null!==(ie=this.settings.hooks)&&void 0!==ie&&ie.beforeJump&&this.settings.hooks.beforeJump(this,"JUMP_IF_FALSE"),this.stack[this.stack.length-1]||(this.frame.ip+=se);break;case l.OpCode.LOOP:var ae=this.readShort();this.frame.ip-=ae;break;case l.OpCode.CALL:var oe=this.readByte(),ue=this.stack.length-1-oe,ce=this.stack[ue];if(ce&&"object"===(0,s.default)(ce)){if("builtin"===ce.type){var le=ce,pe=this.stack.splice(ue+1,oe);this.stack.pop();var he=le.func.apply(le,(0,i.default)(pe));this.stack.push(void 0===he?null:he);break}if(void 0!==ce.arity){if(oe>ce.arity)throw this.runtimeError("Expected at most ".concat(ce.arity," arguments but got ").concat(oe,"."));for(var fe=oe;fe<ce.arity;fe++)this.stack.push(null);var de={func:this.decompressData(ce),ip:0,stackStart:ue};this.frames.push(de),this.frame=de;break}}throw this.runtimeError("Can only call functions.");case l.OpCode.RETURN:var me=this.stack.pop(),Ee=this.frames.pop();if(0===this.frames.length)return me;this.stack.length=Ee.stackStart,this.stack.push(me),this.frame=this.frames[this.frames.length-1];break;case l.OpCode.SETUP_EXCEPTION:var be=this.readShort();this.handlerStack.push({catchAddress:this.frame.ip+be,finallyAddress:null,stackDepth:this.stack.length});break;case l.OpCode.TEARDOWN_EXCEPTION:this.handlerStack.pop();break;default:throw this.runtimeError("Unknown opcode ".concat(t))}}}catch(e){e instanceof c.SnowFallBaseError?console.error("".concat(e.name,": ").concat(e.message)):console.error(e.message)}}},{key:"decompressData",value:function(e){return void 0!==e.chunk?e:{name:e.name,arity:e.arity,chunk:{code:p.Compressor.decodeNumbers(e.code),constants:p.Compressor.decodeJSON(e.constants),lines:p.Compressor.decodeSmartPack(e.lines)}}}}])}();(0,u.default)(h,"TUPLE_MARKER",Symbol("isTuple"))},{"../const/errors":26,"../const/opcodes":27,"../util/compressor":35,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":6,"@babel/runtime/helpers/defineProperty":7,"@babel/runtime/helpers/interopRequireDefault":10,"@babel/runtime/helpers/toConsumableArray":17,"@babel/runtime/helpers/typeof":20}]},{},[28]);
//# sourceMappingURL=SnowFall.min.js.map